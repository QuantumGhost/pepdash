<!doctype html>
<!--[if lt IE 7]>   <html class="no-js ie6 lt-ie7 lt-ie8 lt-ie9">   <![endif]-->
<!--[if IE 7]>      <html class="no-js ie7 lt-ie8 lt-ie9">          <![endif]-->
<!--[if IE 8]>      <html class="no-js ie8 lt-ie9">                 <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en" dir="ltr">  <!--<![endif]-->


<!-- Mirrored from www.python.org/dev/peps/pep-0422/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 03 Sep 2015 04:38:13 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="prefetch" href="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">

    <meta name="application-name" content="Python.org">
    <meta name="msapplication-tooltip" content="The official home of the Python Programming Language">
    <meta name="apple-mobile-web-app-title" content="Python.org">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="HandheldFriendly" content="True">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cleartype" content="on">
    <meta http-equiv="imagetoolbar" content="false">

    <script src="../../../static/js/libs/modernizr.js"></script>

    <link href="../../../static/stylesheets/style.css" rel="stylesheet" type="text/css" title="default" />
    <link href="../../../static/stylesheets/mq.css" rel="stylesheet" type="text/css" media="not print, braille, embossed, speech, tty" />
    

    <!--[if (lte IE 8)&(!IEMobile)]>
    <link href="/static/stylesheets/no-mq.css" rel="stylesheet" type="text/css" media="screen" />
    
    
    <![endif]-->

    
    <link rel="icon" type="image/x-icon" href="https://www.python.org/static/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../static/apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../static/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../static/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../../../static/apple-touch-icon-precomposed.png">
    <link rel="apple-touch-icon" href="../../../static/apple-touch-icon-precomposed.png">

    
    <meta name="msapplication-TileImage" content="/static/metro-icon-144x144-precomposed.png"><!-- white shape -->
    <meta name="msapplication-TileColor" content="#3673a5"><!-- python blue -->
    <meta name="msapplication-navbutton-color" content="#3673a5">

    <meta property="og:site_name" content="Python.org">
    <meta property="og:type" content="website">

    <title>PEP 0422 -- Simpler customisation of class creation | Python.org</title>
    <meta property="og:title" content="Welcome to Python.org">

    
    <meta name="description" content="The official home of the Python Programming Language">
    <meta name="og:description" content="The official home of the Python Programming Language">
    <meta name="keywords" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:tag" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:published_time" content="">
    <meta property="og:modified_time" content="">
    <meta property="og:author" content="">
    <meta property="og:section" content=""> 
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:video" content="">

    <link rel="author" href="https://www.python.org/static/humans.txt">

    

    
    <script type="application/ld+json">
     {
       "@context": "http://schema.org",
       "@type": "WebSite",
       "url": "https://www.python.org/",
       "potentialAction": {
         "@type": "SearchAction",
         "target": "https://www.python.org/search/?q={search_term_string}",
         "query-input": "required name=search_term_string"
       }
     }
    </script>

    
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39055973-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    
</head>

<body class="python pages pep-page">

    <div id="touchnav-wrapper">

        <div id="nojs" class="do-not-print">
            <p><strong>Notice:</strong> While Javascript is not essential for this website, your interaction with the content will be limited. Please turn Javascript on for the full experience. </p>
        </div>

        <!--[if lt IE 8]>
        <div id="oldie-warning" class="do-not-print">
            <p><strong>Notice:</strong> Your browser is <em>ancient</em> and <a href="http://www.ie6countdown.com/">Microsoft agrees</a>. <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience a better web.</p>
        </div>
        <![endif]-->

        <!-- Sister Site Links -->
        <div id="top" class="top-bar do-not-print">

            <nav class="meta-navigation container" role="navigation">

                
                <div class="skip-link screen-reader-text">
                    <a href="#content" title="Skip to content">Skip to content</a>
                </div>

                
                <a id="close-python-network" class="jump-link" href="#python-network" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-down"><span>&#9660;</span></span> Close
                </a>

                

<ul class="menu" role="tree">
    
    <li class="python-meta ">
        <a href="https://www.python.org/" title="The Python Programming Language" >Python</a>
    </li>
    
    <li class="psf-meta ">
        <a href="https://www.python.org/psf-landing/" title="The Python Software Foundation" >PSF</a>
    </li>
    
    <li class="docs-meta ">
        <a href="https://docs.python.org/" title="Python Documentation" >Docs</a>
    </li>
    
    <li class="pypi-meta ">
        <a href="https://pypi.python.org/" title="Python Package Index" >PyPI</a>
    </li>
    
    <li class="jobs-meta ">
        <a href="https://www.python.org/jobs/" title="Python Job Board" >Jobs</a>
    </li>
    
    <li class="shop-meta ">
        <a href="https://www.python.org/community/" title="Python Community" >Community</a>
    </li>
    
</ul>


                <a id="python-network" class="jump-link" href="#top" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> The Python Network
                </a>

            </nav>

        </div>

        <!-- Header elements -->
        <header class="main-header" role="banner">
            <div class="container">

                <h1 class="site-headline">
                    <a href="https://www.python.org/"><img class="python-logo" src="../../../static/img/python-logo.png" alt="python&trade;"></a>
                </h1>

                <div class="options-bar do-not-print">

                    
                    <a id="site-map-link" class="jump-to-menu" href="#site-map"><span class="menu-icon">&equiv;</span> Menu</a><form class="search-the-site" action="https://www.python.org/search/" method="get">
                        <fieldset title="Search Python.org">

                            <span aria-hidden="true" class="icon-search"></span>

                            <label class="screen-reader-text" for="id-search-field">Search This Site</label>
                            <input id="id-search-field" name="q" type="search" role="textbox" class="search-field" placeholder="Search" value="" tabindex="1">

                            <button type="submit" name="submit" id="submit" class="search-button" title="Submit this Search" tabindex="3">
                                GO
                            </button>

                            
                            <!--[if IE]><input type="text" style="display: none;" disabled="disabled" size="1" tabindex="4"><![endif]-->

                        </fieldset>
                    </form><span class="breaker"></span><div class="adjust-font-size" aria-hidden="true">
                        <ul class="navigation menu" aria-label="Adjust Text Size on Page">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger"><strong><small>A</small> A</strong></a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a class="text-shrink" title="Make Text Smaller" href="javascript:;">Smaller</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a class="text-grow" title="Make Text Larger" href="javascript:;">Larger</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a class="text-reset" title="Reset any font size changes I have made" href="javascript:;">Reset</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="winkwink-nudgenudge">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger">Socialize</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="http://plus.google.com/+Python"><span aria-hidden="true" class="icon-google-plus"></span>Google+</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="http://www.facebook.com/pythonlang?fref=ts"><span aria-hidden="true" class="icon-facebook"></span>Facebook</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a href="http://twitter.com/ThePSF"><span aria-hidden="true" class="icon-twitter"></span>Twitter</a></li>
                                    <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/irc/"><span aria-hidden="true" class="icon-freenode"></span>Chat on IRC</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="account-signin">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                
                                <a href="https://www.python.org/accounts/login/" title="Sign Up or Sign In to Python.org">Sign In</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/accounts/signup/">Sign Up / Register</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/accounts/login/">Sign In</a></li>
                                </ul>
                                
                            </li>
                        </ul>
                    </div>

                </div><!-- end options-bar -->

                <nav id="mainnav" class="python-navigation main-navigation do-not-print" role="navigation">
                    
                        
<ul class="navigation menu" role="menubar" aria-label="Main Navigation">
  
    
    
    <li id="about" class="tier-1 element-1  " aria-haspopup="true">
        <a href="https://www.python.org/about/" title="" class="">About</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="downloads" class="tier-1 element-2  " aria-haspopup="true">
        <a href="https://www.python.org/downloads/" title="" class="">Downloads</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="documentation" class="tier-1 element-3  " aria-haspopup="true">
        <a href="https://www.python.org/doc/" title="" class="">Documentation</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="../index.html" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="community" class="tier-1 element-4  " aria-haspopup="true">
        <a href="https://www.python.org/community/" title="" class="">Community</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://www.python.org/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="https://www.python.org/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="success-stories" class="tier-1 element-5  " aria-haspopup="true">
        <a href="https://www.python.org/about/success/" title="success-stories" class="">Success Stories</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://www.python.org/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="news" class="tier-1 element-6  " aria-haspopup="true">
        <a href="https://www.python.org/blogs/" title="News from around the Python world" class="">News</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="events" class="tier-1 element-7  " aria-haspopup="true">
        <a href="https://www.python.org/events/" title="" class="">Events</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    
    
    
  
</ul>

                    
                </nav>

                <div class="header-banner "> <!-- for optional "do-not-print" class -->
                    
                    
                </div>

                
                

             </div><!-- end .container -->
        </header>

        <div id="content" class="content-wrapper">
            <!-- Main Content Column -->
            <div class="container">

                <section class="main-content with-left-sidebar" role="main">

                    
<ul class="breadcrumbs menu">
    <li>
        <a href="https://www.python.org/" title="The Python Programming Language">Python</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="https://www.python.org/dev/">Python Developer's Guide</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="../index.html">PEP Index</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>PEP 0422 -- Simpler customisation of class creation</li>
</ul>


                    
<style>
   .pep-page pre {
        padding: .5em;
        background: inherit;
        border-left: 0px;
        -webkit-box-shadow: 0 0 0 0;
        -moz-box-shadow: 0 0 0 0;
        box-shadow: 0 0 0 0;
   }
</style>

    
    <article class="text">
        

        <header class="article-header">
            <h1 class="page-title">PEP 0422 -- Simpler customisation of class creation</h1>
        </header>

        <!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<html>
 <body>
  <table class="rfc2822 docutils field-list" frame="void" rules="none">
   <col class="field-name">
   </col>
   <col class="field-body">
   </col>
   <tbody valign="top">
    <tr class="field">
     <th class="field-name">
      PEP:
     </th>
     <td class="field-body">
      422
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Title:
     </th>
     <td class="field-body">
      Simpler customisation of class creation
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Author:
     </th>
     <td class="field-body">
      Nick Coghlan &lt;ncoghlan at gmail.com&gt;,
Daniel Urban &lt;urban.dani+py at gmail.com&gt;
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Status:
     </th>
     <td class="field-body">
      Withdrawn
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Type:
     </th>
     <td class="field-body">
      Standards Track
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Created:
     </th>
     <td class="field-body">
      5-Jun-2012
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Python-Version:
     </th>
     <td class="field-body">
      3.5
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Post-History:
     </th>
     <td class="field-body">
      5-Jun-2012, 10-Feb-2013
     </td>
    </tr>
   </tbody>
  </table>
  <hr/>
  <div class="contents topic" id="contents">
   <p class="topic-title first">
    Contents
   </p>
   <ul class="simple">
    <li>
     <a class="reference internal" href="#abstract" id="id9">
      Abstract
     </a>
    </li>
    <li>
     <a class="reference internal" href="#pep-withdrawal" id="id10">
      PEP Withdrawal
     </a>
    </li>
    <li>
     <a class="reference internal" href="#background" id="id11">
      Background
     </a>
    </li>
    <li>
     <a class="reference internal" href="#proposal" id="id12">
      Proposal
     </a>
    </li>
    <li>
     <a class="reference internal" href="#key-benefits" id="id13">
      Key Benefits
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#easier-use-of-custom-namespaces-for-a-class" id="id14">
        Easier use of custom namespaces for a class
       </a>
      </li>
      <li>
       <a class="reference internal" href="#easier-inheritance-of-definition-time-behaviour" id="id15">
        Easier inheritance of definition time behaviour
       </a>
      </li>
      <li>
       <a class="reference internal" href="#reduced-chance-of-metaclass-conflicts" id="id16">
        Reduced chance of metaclass conflicts
       </a>
      </li>
      <li>
       <a class="reference internal" href="#integrates-cleanly-with-pep-3135" id="id17">
        Integrates cleanly with PEP 3135
       </a>
      </li>
      <li>
       <a class="reference internal" href="#replaces-many-use-cases-for-dynamic-setting-of-metaclass" id="id18">
        Replaces many use cases for dynamic setting of
        <tt class="docutils literal">
         __metaclass__
        </tt>
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#design-notes" id="id19">
      Design Notes
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#determining-if-the-class-being-decorated-is-the-base-class" id="id20">
        Determining if the class being decorated is the base class
       </a>
      </li>
      <li>
       <a class="reference internal" href="#replacing-a-class-with-a-different-kind-of-object" id="id21">
        Replacing a class with a different kind of object
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#open-questions" id="id22">
      Open Questions
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#is-the-namespace-concept-worth-the-extra-complexity" id="id23">
        Is the
        <tt class="docutils literal">
         namespace
        </tt>
        concept worth the extra complexity?
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#new-ways-of-using-classes" id="id24">
      New Ways of Using Classes
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#order-preserving-classes" id="id25">
        Order preserving classes
       </a>
      </li>
      <li>
       <a class="reference internal" href="#prepopulated-namespaces" id="id26">
        Prepopulated namespaces
       </a>
      </li>
      <li>
       <a class="reference internal" href="#cloning-a-prototype-class" id="id27">
        Cloning a prototype class
       </a>
      </li>
      <li>
       <a class="reference internal" href="#extending-a-class" id="id28">
        Extending a class
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#rejected-design-options" id="id29">
      Rejected Design Options
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#calling-autodecorate-from-type-init" id="id30">
        Calling
        <tt class="docutils literal">
         __autodecorate__
        </tt>
        from
        <tt class="docutils literal">
         type.__init__
        </tt>
       </a>
      </li>
      <li>
       <a class="reference internal" href="#calling-the-automatic-decoration-hook-init-class" id="id31">
        Calling the automatic decoration hook
        <tt class="docutils literal">
         __init_class__
        </tt>
       </a>
      </li>
      <li>
       <a class="reference internal" href="#requiring-an-explicit-decorator-on-autodecorate" id="id32">
        Requiring an explicit decorator on
        <tt class="docutils literal">
         __autodecorate__
        </tt>
       </a>
      </li>
      <li>
       <a class="reference internal" href="#making-autodecorate-implicitly-static-like-new" id="id33">
        Making
        <tt class="docutils literal">
         __autodecorate__
        </tt>
        implicitly static, like
        <tt class="docutils literal">
         __new__
        </tt>
       </a>
      </li>
      <li>
       <a class="reference internal" href="#passing-in-the-namespace-directly-rather-than-a-factory-function" id="id34">
        Passing in the namespace directly rather than a factory function
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#reference-implementation" id="id35">
      Reference Implementation
     </a>
    </li>
    <li>
     <a class="reference internal" href="#todo" id="id36">
      TODO
     </a>
    </li>
    <li>
     <a class="reference internal" href="#references" id="id37">
      References
     </a>
    </li>
    <li>
     <a class="reference internal" href="#copyright" id="id38">
      Copyright
     </a>
    </li>
   </ul>
  </div>
  <div class="section" id="abstract">
   <h1>
    <a class="toc-backref" href="#id9">
     Abstract
    </a>
   </h1>
   <p>
    Currently, customising class creation requires the use of a custom metaclass.
This custom metaclass then persists for the entire lifecycle of the class,
creating the potential for spurious metaclass conflicts.
   </p>
   <p>
    This PEP proposes to instead support a wide range of customisation
scenarios through a new
    <tt class="docutils literal">
     namespace
    </tt>
    parameter in the class header, and
a new
    <tt class="docutils literal">
     __autodecorate__
    </tt>
    hook in the class body.
   </p>
   <p>
    The new mechanism should be easier to understand and use than
implementing a custom metaclass, and thus should provide a gentler
introduction to the full power Python's metaclass machinery.
   </p>
  </div>
  <div class="section" id="pep-withdrawal">
   <h1>
    <a class="toc-backref" href="#id10">
     PEP Withdrawal
    </a>
   </h1>
   <p>
    This proposal has been withdrawn in favour of Martin Teichmann's proposal
in
    <a class="reference external" href="../pep-0487/index.html">
     PEP 487
    </a>
    , which achieves the same goals through a simpler, easier to use
    <tt class="docutils literal">
     __init_subclass__
    </tt>
    hook that simply isn't invoked for the base class
that defines the hook.
   </p>
  </div>
  <div class="section" id="background">
   <h1>
    <a class="toc-backref" href="#id11">
     Background
    </a>
   </h1>
   <p>
    For an already created class
    <tt class="docutils literal">
     cls
    </tt>
    , the term "metaclass" has a clear
meaning: it is the value of
    <tt class="docutils literal">
     type(cls)
    </tt>
    .
   </p>
   <p>
    <em>
     During
    </em>
    class creation, it has another meaning: it is also used to refer to
the metaclass hint that may be provided as part of the class definition.
While in many cases these two meanings end up referring to one and the same
object, there are two situations where that is not the case:
   </p>
   <ul class="simple">
    <li>
     If the metaclass hint refers to an instance of
     <tt class="docutils literal">
      type
     </tt>
     , then it is
considered as a candidate metaclass along with the metaclasses of all of
the parents of the class being defined. If a more appropriate metaclass is
found amongst the candidates, then it will be used instead of the one
given in the metaclass hint.
    </li>
    <li>
     Otherwise, an explicit metaclass hint is assumed to be a factory function
and is called directly to create the class object. In this case, the final
metaclass will be determined by the factory function definition. In the
typical case (where the factory functions just calls
     <tt class="docutils literal">
      type
     </tt>
     , or, in
Python 3.3 or later,
     <tt class="docutils literal">
      types.new_class
     </tt>
     ) the actual metaclass is then
determined based on the parent classes.
    </li>
   </ul>
   <p>
    It is notable that only the actual metaclass is inherited - a factory
function used as a metaclass hook sees only the class currently being
defined, and is not invoked for any subclasses.
   </p>
   <p>
    In Python 3, the metaclass hint is provided using the
    <tt class="docutils literal">
     metaclass=Meta
    </tt>
    keyword syntax in the class header. This allows the
    <tt class="docutils literal">
     __prepare__
    </tt>
    method
on the metaclass to be used to create the
    <tt class="docutils literal">
     locals()
    </tt>
    namespace used during
execution of the class body (for example, specifying the use of
    <tt class="docutils literal">
     collections.OrderedDict
    </tt>
    instead of a regular
    <tt class="docutils literal">
     dict
    </tt>
    ).
   </p>
   <p>
    In Python 2, there was no
    <tt class="docutils literal">
     __prepare__
    </tt>
    method (that API was added for
Python 3 by
    <a class="reference external" href="../pep-3115/index.html">
     PEP 3115
    </a>
    ). Instead, a class body could set the
    <tt class="docutils literal">
     __metaclass__
    </tt>
    attribute, and the class creation process would extract that value from the
class namespace to use as the metaclass hint. There is
    <a class="reference external" href="http://mail.python.org/pipermail/python-dev/2012-June/119878.html">
     published code
    </a>
    <a class="footnote-reference" href="#id1" id="id2">
     [1]
    </a>
    that
makes use of this feature.
   </p>
   <p>
    Another new feature in Python 3 is the zero-argument form of the
    <tt class="docutils literal">
     super()
    </tt>
    builtin, introduced by
    <a class="reference external" href="../pep-3135/index.html">
     PEP 3135
    </a>
    . This feature uses an implicit
    <tt class="docutils literal">
     __class__
    </tt>
    reference to the class being defined to replace the "by name" references
required in Python 2. Just as code invoked during execution of a Python 2
metaclass could not call methods that referenced the class by name (as the
name had not yet been bound in the containing scope), similarly, Python 3
metaclasses cannot call methods that rely on the implicit
    <tt class="docutils literal">
     __class__
    </tt>
    reference (as it is not populated until after the metaclass has returned
control to the class creation machinery).
   </p>
   <p>
    Finally, when a class uses a custom metaclass, it can pose additional
challenges to the use of multiple inheritance, as a new class cannot
inherit from parent classes with unrelated metaclasses. This means that
it is impossible to add a metaclass to an already published class: such
an addition is a backwards incompatible change due to the risk of metaclass
conflicts.
   </p>
  </div>
  <div class="section" id="proposal">
   <h1>
    <a class="toc-backref" href="#id12">
     Proposal
    </a>
   </h1>
   <p>
    This PEP proposes that a new mechanism to customise class creation be
added to Python 3.4 that meets the following criteria:
   </p>
   <ol class="arabic simple">
    <li>
     Integrates nicely with class inheritance structures (including mixins and
multiple inheritance)
    </li>
    <li>
     Integrates nicely with the implicit
     <tt class="docutils literal">
      __class__
     </tt>
     reference and
zero-argument
     <tt class="docutils literal">
      super()
     </tt>
     syntax introduced by
     <a class="reference external" href="../pep-3135/index.html">
      PEP 3135
     </a>
    </li>
    <li>
     Can be added to an existing base class without a significant risk of
introducing backwards compatibility problems
    </li>
    <li>
     Restores the ability for class namespaces to have some influence on the
class creation process (above and beyond populating the namespace itself),
but potentially without the full flexibility of the Python 2 style
     <tt class="docutils literal">
      __metaclass__
     </tt>
     hook
    </li>
   </ol>
   <p>
    One mechanism that can achieve this goal is to add a new implicit class
decoration hook, modelled directly on the existing explicit class
decorators, but defined in the class body or in a parent class, rather than
being part of the class definition header.
   </p>
   <p>
    Specifically, it is proposed that class definitions be able to provide a
class initialisation hook as follows:
   </p>
   <pre class="literal-block">
class Example:
    def __autodecorate__(cls):
        # This is invoked after the class is created, but before any
        # explicit decorators are called
        # The usual super() mechanisms are used to correctly support
        # multiple inheritance. The class decorator style signature helps
        # ensure that invoking the parent class is as simple as possible.
        cls = super().__autodecorate__()
        return cls
</pre>
   <p>
    To simplify the cooperative multiple inheritance case,
    <tt class="docutils literal">
     object
    </tt>
    will gain
a default implementation of the hook that returns the class unmodified:
   </p>
   <blockquote>
    <dl class="docutils">
     <dt>
      class object:
     </dt>
     <dd>
      <dl class="first last docutils">
       <dt>
        def __autodecorate__(cls):
       </dt>
       <dd>
        return cls
       </dd>
      </dl>
     </dd>
    </dl>
   </blockquote>
   <p>
    If a metaclass wishes to block implicit class decoration for some reason, it
must arrange for
    <tt class="docutils literal">
     cls.__autodecorate__
    </tt>
    to trigger
    <tt class="docutils literal">
     AttributeError
    </tt>
    .
   </p>
   <p>
    If present on the created object, this new hook will be called by the class
creation machinery
    <em>
     after
    </em>
    the
    <tt class="docutils literal">
     __class__
    </tt>
    reference has been initialised.
For
    <tt class="docutils literal">
     types.new_class()
    </tt>
    , it will be called as the last step before
returning the created class object.
    <tt class="docutils literal">
     __autodecorate__
    </tt>
    is implicitly
converted to a class method when the class is created (prior to the hook
being invoked).
   </p>
   <p>
    Note, that when
    <tt class="docutils literal">
     __autodecorate__
    </tt>
    is called, the name of the class is not
yet bound to the new class object. As a consequence, the two argument form
of
    <tt class="docutils literal">
     super()
    </tt>
    cannot be used to call methods (e.g.,
    <tt class="docutils literal">
     super(Example, cls)
    </tt>
    wouldn't work in the example above). However, the zero argument form of
    <tt class="docutils literal">
     super()
    </tt>
    works as expected, since the
    <tt class="docutils literal">
     __class__
    </tt>
    reference is already
initialised.
   </p>
   <p>
    This general proposal is not a new idea (it was first suggested for
inclusion in the language definition
    <a class="reference external" href="http://mail.python.org/pipermail/python-dev/2001-November/018651.html">
     more than 10 years ago
    </a>
    <a class="footnote-reference" href="#id3" id="id4">
     [2]
    </a>
    , and a
similar mechanism has long been supported by
    <a class="reference external" href="http://docs.zope.org/zope_secrets/extensionclass.html">
     Zope's ExtensionClass
    </a>
    <a class="footnote-reference" href="#id5" id="id6">
     [3]
    </a>
    ),
but the situation has changed sufficiently in recent years that
the idea is worth reconsidering for inclusion as a native language feature.
   </p>
   <p>
    In addition, the introduction of the metaclass
    <tt class="docutils literal">
     __prepare__
    </tt>
    method in
    <a class="reference external" href="../pep-3115/index.html">
     PEP
3115
    </a>
    allows a further enhancement that was not possible in Python 2: this
PEP also proposes that
    <tt class="docutils literal">
     type.__prepare__
    </tt>
    be updated to accept a factory
function as a
    <tt class="docutils literal">
     namespace
    </tt>
    keyword-only argument. If present, the value
provided as the
    <tt class="docutils literal">
     namespace
    </tt>
    argument will be called without arguments
to create the result of
    <tt class="docutils literal">
     type.__prepare__
    </tt>
    instead of using a freshly
created dictionary instance. For example, the following will use
an ordered dictionary as the class namespace:
   </p>
   <pre class="literal-block">
class OrderedExample(namespace=collections.OrderedDict):
    def __autodecorate__(cls):
        # cls.__dict__ is still a read-only proxy to the class namespace,
        # but the underlying storage is an OrderedDict instance
</pre>
   <div class="note">
    <p class="first admonition-title">
     Note
    </p>
    <p>
     This PEP, along with the existing ability to use  __prepare__ to share a
single namespace amongst multiple class objects, highlights a possible
issue with the attribute lookup caching: when the underlying mapping is
updated by other means, the attribute lookup cache is not invalidated
correctly (this is a key part of the reason class
     <tt class="docutils literal">
      __dict__
     </tt>
     attributes
produce a read-only view of the underlying storage).
    </p>
    <p class="last">
     Since the optimisation provided by that cache is highly desirable,
the use of a preexisting namespace as the class namespace may need to
be declared as officially unsupported (since the observed behaviour is
rather strange when the caches get out of sync).
    </p>
   </div>
  </div>
  <div class="section" id="key-benefits">
   <h1>
    <a class="toc-backref" href="#id13">
     Key Benefits
    </a>
   </h1>
   <div class="section" id="easier-use-of-custom-namespaces-for-a-class">
    <h2>
     <a class="toc-backref" href="#id14">
      Easier use of custom namespaces for a class
     </a>
    </h2>
    <p>
     Currently, to use a different type (such as
     <tt class="docutils literal">
      collections.OrderedDict
     </tt>
     ) for
a class namespace, or to use a pre-populated namespace, it is necessary to
write and use a custom metaclass. With this PEP, using a custom namespace
becomes as simple as specifying an appropriate factory function in the
class header.
    </p>
   </div>
   <div class="section" id="easier-inheritance-of-definition-time-behaviour">
    <h2>
     <a class="toc-backref" href="#id15">
      Easier inheritance of definition time behaviour
     </a>
    </h2>
    <p>
     Understanding Python's metaclasses requires a deep understanding of
the type system and the class construction process. This is legitimately
seen as challenging, due to the need to keep multiple moving parts (the code,
the metaclass hint, the actual metaclass, the class object, instances of the
class object) clearly distinct in your mind. Even when you know the rules,
it's still easy to make a mistake if you're not being extremely careful.
An earlier version of this PEP actually included such a mistake: it
stated "subclass of type" for a constraint that is actually "instance of
type".
    </p>
    <p>
     Understanding the proposed implicit class decoration hook only requires
understanding decorators and ordinary method inheritance, which isn't
quite as daunting a task. The new hook provides a more gradual path
towards understanding all of the phases involved in the class definition
process.
    </p>
   </div>
   <div class="section" id="reduced-chance-of-metaclass-conflicts">
    <h2>
     <a class="toc-backref" href="#id16">
      Reduced chance of metaclass conflicts
     </a>
    </h2>
    <p>
     One of the big issues that makes library authors reluctant to use metaclasses
(even when they would be appropriate) is the risk of metaclass conflicts.
These occur whenever two unrelated metaclasses are used by the desired
parents of a class definition. This risk also makes it very difficult to
     <em>
      add
     </em>
     a metaclass to a class that has previously been published without one.
    </p>
    <p>
     By contrast, adding an
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     method to an existing type poses
a similar level of risk to adding an
     <tt class="docutils literal">
      __init__
     </tt>
     method: technically, there
is a risk of breaking poorly implemented subclasses, but when that occurs,
it is recognised as a bug in the subclass rather than the library author
breaching backwards compatibility guarantees. In fact, due to the constrained
signature of
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     , the risk in this case is actually even
lower than in the case of
     <tt class="docutils literal">
      __init__
     </tt>
     .
    </p>
   </div>
   <div class="section" id="integrates-cleanly-with-pep-3135">
    <h2>
     <a class="toc-backref" href="#id17">
      Integrates cleanly with PEP 3135
     </a>
    </h2>
    <p>
     Unlike code that runs as part of the metaclass, code that runs as part of
the new hook will be able to freely invoke class methods that rely on the
implicit
     <tt class="docutils literal">
      __class__
     </tt>
     reference introduced by
     <a class="reference external" href="../pep-3135/index.html">
      PEP 3135
     </a>
     , including methods
that use the zero argument form of
     <tt class="docutils literal">
      super()
     </tt>
     .
    </p>
   </div>
   <div class="section" id="replaces-many-use-cases-for-dynamic-setting-of-metaclass">
    <h2>
     <a class="toc-backref" href="#id18">
      Replaces many use cases for dynamic setting of
      <tt class="docutils literal">
       __metaclass__
      </tt>
     </a>
    </h2>
    <p>
     For use cases that don't involve completely replacing the defined class,
Python 2 code that dynamically set
     <tt class="docutils literal">
      __metaclass__
     </tt>
     can now dynamically
set
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     instead. For more advanced use cases, introduction of
an explicit metaclass (possibly made available as a required base class) will
still be necessary in order to support Python 3.
    </p>
   </div>
  </div>
  <div class="section" id="design-notes">
   <h1>
    <a class="toc-backref" href="#id19">
     Design Notes
    </a>
   </h1>
   <div class="section" id="determining-if-the-class-being-decorated-is-the-base-class">
    <h2>
     <a class="toc-backref" href="#id20">
      Determining if the class being decorated is the base class
     </a>
    </h2>
    <p>
     In the body of an
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     method, as in any other class method,
     <tt class="docutils literal">
      __class__
     </tt>
     will be bound to the class declaring the method, while the
value passed in may be a subclass.
    </p>
    <p>
     This makes it relatively straightforward to skip processing the base class
if necessary:
    </p>
    <pre class="literal-block">
class Example:
    def __autodecorate__(cls):
        cls = super().__autodecorate__()
        # Don't process the base class
        if cls is __class__:
            return
        # Process subclasses here
        ...
</pre>
   </div>
   <div class="section" id="replacing-a-class-with-a-different-kind-of-object">
    <h2>
     <a class="toc-backref" href="#id21">
      Replacing a class with a different kind of object
     </a>
    </h2>
    <p>
     As an implicit decorator,
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     is able to relatively easily
replace the defined class with a different kind of object. Technically
custom metaclasses and even
     <tt class="docutils literal">
      __new__
     </tt>
     methods can already do this
implicitly, but the decorator model makes such code much easier to understand
and implement.
    </p>
    <pre class="literal-block">
class BuildDict:
    def __autodecorate__(cls):
        cls = super().__autodecorate__()
        # Don't process the base class
        if cls is __class__:
            return
        # Convert subclasses to ordinary dictionaries
        return cls.__dict__.copy()
</pre>
    <p>
     It's not clear why anyone would ever do this implicitly based on inheritance
rather than just using an explicit decorator, but the possibility seems worth
noting.
    </p>
   </div>
  </div>
  <div class="section" id="open-questions">
   <h1>
    <a class="toc-backref" href="#id22">
     Open Questions
    </a>
   </h1>
   <div class="section" id="is-the-namespace-concept-worth-the-extra-complexity">
    <h2>
     <a class="toc-backref" href="#id23">
      Is the
      <tt class="docutils literal">
       namespace
      </tt>
      concept worth the extra complexity?
     </a>
    </h2>
    <p>
     Unlike the new
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     hook the proposed
     <tt class="docutils literal">
      namespace
     </tt>
     keyword
argument is not automatically inherited by subclasses. Given the way this
proposal is currently written , the only way to get a special namespace used
consistently in subclasses is still to write a custom metaclass with a
suitable
     <tt class="docutils literal">
      __prepare__
     </tt>
     implementation.
    </p>
    <p>
     Changing the custom namespace factory to also be inherited would
significantly increase the complexity of this proposal, and introduce a
number of the same potential base class conflict issues as arise with the
use of custom metaclasses.
    </p>
    <p>
     Eric Snow has put forward a
     <a class="reference external" href="https://mail.python.org/pipermail/python-dev/2013-June/127103.html">
      separate proposal
     </a>
     to instead make the execution namespace for class bodies an ordered dictionary
by default, and capture the class attribute definition order for future
reference as an attribute (e.g.
     <tt class="docutils literal">
      __definition_order__
     </tt>
     ) on the class object.
    </p>
    <p>
     Eric's suggested approach may be a better choice for a new default behaviour
for type that combines well with the proposed
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     hook,
leaving the more complex configurable namespace factory idea to a custom
metaclass like the one shown below.
    </p>
   </div>
  </div>
  <div class="section" id="new-ways-of-using-classes">
   <h1>
    <a class="toc-backref" href="#id24">
     New Ways of Using Classes
    </a>
   </h1>
   <p>
    The new
    <tt class="docutils literal">
     namespace
    </tt>
    keyword in the class header enables a number of
interesting options for controlling the way a class is initialised,
including some aspects of the object models of both Javascript and Ruby.
   </p>
   <p>
    All of the examples below are actually possible today through the use of a
custom metaclass:
   </p>
   <pre class="literal-block">
class CustomNamespace(type):
    @classmethod
    def __prepare__(meta, name, bases, *, namespace=None, **kwds):
        parent_namespace = super().__prepare__(name, bases, **kwds)
        return namespace() if namespace is not None else parent_namespace
    def __new__(meta, name, bases, ns, *, namespace=None, **kwds):
        return super().__new__(meta, name, bases, ns, **kwds)
    def __init__(cls, name, bases, ns, *, namespace=None, **kwds):
        return super().__init__(name, bases, ns, **kwds)
</pre>
   <p>
    The advantage of implementing the new keyword directly in
    <tt class="docutils literal">
     type.__prepare__
    </tt>
    is that the
    <em>
     only
    </em>
    persistent effect is then
the change in the underlying storage of the class attributes. The metaclass
of the class remains unchanged, eliminating many of the drawbacks
typically associated with these kinds of customisations.
   </p>
   <div class="section" id="order-preserving-classes">
    <h2>
     <a class="toc-backref" href="#id25">
      Order preserving classes
     </a>
    </h2>
    <pre class="literal-block">
class OrderedClass(namespace=collections.OrderedDict):
    a = 1
    b = 2
    c = 3
</pre>
   </div>
   <div class="section" id="prepopulated-namespaces">
    <h2>
     <a class="toc-backref" href="#id26">
      Prepopulated namespaces
     </a>
    </h2>
    <pre class="literal-block">
seed_data = dict(a=1, b=2, c=3)
class PrepopulatedClass(namespace=seed_data.copy):
    pass
</pre>
   </div>
   <div class="section" id="cloning-a-prototype-class">
    <h2>
     <a class="toc-backref" href="#id27">
      Cloning a prototype class
     </a>
    </h2>
    <pre class="literal-block">
class NewClass(namespace=Prototype.__dict__.copy):
    pass
</pre>
   </div>
   <div class="section" id="extending-a-class">
    <h2>
     <a class="toc-backref" href="#id28">
      Extending a class
     </a>
    </h2>
    <div class="note">
     <p class="first admonition-title">
      Note
     </p>
     <p class="last">
      Just because the PEP makes it
      <em>
       possible
      </em>
      to do this relatively
cleanly doesn't mean anyone
      <em>
       should
      </em>
      do this!
     </p>
    </div>
    <pre class="literal-block">
from collections import MutableMapping

# The MutableMapping + dict combination should give something that
# generally behaves correctly as a mapping, while still being accepted
# as a class namespace
class ClassNamespace(MutableMapping, dict):
    def __init__(self, cls):
        self._cls = cls
    def __len__(self):
        return len(dir(self._cls))
    def __iter__(self):
        for attr in dir(self._cls):
            yield attr
    def __contains__(self, attr):
        return hasattr(self._cls, attr)
    def __getitem__(self, attr):
        return getattr(self._cls, attr)
    def __setitem__(self, attr, value):
        setattr(self._cls, attr, value)
    def __delitem__(self, attr):
        delattr(self._cls, attr)

def extend(cls):
    return lambda: ClassNamespace(cls)

class Example:
    pass

class ExtendedExample(namespace=extend(Example)):
    a = 1
    b = 2
    c = 3

&gt;&gt;&gt; Example.a, Example.b, Example.c
(1, 2, 3)
</pre>
   </div>
  </div>
  <div class="section" id="rejected-design-options">
   <h1>
    <a class="toc-backref" href="#id29">
     Rejected Design Options
    </a>
   </h1>
   <div class="section" id="calling-autodecorate-from-type-init">
    <h2>
     <a class="toc-backref" href="#id30">
      Calling
      <tt class="docutils literal">
       __autodecorate__
      </tt>
      from
      <tt class="docutils literal">
       type.__init__
      </tt>
     </a>
    </h2>
    <p>
     Calling the new hook automatically from
     <tt class="docutils literal">
      type.__init__
     </tt>
     , would achieve most
of the goals of this PEP. However, using that approach would mean that
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     implementations would be unable to call any methods that
relied on the
     <tt class="docutils literal">
      __class__
     </tt>
     reference (or used the zero-argument form of
     <tt class="docutils literal">
      super()
     </tt>
     ), and could not make use of those features themselves.
    </p>
    <p>
     The current design instead ensures that the implicit decorator hook is able
to do anything an explicit decorator can do by running it after the initial
class creation is already complete.
    </p>
   </div>
   <div class="section" id="calling-the-automatic-decoration-hook-init-class">
    <h2>
     <a class="toc-backref" href="#id31">
      Calling the automatic decoration hook
      <tt class="docutils literal">
       __init_class__
      </tt>
     </a>
    </h2>
    <p>
     Earlier versions of the PEP used the name
     <tt class="docutils literal">
      __init_class__
     </tt>
     for the name
of the new hook. There were three significant problems with this name:
    </p>
    <ul class="simple">
     <li>
      it was hard to remember if the correct spelling was
      <tt class="docutils literal">
       __init_class__
      </tt>
      or
      <tt class="docutils literal">
       __class_init__
      </tt>
     </li>
     <li>
      the use of "init" in the name suggested the signature should match that
of
      <tt class="docutils literal">
       type.__init__
      </tt>
      , which is not the case
     </li>
     <li>
      the use of "init" in the name suggested the method would be run as part
of initial class object creation, which is not the case
     </li>
    </ul>
    <p>
     The new name
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     was chosen to make it clear that the new
initialisation hook is most usefully thought of as an implicitly invoked
class decorator, rather than as being like an
     <tt class="docutils literal">
      __init__
     </tt>
     method.
    </p>
   </div>
   <div class="section" id="requiring-an-explicit-decorator-on-autodecorate">
    <h2>
     <a class="toc-backref" href="#id32">
      Requiring an explicit decorator on
      <tt class="docutils literal">
       __autodecorate__
      </tt>
     </a>
    </h2>
    <p>
     Originally, this PEP required the explicit use of
     <tt class="docutils literal">
      @classmethod
     </tt>
     on the
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     decorator. It was made implicit since there's no
sensible interpretation for leaving it out, and that case would need to be
detected anyway in order to give a useful error message.
    </p>
    <p>
     This decision was reinforced after noticing that the user experience of
defining
     <tt class="docutils literal">
      __prepare__
     </tt>
     and forgetting the
     <tt class="docutils literal">
      @classmethod
     </tt>
     method
decorator is singularly incomprehensible (particularly since
     <a class="reference external" href="../pep-3115/index.html">
      PEP 3115
     </a>
     documents it as an ordinary method, and the current documentation doesn't
explicitly say anything one way or the other).
    </p>
   </div>
   <div class="section" id="making-autodecorate-implicitly-static-like-new">
    <h2>
     <a class="toc-backref" href="#id33">
      Making
      <tt class="docutils literal">
       __autodecorate__
      </tt>
      implicitly static, like
      <tt class="docutils literal">
       __new__
      </tt>
     </a>
    </h2>
    <p>
     While it accepts the class to be instantiated as the first argument,
     <tt class="docutils literal">
      __new__
     </tt>
     is actually implicitly treated as a static method rather than
as a class method. This allows it to be readily extracted from its
defining class and called directly on a subclass, rather than being
coupled to the class object it is retrieved from.
    </p>
    <p>
     Such behaviour initially appears to be potentially useful for the
new
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     hook, as it would allow
     <tt class="docutils literal">
      __autodecorate__
     </tt>
     methods to readily be used as explicit decorators on other classes.
    </p>
    <p>
     However, that apparent support would be an illusion as it would only work
correctly if invoked on a subclass, in which case the method can just as
readily be retrieved from the subclass and called that way. Unlike
     <tt class="docutils literal">
      __new__
     </tt>
     , there's no issue with potentially changing method signatures at
different points in the inheritance chain.
    </p>
   </div>
   <div class="section" id="passing-in-the-namespace-directly-rather-than-a-factory-function">
    <h2>
     <a class="toc-backref" href="#id34">
      Passing in the namespace directly rather than a factory function
     </a>
    </h2>
    <p>
     At one point, this PEP proposed that the class namespace be passed
directly as a keyword argument, rather than passing a factory function.
However, this encourages an unsupported behaviour (that is, passing the
same namespace to multiple classes, or retaining direct write access
to a mapping used as a class namespace), so the API was switched to
the factory function version.
    </p>
   </div>
  </div>
  <div class="section" id="reference-implementation">
   <h1>
    <a class="toc-backref" href="#id35">
     Reference Implementation
    </a>
   </h1>
   <p>
    A reference implementation for
    <tt class="docutils literal">
     __autodecorate__
    </tt>
    has been posted to the
    <a class="reference external" href="http://bugs.python.org/issue17044">
     issue tracker
    </a>
    <a class="footnote-reference" href="#id7" id="id8">
     [4]
    </a>
    . It uses the original
    <tt class="docutils literal">
     __init_class__
    </tt>
    naming. does not yet
allow the implicit decorator to replace the class with a different object and
does not implement the suggested
    <tt class="docutils literal">
     namespace
    </tt>
    parameter for
    <tt class="docutils literal">
     type.__prepare__
    </tt>
    .
   </p>
  </div>
  <div class="section" id="todo">
   <h1>
    <a class="toc-backref" href="#id36">
     TODO
    </a>
   </h1>
   <ul class="simple">
    <li>
     address the 5 points in
     <a class="reference external" href="http://mail.python.org/pipermail/python-dev/2013-February/123970.html">
      http://mail.python.org/pipermail/python-dev/2013-February/123970.html
     </a>
    </li>
   </ul>
  </div>
  <div class="section" id="references">
   <h1>
    <a class="toc-backref" href="#id37">
     References
    </a>
   </h1>
   <table class="docutils footnote" frame="void" id="id1" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id2">
        [1]
       </a>
      </td>
      <td>
       <a class="reference external" href="http://mail.python.org/pipermail/python-dev/2012-June/119878.html">
        http://mail.python.org/pipermail/python-dev/2012-June/119878.html
       </a>
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id3" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id4">
        [2]
       </a>
      </td>
      <td>
       <a class="reference external" href="http://mail.python.org/pipermail/python-dev/2001-November/018651.html">
        http://mail.python.org/pipermail/python-dev/2001-November/018651.html
       </a>
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id5" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id6">
        [3]
       </a>
      </td>
      <td>
       <a class="reference external" href="http://docs.zope.org/zope_secrets/extensionclass.html">
        http://docs.zope.org/zope_secrets/extensionclass.html
       </a>
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id7" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id8">
        [4]
       </a>
      </td>
      <td>
       <a class="reference external" href="http://bugs.python.org/issue17044">
        http://bugs.python.org/issue17044
       </a>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="section" id="copyright">
   <h1>
    <a class="toc-backref" href="#id38">
     Copyright
    </a>
   </h1>
   <p>
    This document has been placed in the public domain.
   </p>
   <!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
  </div>
 </body>

<!-- Mirrored from www.python.org/dev/peps/pep-0422/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 03 Sep 2015 04:38:15 GMT -->
</html>Source: <a href="https://hg.python.org/peps/file/tip/pep-0422.txt">https://hg.python.org/peps/file/tip/pep-0422.txt</a>

    </article>


                </section>

                


<aside class="left-sidebar" role="secondary">

    






    





        <div class="twitter-widget sidebar-widget">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/ThePSF" data-widget-id="434113224703610882">Tweets by @ThePSF</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>

    <div class="psf-sidebar-widget sidebar-widget">
        <h3 class="widget-title">The PSF</h3>
<p>The Python Software Foundation is the organization behind Python. Become a member of the PSF and help advance the software and our mission. </p>

    </div>

</aside>



                
                


            </div><!-- end .container -->
        </div><!-- end #content .content-wrapper -->

        <!-- Footer and social media list -->
        <footer id="site-map" class="main-footer" role="contentinfo">
            <div class="main-footer-links">
                <div class="container">

                    
                    <a id="back-to-top-1" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>

                    

<ul class="sitemap navigation menu do-not-print" role="tree" id="container">
    
    <li class="tier-1 element-1">
        <a href="https://www.python.org/about/" >About</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-2">
        <a href="https://www.python.org/downloads/" >Downloads</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-3">
        <a href="https://www.python.org/doc/" >Documentation</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="../index.html" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-4">
        <a href="https://www.python.org/community/" >Community</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://www.python.org/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="https://www.python.org/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-5">
        <a href="https://www.python.org/about/success/" title="success-stories">Success Stories</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://www.python.org/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-6">
        <a href="https://www.python.org/blogs/" title="News from around the Python world">News</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-7">
        <a href="https://www.python.org/events/" >Events</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-8">
        <a href="https://www.python.org/dev/" >Contributing</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="http://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://bugs.python.org/" title="">Issue Tracker</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://mail.python.org/mailman/listinfo/python-dev" title="">python-dev list</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pythonmentors.com/" title="">Core Mentorship</a></li>
    
</ul>

        
    </li>
    
</ul>


                    <a id="back-to-top-2" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>
                    

                </div><!-- end .container -->
            </div> <!-- end .main-footer-links -->

            <div class="site-base">
                <div class="container">
                    
                    <ul class="footer-links navigation menu do-not-print" role="tree">
                        <li class="tier-1 element-1"><a href="https://www.python.org/about/help/">Help &amp; <span class="say-no-more">General</span> Contact</a></li>
                        <li class="tier-1 element-2"><a href="https://www.python.org/community/diversity/">Diversity <span class="say-no-more">Initiatives</span></a></li>
                        <li class="tier-1 element-3"><a href="https://github.com/python/pythondotorg/issues">Submit Website Bug</a></li>
                        <!--<li class="tier-1 element-3"><a href="#"><span class="say-no-more">Website</span> Colophon</a></li>-->
                    </ul>

                    <div class="copyright">
                        <p><small>
                            <span class="pre">Copyright &copy;2001-2015.</span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/psf-landing/">Python Software Foundation</a></span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/about/legal/">Legal Statements</a></span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/privacy/">Privacy Policy</a></span>
                        </small></p>
                    </div>

                </div><!-- end .container -->
            </div><!-- end .site-base -->

        </footer>

    </div><!-- end #touchnav-wrapper -->

    
    <script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../../static/js/libs/jquery-1.8.2.min.js"><\/script>')</script>

    <script src="../../../static/js/libs/masonry.pkgd.min.js"></script>

    <script type="text/javascript" src="../../../static/js/main-min.js" charset="utf-8"></script>
    

    <!--[if lte IE 7]>
    <script type="text/javascript" src="/static/js/plugins/IE8-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    <!--[if lte IE 8]>
    <script type="text/javascript" src="/static/js/plugins/getComputedStyle-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    

    
    

</body>
</html>

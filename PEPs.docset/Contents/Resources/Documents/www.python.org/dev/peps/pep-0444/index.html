<!doctype html>
<!--[if lt IE 7]>   <html class="no-js ie6 lt-ie7 lt-ie8 lt-ie9">   <![endif]-->
<!--[if IE 7]>      <html class="no-js ie7 lt-ie8 lt-ie9">          <![endif]-->
<!--[if IE 8]>      <html class="no-js ie8 lt-ie9">                 <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en" dir="ltr">  <!--<![endif]-->


<!-- Mirrored from www.python.org/dev/peps/pep-0444/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 03 Sep 2015 04:36:56 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="prefetch" href="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">

    <meta name="application-name" content="Python.org">
    <meta name="msapplication-tooltip" content="The official home of the Python Programming Language">
    <meta name="apple-mobile-web-app-title" content="Python.org">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="HandheldFriendly" content="True">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cleartype" content="on">
    <meta http-equiv="imagetoolbar" content="false">

    <script src="../../../static/js/libs/modernizr.js"></script>

    <link href="../../../static/stylesheets/style.css" rel="stylesheet" type="text/css" title="default" />
    <link href="../../../static/stylesheets/mq.css" rel="stylesheet" type="text/css" media="not print, braille, embossed, speech, tty" />
    

    <!--[if (lte IE 8)&(!IEMobile)]>
    <link href="/static/stylesheets/no-mq.css" rel="stylesheet" type="text/css" media="screen" />
    
    
    <![endif]-->

    
    <link rel="icon" type="image/x-icon" href="https://www.python.org/static/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../static/apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../static/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../static/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../../../static/apple-touch-icon-precomposed.png">
    <link rel="apple-touch-icon" href="../../../static/apple-touch-icon-precomposed.png">

    
    <meta name="msapplication-TileImage" content="/static/metro-icon-144x144-precomposed.png"><!-- white shape -->
    <meta name="msapplication-TileColor" content="#3673a5"><!-- python blue -->
    <meta name="msapplication-navbutton-color" content="#3673a5">

    <meta property="og:site_name" content="Python.org">
    <meta property="og:type" content="website">

    <title>PEP 0444 -- Python Web3 Interface | Python.org</title>
    <meta property="og:title" content="Welcome to Python.org">

    
    <meta name="description" content="The official home of the Python Programming Language">
    <meta name="og:description" content="The official home of the Python Programming Language">
    <meta name="keywords" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:tag" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:published_time" content="">
    <meta property="og:modified_time" content="">
    <meta property="og:author" content="">
    <meta property="og:section" content=""> 
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:video" content="">

    <link rel="author" href="https://www.python.org/static/humans.txt">

    

    
    <script type="application/ld+json">
     {
       "@context": "http://schema.org",
       "@type": "WebSite",
       "url": "https://www.python.org/",
       "potentialAction": {
         "@type": "SearchAction",
         "target": "https://www.python.org/search/?q={search_term_string}",
         "query-input": "required name=search_term_string"
       }
     }
    </script>

    
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39055973-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    
</head>

<body class="python pages pep-page">

    <div id="touchnav-wrapper">

        <div id="nojs" class="do-not-print">
            <p><strong>Notice:</strong> While Javascript is not essential for this website, your interaction with the content will be limited. Please turn Javascript on for the full experience. </p>
        </div>

        <!--[if lt IE 8]>
        <div id="oldie-warning" class="do-not-print">
            <p><strong>Notice:</strong> Your browser is <em>ancient</em> and <a href="http://www.ie6countdown.com/">Microsoft agrees</a>. <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience a better web.</p>
        </div>
        <![endif]-->

        <!-- Sister Site Links -->
        <div id="top" class="top-bar do-not-print">

            <nav class="meta-navigation container" role="navigation">

                
                <div class="skip-link screen-reader-text">
                    <a href="#content" title="Skip to content">Skip to content</a>
                </div>

                
                <a id="close-python-network" class="jump-link" href="#python-network" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-down"><span>&#9660;</span></span> Close
                </a>

                

<ul class="menu" role="tree">
    
    <li class="python-meta ">
        <a href="https://www.python.org/" title="The Python Programming Language" >Python</a>
    </li>
    
    <li class="psf-meta ">
        <a href="https://www.python.org/psf-landing/" title="The Python Software Foundation" >PSF</a>
    </li>
    
    <li class="docs-meta ">
        <a href="https://docs.python.org/" title="Python Documentation" >Docs</a>
    </li>
    
    <li class="pypi-meta ">
        <a href="https://pypi.python.org/" title="Python Package Index" >PyPI</a>
    </li>
    
    <li class="jobs-meta ">
        <a href="https://www.python.org/jobs/" title="Python Job Board" >Jobs</a>
    </li>
    
    <li class="shop-meta ">
        <a href="https://www.python.org/community/" title="Python Community" >Community</a>
    </li>
    
</ul>


                <a id="python-network" class="jump-link" href="#top" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> The Python Network
                </a>

            </nav>

        </div>

        <!-- Header elements -->
        <header class="main-header" role="banner">
            <div class="container">

                <h1 class="site-headline">
                    <a href="https://www.python.org/"><img class="python-logo" src="../../../static/img/python-logo.png" alt="python&trade;"></a>
                </h1>

                <div class="options-bar do-not-print">

                    
                    <a id="site-map-link" class="jump-to-menu" href="#site-map"><span class="menu-icon">&equiv;</span> Menu</a><form class="search-the-site" action="https://www.python.org/search/" method="get">
                        <fieldset title="Search Python.org">

                            <span aria-hidden="true" class="icon-search"></span>

                            <label class="screen-reader-text" for="id-search-field">Search This Site</label>
                            <input id="id-search-field" name="q" type="search" role="textbox" class="search-field" placeholder="Search" value="" tabindex="1">

                            <button type="submit" name="submit" id="submit" class="search-button" title="Submit this Search" tabindex="3">
                                GO
                            </button>

                            
                            <!--[if IE]><input type="text" style="display: none;" disabled="disabled" size="1" tabindex="4"><![endif]-->

                        </fieldset>
                    </form><span class="breaker"></span><div class="adjust-font-size" aria-hidden="true">
                        <ul class="navigation menu" aria-label="Adjust Text Size on Page">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger"><strong><small>A</small> A</strong></a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a class="text-shrink" title="Make Text Smaller" href="javascript:;">Smaller</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a class="text-grow" title="Make Text Larger" href="javascript:;">Larger</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a class="text-reset" title="Reset any font size changes I have made" href="javascript:;">Reset</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="winkwink-nudgenudge">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger">Socialize</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="http://plus.google.com/+Python"><span aria-hidden="true" class="icon-google-plus"></span>Google+</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="http://www.facebook.com/pythonlang?fref=ts"><span aria-hidden="true" class="icon-facebook"></span>Facebook</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a href="http://twitter.com/ThePSF"><span aria-hidden="true" class="icon-twitter"></span>Twitter</a></li>
                                    <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/irc/"><span aria-hidden="true" class="icon-freenode"></span>Chat on IRC</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="account-signin">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                
                                <a href="https://www.python.org/accounts/login/" title="Sign Up or Sign In to Python.org">Sign In</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/accounts/signup/">Sign Up / Register</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/accounts/login/">Sign In</a></li>
                                </ul>
                                
                            </li>
                        </ul>
                    </div>

                </div><!-- end options-bar -->

                <nav id="mainnav" class="python-navigation main-navigation do-not-print" role="navigation">
                    
                        
<ul class="navigation menu" role="menubar" aria-label="Main Navigation">
  
    
    
    <li id="about" class="tier-1 element-1  " aria-haspopup="true">
        <a href="https://www.python.org/about/" title="" class="">About</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="downloads" class="tier-1 element-2  " aria-haspopup="true">
        <a href="https://www.python.org/downloads/" title="" class="">Downloads</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="documentation" class="tier-1 element-3  " aria-haspopup="true">
        <a href="https://www.python.org/doc/" title="" class="">Documentation</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="../index.html" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="community" class="tier-1 element-4  " aria-haspopup="true">
        <a href="https://www.python.org/community/" title="" class="">Community</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://www.python.org/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="https://www.python.org/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="success-stories" class="tier-1 element-5  " aria-haspopup="true">
        <a href="https://www.python.org/about/success/" title="success-stories" class="">Success Stories</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://www.python.org/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="news" class="tier-1 element-6  " aria-haspopup="true">
        <a href="https://www.python.org/blogs/" title="News from around the Python world" class="">News</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="events" class="tier-1 element-7  " aria-haspopup="true">
        <a href="https://www.python.org/events/" title="" class="">Events</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    
    
    
  
</ul>

                    
                </nav>

                <div class="header-banner "> <!-- for optional "do-not-print" class -->
                    
                    
                </div>

                
                

             </div><!-- end .container -->
        </header>

        <div id="content" class="content-wrapper">
            <!-- Main Content Column -->
            <div class="container">

                <section class="main-content with-left-sidebar" role="main">

                    
<ul class="breadcrumbs menu">
    <li>
        <a href="https://www.python.org/" title="The Python Programming Language">Python</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="https://www.python.org/dev/">Python Developer's Guide</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="../index.html">PEP Index</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>PEP 0444 -- Python Web3 Interface</li>
</ul>


                    
<style>
   .pep-page pre {
        padding: .5em;
        background: inherit;
        border-left: 0px;
        -webkit-box-shadow: 0 0 0 0;
        -moz-box-shadow: 0 0 0 0;
        box-shadow: 0 0 0 0;
   }
</style>

    
    <article class="text">
        

        <header class="article-header">
            <h1 class="page-title">PEP 0444 -- Python Web3 Interface</h1>
        </header>

        <!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<html>
 <body>
  <table class="rfc2822 docutils field-list" frame="void" rules="none">
   <col class="field-name">
   </col>
   <col class="field-body">
   </col>
   <tbody valign="top">
    <tr class="field">
     <th class="field-name">
      PEP:
     </th>
     <td class="field-body">
      444
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Title:
     </th>
     <td class="field-body">
      Python Web3 Interface
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Author:
     </th>
     <td class="field-body">
      Chris McDonough &lt;chrism at plope.com&gt;,
Armin Ronacher &lt;armin.ronacher at active-4.com&gt;
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Discussions-To:
     </th>
     <td class="field-body">
      Python Web-SIG &lt;
      <a class="reference external" href="mailto:web-sig@python.org?subject=PEP%20444">
       web-sig at python.org
      </a>
      &gt;
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Status:
     </th>
     <td class="field-body">
      Deferred
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Type:
     </th>
     <td class="field-body">
      Informational
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Created:
     </th>
     <td class="field-body">
      19-Jul-2010
     </td>
    </tr>
   </tbody>
  </table>
  <hr/>
  <div class="contents topic" id="contents">
   <p class="topic-title first">
    Contents
   </p>
   <ul class="simple">
    <li>
     <a class="reference internal" href="#abstract" id="id20">
      Abstract
     </a>
    </li>
    <li>
     <a class="reference internal" href="#pep-deferral" id="id21">
      PEP Deferral
     </a>
    </li>
    <li>
     <a class="reference internal" href="#rationale-and-goals" id="id22">
      Rationale and Goals
     </a>
    </li>
    <li>
     <a class="reference internal" href="#differences-from-wsgi" id="id23">
      Differences from WSGI
     </a>
    </li>
    <li>
     <a class="reference internal" href="#specification-overview" id="id24">
      Specification Overview
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#the-application-framework-side" id="id25">
        The Application/Framework Side
       </a>
      </li>
      <li>
       <a class="reference internal" href="#the-server-gateway-side" id="id26">
        The Server/Gateway Side
       </a>
      </li>
      <li>
       <a class="reference internal" href="#middleware-components-that-play-both-sides" id="id27">
        Middleware: Components that Play Both Sides
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#specification-details" id="id28">
      Specification Details
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#environ-variables" id="id29">
        <tt class="docutils literal">
         environ
        </tt>
        Variables
       </a>
       <ul>
        <li>
         <a class="reference internal" href="#input-stream" id="id30">
          Input Stream
         </a>
        </li>
        <li>
         <a class="reference internal" href="#error-stream" id="id31">
          Error Stream
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="reference internal" href="#values-returned-by-a-web3-application" id="id32">
        Values Returned by A Web3 Application
       </a>
      </li>
      <li>
       <a class="reference internal" href="#dealing-with-compatibility-across-python-versions" id="id33">
        Dealing with Compatibility Across Python Versions
       </a>
      </li>
      <li>
       <a class="reference internal" href="#buffering-and-streaming" id="id34">
        Buffering and Streaming
       </a>
      </li>
      <li>
       <a class="reference internal" href="#unicode-issues" id="id35">
        Unicode Issues
       </a>
      </li>
      <li>
       <a class="reference internal" href="#http-1-1-expect-continue" id="id36">
        HTTP 1.1 Expect/Continue
       </a>
      </li>
      <li>
       <a class="reference internal" href="#other-http-features" id="id37">
        Other HTTP Features
       </a>
      </li>
      <li>
       <a class="reference internal" href="#thread-support" id="id38">
        Thread Support
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#implementation-application-notes" id="id39">
      Implementation/Application Notes
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#server-extension-apis" id="id40">
        Server Extension APIs
       </a>
      </li>
      <li>
       <a class="reference internal" href="#application-configuration" id="id41">
        Application Configuration
       </a>
      </li>
      <li>
       <a class="reference internal" href="#url-reconstruction" id="id42">
        URL Reconstruction
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#open-questions" id="id43">
      Open Questions
     </a>
    </li>
    <li>
     <a class="reference internal" href="#points-of-contention" id="id44">
      Points of Contention
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#wsgi-1-0-compatibility" id="id45">
        WSGI 1.0 Compatibility
       </a>
      </li>
      <li>
       <a class="reference internal" href="#environ-and-response-values-as-bytes" id="id46">
        Environ and Response Values as Bytes
       </a>
      </li>
      <li>
       <a class="reference internal" href="#applications-should-be-allowed-to-read-web3-input-past-content-length" id="id47">
        Applications Should be Allowed to Read
        <tt class="docutils literal">
         web3.input
        </tt>
        Past
        <tt class="docutils literal">
         CONTENT_LENGTH
        </tt>
       </a>
      </li>
      <li>
       <a class="reference internal" href="#web3-input-unknown-length" id="id48">
        <tt class="docutils literal">
         web3.input
        </tt>
        Unknown Length
       </a>
      </li>
      <li>
       <a class="reference internal" href="#read-of-web3-input-should-support-no-size-calling-convention" id="id49">
        <tt class="docutils literal">
         read()
        </tt>
        of
        <tt class="docutils literal">
         web3.input
        </tt>
        Should Support No-Size Calling Convention
       </a>
       <ul>
        <li>
         <a class="reference internal" href="#input-filters-should-set-environ-content-length-to-1" id="id50">
          Input Filters should set environ
          <tt class="docutils literal">
           CONTENT_LENGTH
          </tt>
          to -1
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="reference internal" href="#headers-as-literal-list-of-two-tuples" id="id51">
        <tt class="docutils literal">
         headers
        </tt>
        as Literal List of Two-Tuples
       </a>
      </li>
      <li>
       <a class="reference internal" href="#removed-requirement-that-middleware-not-block" id="id52">
        Removed Requirement that Middleware Not Block
       </a>
      </li>
      <li>
       <a class="reference internal" href="#web3-script-name-and-web3-path-info" id="id53">
        <tt class="docutils literal">
         web3.script_name
        </tt>
        and
        <tt class="docutils literal">
         web3.path_info
        </tt>
       </a>
      </li>
      <li>
       <a class="reference internal" href="#long-response-headers" id="id54">
        Long Response Headers
       </a>
      </li>
      <li>
       <a class="reference internal" href="#request-trailers-and-chunked-transfer-encoding" id="id55">
        Request Trailers and Chunked Transfer Encoding
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#references" id="id56">
      References
     </a>
    </li>
    <li>
     <a class="reference internal" href="#copyright" id="id57">
      Copyright
     </a>
    </li>
   </ul>
  </div>
  <div class="section" id="abstract">
   <h1>
    <a class="toc-backref" href="#id20">
     Abstract
    </a>
   </h1>
   <p>
    This document specifies a proposed second-generation standard
interface between web servers and Python web applications or
frameworks.
   </p>
  </div>
  <div class="section" id="pep-deferral">
   <h1>
    <a class="toc-backref" href="#id21">
     PEP Deferral
    </a>
   </h1>
   <p>
    Further exploration of the concepts covered in this PEP has been deferred
for lack of a current champion interested in promoting the goals of the PEP
and collecting and incorporating feedback, and with sufficient available
time to do so effectively.
   </p>
   <p>
    Note that since this PEP was first created,
    <a class="reference external" href="../pep-3333/index.html">
     PEP 3333
    </a>
    was created as a more
incremental update that permitted use of WSGI on Python 3.2+. However, an
alternative specification that furthers the Python 3 goals of a cleaner
separation of binary and text data may still be valuable.
   </p>
  </div>
  <div class="section" id="rationale-and-goals">
   <h1>
    <a class="toc-backref" href="#id22">
     Rationale and Goals
    </a>
   </h1>
   <p>
    This protocol and specification is influenced heavily by the Web
Services Gateway Interface (WSGI) 1.0 standard described in
    <a class="reference external" href="../pep-0333/index.html">
     PEP 333
    </a>
    <a class="footnote-reference" href="#id13" id="id1">
     [1]
    </a>
    .  The high-level rationale for having any standard that allows
Python-based web servers and applications to interoperate is outlined
in
    <a class="reference external" href="../pep-0333/index.html">
     PEP 333
    </a>
    .  This document essentially uses
    <a class="reference external" href="../pep-0333/index.html">
     PEP 333
    </a>
    as a template, and
changes its wording in various places for the purpose of forming a
different standard.
   </p>
   <p>
    Python currently boasts a wide variety of web application frameworks
which use the WSGI 1.0 protocol.  However, due to changes in the
language, the WSGI 1.0 protocol is not compatible with Python 3.  This
specification describes a standardized WSGI-like protocol that lets
Python 2.6, 2.7 and 3.1+ applications communicate with web servers.
Web3 is clearly a WSGI derivative; it only uses a different name than
"WSGI" in order to indicate that it is not in any way backwards
compatible.
   </p>
   <p>
    Applications and servers which are written to this specification are
meant to work properly under Python 2.6.X, Python 2.7.X and Python
3.1+.  Neither an application nor a server that implements the Web3
specification can be easily written which will work under Python 2
versions earlier than 2.6 nor Python 3 versions earlier than 3.1.
   </p>
   <div class="note">
    <p class="first admonition-title">
     Note
    </p>
    <p class="last">
     Whatever Python 3 version fixed
     <a class="reference external" href="http://bugs.python.org/issue4006">
      http://bugs.python.org/issue4006
     </a>
     so
     <tt class="docutils literal">
      <span class="pre">
       os.environ['foo']
      </span>
     </tt>
     returns surrogates (ala
     <a class="reference external" href="../pep-0383/index.html">
      PEP 383
     </a>
     ) when the
value of 'foo' cannot be decoded using the current locale instead
of failing with a KeyError is the
     <em>
      true
     </em>
     minimum Python 3 version.
In particular, however, Python 3.0 is not supported.
    </p>
   </div>
   <div class="note">
    <p class="first admonition-title">
     Note
    </p>
    <p class="last">
     Python 2.6 is the first Python version that supported an alias for
     <tt class="docutils literal">
      bytes
     </tt>
     and the
     <tt class="docutils literal">
      b"foo"
     </tt>
     literal syntax.  This is why it is the
minimum version supported by Web3.
    </p>
   </div>
   <p>
    Explicability and documentability are the main technical drivers for
the decisions made within the standard.
   </p>
  </div>
  <div class="section" id="differences-from-wsgi">
   <h1>
    <a class="toc-backref" href="#id23">
     Differences from WSGI
    </a>
   </h1>
   <ul class="simple">
    <li>
     All protocol-specific environment names are prefixed with
     <tt class="docutils literal">
      web3.
     </tt>
     rather than
     <tt class="docutils literal">
      wsgi.
     </tt>
     , eg.
     <tt class="docutils literal">
      web3.input
     </tt>
     rather than
     <tt class="docutils literal">
      wsgi.input
     </tt>
     .
    </li>
    <li>
     All values present as environment dictionary
     <em>
      values
     </em>
     are explicitly
     <em>
      bytes
     </em>
     instances instead of native strings.  (Environment
     <em>
      keys
     </em>
     however are native strings, always
     <tt class="docutils literal">
      str
     </tt>
     regardless of
platform).
    </li>
    <li>
     All values returned by an application must be bytes instances,
including status code, header names and values, and the body.
    </li>
    <li>
     Wherever WSGI 1.0 referred to an
     <tt class="docutils literal">
      app_iter
     </tt>
     , this specification
refers to a
     <tt class="docutils literal">
      body
     </tt>
     .
    </li>
    <li>
     No
     <tt class="docutils literal">
      start_response()
     </tt>
     callback (and therefore no
     <tt class="docutils literal">
      write()
     </tt>
     callable nor
     <tt class="docutils literal">
      exc_info
     </tt>
     data).
    </li>
    <li>
     The
     <tt class="docutils literal">
      readline()
     </tt>
     function of
     <tt class="docutils literal">
      web3.input
     </tt>
     must support a size
hint parameter.
    </li>
    <li>
     The
     <tt class="docutils literal">
      read()
     </tt>
     function of
     <tt class="docutils literal">
      web3.input
     </tt>
     must be length delimited.
A call without a size argument must not read more than the content
length header specifies.  In case a content length header is absent
the stream must not return anything on read.  It must never request
more data than specified from the client.
    </li>
    <li>
     No requirement for middleware to yield an empty string if it needs
more information from an application to produce output (e.g. no
"Middleware Handling of Block Boundaries").
    </li>
    <li>
     Filelike objects passed to a "file_wrapper" must have an
     <tt class="docutils literal">
      __iter__
     </tt>
     which returns bytes (never text).
    </li>
    <li>
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     is not supported.
    </li>
    <li>
     <tt class="docutils literal">
      QUERY_STRING
     </tt>
     ,
     <tt class="docutils literal">
      SCRIPT_NAME
     </tt>
     ,
     <tt class="docutils literal">
      PATH_INFO
     </tt>
     values required to
be placed in environ by server (each as the empty bytes instance if
no associated value is received in the HTTP request).
    </li>
    <li>
     <tt class="docutils literal">
      web3.path_info
     </tt>
     and
     <tt class="docutils literal">
      web3.script_name
     </tt>
     should be put into the
Web3 environment, if possible, by the origin Web3 server.  When
available, each is the original, plain 7-bit ASCII, URL-encoded
variant of its CGI equivalent derived directly from the request URI
(with %2F segment markers and other meta-characters intact).  If the
server cannot provide one (or both) of these values, it must omit
the value(s) it cannot provide from the environment.
    </li>
    <li>
     This requirement was removed: "middleware components
     <strong>
      must not
     </strong>
     block iteration waiting for multiple values from an application
iterable.  If the middleware needs to accumulate more data from the
application before it can produce any output, it
     <strong>
      must
     </strong>
     yield an
empty string."
    </li>
    <li>
     <tt class="docutils literal">
      SERVER_PORT
     </tt>
     must be a bytes instance (not an integer).
    </li>
    <li>
     The server must not inject an additional
     <tt class="docutils literal">
      <span class="pre">
       Content-Length
      </span>
     </tt>
     header
by guessing the length from the response iterable.  This must be set
by the application itself in all situations.
    </li>
    <li>
     If the origin server advertises that it has the
     <tt class="docutils literal">
      web3.async
     </tt>
     capability, a Web3 application callable used by the server is
permitted to return a callable that accepts no arguments.  When it
does so, this callable is to be called periodically by the origin
server until it returns a non-
     <tt class="docutils literal">
      None
     </tt>
     response, which must be a
normal Web3 response tuple.
     <!-- XXX (chrism) Needs a section of its own for explanation. -->
    </li>
   </ul>
  </div>
  <div class="section" id="specification-overview">
   <h1>
    <a class="toc-backref" href="#id24">
     Specification Overview
    </a>
   </h1>
   <p>
    The Web3 interface has two sides: the "server" or "gateway" side, and
the "application" or "framework" side.  The server side invokes a
callable object that is provided by the application side.  The
specifics of how that object is provided are up to the server or
gateway.  It is assumed that some servers or gateways will require an
application's deployer to write a short script to create an instance
of the server or gateway, and supply it with the application object.
Other servers and gateways may use configuration files or other
mechanisms to specify where an application object should be imported
from, or otherwise obtained.
   </p>
   <p>
    In addition to "pure" servers/gateways and applications/frameworks, it
is also possible to create "middleware" components that implement both
sides of this specification.  Such components act as an application to
their containing server, and as a server to a contained application,
and can be used to provide extended APIs, content transformation,
navigation, and other useful functions.
   </p>
   <p>
    Throughout this specification, we will use the term "application
callable" to mean "a function, a method, or an instance with a
    <tt class="docutils literal">
     __call__
    </tt>
    method".  It is up to the server, gateway, or application
implementing the application callable to choose the appropriate
implementation technique for their needs.  Conversely, a server,
gateway, or application that is invoking a callable
    <strong>
     must not
    </strong>
    have
any dependency on what kind of callable was provided to it.
Application callables are only to be called, not introspected upon.
   </p>
   <div class="section" id="the-application-framework-side">
    <h2>
     <a class="toc-backref" href="#id25">
      The Application/Framework Side
     </a>
    </h2>
    <p>
     The application object is simply a callable object that accepts one
argument.  The term "object" should not be misconstrued as requiring
an actual object instance: a function, method, or instance with a
     <tt class="docutils literal">
      __call__
     </tt>
     method are all acceptable for use as an application
object.  Application objects must be able to be invoked more than
once, as virtually all servers/gateways (other than CGI) will make
such repeated requests.  If this cannot be guaranteed by the
implementation of the actual application, it has to be wrapped in a
function that creates a new instance on each call.
    </p>
    <div class="note">
     <p class="first admonition-title">
      Note
     </p>
     <p class="last">
      Although we refer to it as an "application" object, this should not
be construed to mean that application developers will use Web3 as a
web programming API.  It is assumed that application developers
will continue to use existing, high-level framework services to
develop their applications.  Web3 is a tool for framework and
server developers, and is not intended to directly support
application developers.)
     </p>
    </div>
    <p>
     An example of an application which is a function (
     <tt class="docutils literal">
      simple_app
     </tt>
     ):
    </p>
    <pre class="literal-block">
def simple_app(environ):
    """Simplest possible application object"""
    status = b'200 OK'
    headers = [(b'Content-type', b'text/plain')]
    body = [b'Hello world!\n']
    return body, status, headers
</pre>
    <p>
     An example of an application which is an instance (
     <tt class="docutils literal">
      simple_app
     </tt>
     ):
    </p>
    <pre class="literal-block">
class AppClass(object):

    """Produce the same output, but using an instance.  An
    instance of this class must be instantiated before it is
    passed to the server.  """

  def __call__(self, environ):
        status = b'200 OK'
        headers = [(b'Content-type', b'text/plain')]
        body = [b'Hello world!\n']
        return body, status, headers

simple_app = AppClass()
</pre>
    <p>
     Alternately, an application callable may return a callable instead of
the tuple if the server supports asynchronous execution.  See
information concerning
     <tt class="docutils literal">
      web3.async
     </tt>
     for more information.
    </p>
   </div>
   <div class="section" id="the-server-gateway-side">
    <h2>
     <a class="toc-backref" href="#id26">
      The Server/Gateway Side
     </a>
    </h2>
    <p>
     The server or gateway invokes the application callable once for each
request it receives from an HTTP client, that is directed at the
application.  To illustrate, here is a simple CGI gateway, implemented
as a function taking an application object.  Note that this simple
example has limited error handling, because by default an uncaught
exception will be dumped to
     <tt class="docutils literal">
      sys.stderr
     </tt>
     and logged by the web
server.
    </p>
    <pre class="literal-block">
import locale
import os
import sys

encoding = locale.getpreferredencoding()

stdout = sys.stdout

if hasattr(sys.stdout, 'buffer'):
    # Python 3 compatibility; we need to be able to push bytes out
    stdout = sys.stdout.buffer

def get_environ():
    d = {}
    for k, v in os.environ.items():
        # Python 3 compatibility
        if not isinstance(v, bytes):
            # We must explicitly encode the string to bytes under
            # Python 3.1+
            v = v.encode(encoding, 'surrogateescape')
        d[k] = v
    return d

def run_with_cgi(application):

    environ = get_environ()
    environ['web3.input']        = sys.stdin
    environ['web3.errors']       = sys.stderr
    environ['web3.version']      = (1, 0)
    environ['web3.multithread']  = False
    environ['web3.multiprocess'] = True
    environ['web3.run_once']     = True
    environ['web3.async']        = False

    if environ.get('HTTPS', b'off') in (b'on', b'1'):
        environ['web3.url_scheme'] = b'https'
    else:
        environ['web3.url_scheme'] = b'http'

    rv = application(environ)
    if hasattr(rv, '__call__'):
        raise TypeError('This webserver does not support asynchronous '
                        'responses.')
    body, status, headers = rv

    CLRF = b'\r\n'

    try:
        stdout.write(b'Status: ' + status + CRLF)
        for header_name, header_val in headers:
            stdout.write(header_name + b': ' + header_val + CRLF)
        stdout.write(CRLF)
        for chunk in body:
            stdout.write(chunk)
            stdout.flush()
    finally:
        if hasattr(body, 'close'):
            body.close()
</pre>
   </div>
   <div class="section" id="middleware-components-that-play-both-sides">
    <h2>
     <a class="toc-backref" href="#id27">
      Middleware: Components that Play Both Sides
     </a>
    </h2>
    <p>
     A single object may play the role of a server with respect to some
application(s), while also acting as an application with respect to
some server(s).  Such "middleware" components can perform such
functions as:
    </p>
    <ul class="simple">
     <li>
      Routing a request to different application objects based on the
target URL, after rewriting the
      <tt class="docutils literal">
       environ
      </tt>
      accordingly.
     </li>
     <li>
      Allowing multiple applications or frameworks to run side-by-side in
the same process.
     </li>
     <li>
      Load balancing and remote processing, by forwarding requests and
responses over a network.
     </li>
     <li>
      Perform content postprocessing, such as applying XSL stylesheets.
     </li>
    </ul>
    <p>
     The presence of middleware in general is transparent to both the
"server/gateway" and the "application/framework" sides of the
interface, and should require no special support.  A user who desires
to incorporate middleware into an application simply provides the
middleware component to the server, as if it were an application, and
configures the middleware component to invoke the application, as if
the middleware component were a server.  Of course, the "application"
that the middleware wraps may in fact be another middleware component
wrapping another application, and so on, creating what is referred to
as a "middleware stack".
    </p>
    <p>
     A middleware must support asychronous execution if possible or fall
back to disabling itself.
    </p>
    <p>
     Here a middleware that changes the
     <tt class="docutils literal">
      HTTP_HOST
     </tt>
     key if an
     <tt class="docutils literal">
      <span class="pre">
       X-Host
      </span>
     </tt>
     header exists and adds a comment to all html responses:
    </p>
    <pre class="literal-block">
import time

def apply_filter(app, environ, filter_func):
    """Helper function that passes the return value from an
    application to a filter function when the results are
    ready.
    """
    app_response = app(environ)

    # synchronous response, filter now
    if not hasattr(app_response, '__call__'):
        return filter_func(*app_response)

    # asychronous response.  filter when results are ready
    def polling_function():
        rv = app_response()
        if rv is not None:
            return filter_func(*rv)
    return polling_function

def proxy_and_timing_support(app):
    def new_application(environ):
        def filter_func(body, status, headers):
            now = time.time()
            for key, value in headers:
                if key.lower() == b'content-type' and \
                   value.split(b';')[0] == b'text/html':
                    # assumes ascii compatible encoding in body,
                    # but the middleware should actually parse the
                    # content type header and figure out the
                    # encoding when doing that.
                    body += ('&lt;!-- Execution time: %.2fsec --&gt;' %
                             (now - then)).encode('ascii')
                    break
            return body, status, headers
        then = time.time()
        host = environ.get('HTTP_X_HOST')
        if host is not None:
            environ['HTTP_HOST'] = host

        # use the apply_filter function that applies a given filter
        # function for both async and sync responses.
        return apply_filter(app, environ, filter_func)
    return new_application

app = proxy_and_timing_support(app)
</pre>
   </div>
  </div>
  <div class="section" id="specification-details">
   <h1>
    <a class="toc-backref" href="#id28">
     Specification Details
    </a>
   </h1>
   <p>
    The application callable must accept one positional argument.  For the
sake of illustration, we have named it
    <tt class="docutils literal">
     environ
    </tt>
    , but it is not
required to have this name.  A server or gateway
    <strong>
     must
    </strong>
    invoke the
application object using a positional (not keyword) argument.
(E.g. by calling
    <tt class="docutils literal">
     body, status, headers = application(environ)
    </tt>
    as
shown above.)
   </p>
   <p>
    The
    <tt class="docutils literal">
     environ
    </tt>
    parameter is a dictionary object, containing CGI-style
environment variables.  This object
    <strong>
     must
    </strong>
    be a builtin Python
dictionary (
    <em>
     not
    </em>
    a subclass,
    <tt class="docutils literal">
     UserDict
    </tt>
    or other dictionary
emulation), and the application is allowed to modify the dictionary in
any way it desires.  The dictionary must also include certain
Web3-required variables (described in a later section), and may also
include server-specific extension variables, named according to a
convention that will be described below.
   </p>
   <p>
    When called by the server, the application object must return a tuple
yielding three elements:
    <tt class="docutils literal">
     status
    </tt>
    ,
    <tt class="docutils literal">
     headers
    </tt>
    and
    <tt class="docutils literal">
     body
    </tt>
    , or, if
supported by an async server, an argumentless callable which either
returns
    <tt class="docutils literal">
     None
    </tt>
    or a tuple of those three elements.
   </p>
   <p>
    The
    <tt class="docutils literal">
     status
    </tt>
    element is a status in bytes of the form
    <tt class="docutils literal">
     b'999
Message here'
    </tt>
    .
   </p>
   <p>
    <tt class="docutils literal">
     headers
    </tt>
    is a Python list of
    <tt class="docutils literal">
     (header_name, header_value)
    </tt>
    pairs
describing the HTTP response header.  The
    <tt class="docutils literal">
     headers
    </tt>
    structure must
be a literal Python list; it must yield two-tuples.  Both
    <tt class="docutils literal">
     header_name
    </tt>
    and
    <tt class="docutils literal">
     header_value
    </tt>
    must be bytes values.
   </p>
   <p>
    The
    <tt class="docutils literal">
     body
    </tt>
    is an iterable yielding zero or more bytes instances.
This can be accomplished in a variety of ways, such as by returning a
list containing bytes instances as
    <tt class="docutils literal">
     body
    </tt>
    , or by returning a
generator function as
    <tt class="docutils literal">
     body
    </tt>
    that yields bytes instances, or by the
    <tt class="docutils literal">
     body
    </tt>
    being an instance of a class which is iterable.  Regardless
of how it is accomplished, the application object must always return a
    <tt class="docutils literal">
     body
    </tt>
    iterable yielding zero or more bytes instances.
   </p>
   <p>
    The server or gateway must transmit the yielded bytes to the client in
an unbuffered fashion, completing the transmission of each set of
bytes before requesting another one.  (In other words, applications
    <strong>
     should
    </strong>
    perform their own buffering.  See the
    <a class="reference internal" href="#buffering-and-streaming">
     Buffering and
Streaming
    </a>
    section below for more on how application output must be
handled.)
   </p>
   <p>
    The server or gateway should treat the yielded bytes as binary byte
sequences: in particular, it should ensure that line endings are not
altered.  The application is responsible for ensuring that the
string(s) to be written are in a format suitable for the client.  (The
server or gateway
    <strong>
     may
    </strong>
    apply HTTP transfer encodings, or perform
other transformations for the purpose of implementing HTTP features
such as byte-range transmission.  See
    <a class="reference internal" href="#other-http-features">
     Other HTTP Features
    </a>
    , below,
for more details.)
   </p>
   <p>
    If the
    <tt class="docutils literal">
     body
    </tt>
    iterable returned by the application has a
    <tt class="docutils literal">
     close()
    </tt>
    method, the server or gateway
    <strong>
     must
    </strong>
    call that method upon
completion of the current request, whether the request was completed
normally, or terminated early due to an error.  This is to support
resource release by the application amd is intended to complement
    <a class="reference external" href="../pep-0325/index.html">
     PEP
325
    </a>
    's generator support, and other common iterables with
    <tt class="docutils literal">
     close()
    </tt>
    methods.
   </p>
   <p>
    Finally, servers and gateways
    <strong>
     must not
    </strong>
    directly use any other
attributes of the
    <tt class="docutils literal">
     body
    </tt>
    iterable returned by the application.
   </p>
   <div class="section" id="environ-variables">
    <h2>
     <a class="toc-backref" href="#id29">
      <tt class="docutils literal">
       environ
      </tt>
      Variables
     </a>
    </h2>
    <p>
     The
     <tt class="docutils literal">
      environ
     </tt>
     dictionary is required to contain various CGI
environment variables, as defined by the Common Gateway Interface
specification
     <a class="footnote-reference" href="#id14" id="id2">
      [2]
     </a>
     .
    </p>
    <p>
     The following CGI variables
     <strong>
      must
     </strong>
     be present.  Each key is a native
string.  Each value is a bytes instance.
    </p>
    <div class="note">
     <p class="first admonition-title">
      Note
     </p>
     <p class="last">
      In Python 3.1+, a "native string" is a
      <tt class="docutils literal">
       str
      </tt>
      type decoded using
the
      <tt class="docutils literal">
       surrogateescape
      </tt>
      error handler, as done by
      <tt class="docutils literal">
       os.environ.__getitem__
      </tt>
      .  In Python 2.6 and 2.7, a "native
string" is a
      <tt class="docutils literal">
       str
      </tt>
      types representing a set of bytes.
     </p>
    </div>
    <dl class="docutils">
     <dt>
      <tt class="docutils literal">
       REQUEST_METHOD
      </tt>
     </dt>
     <dd>
      The HTTP request method, such as
      <tt class="docutils literal">
       "GET"
      </tt>
      or
      <tt class="docutils literal">
       "POST"
      </tt>
      .
     </dd>
     <dt>
      <tt class="docutils literal">
       SCRIPT_NAME
      </tt>
     </dt>
     <dd>
      The initial portion of the request URL's "path" that corresponds to
the application object, so that the application knows its virtual
"location".  This may be the empty bytes instance if the application
corresponds to the "root" of the server.  SCRIPT_NAME will be a
bytes instance representing a sequence of URL-encoded segments
separated by the slash character (
      <tt class="docutils literal">
       /
      </tt>
      ).  It is assumed that
      <tt class="docutils literal">
       %2F
      </tt>
      characters will be decoded into literal slash characters
within
      <tt class="docutils literal">
       PATH_INFO
      </tt>
      , as per CGI.
     </dd>
     <dt>
      <tt class="docutils literal">
       PATH_INFO
      </tt>
     </dt>
     <dd>
      The remainder of the request URL's "path", designating the virtual
"location" of the request's target within the application.  This
      <strong>
       may
      </strong>
      be a bytes instance if the request URL targets the
application root and does not have a trailing slash.  PATH_INFO will
be a bytes instance representing a sequence of URL-encoded segments
separated by the slash character (
      <tt class="docutils literal">
       /
      </tt>
      ).  It is assumed that
      <tt class="docutils literal">
       %2F
      </tt>
      characters will be decoded into literal slash characters
within
      <tt class="docutils literal">
       PATH_INFO
      </tt>
      , as per CGI.
     </dd>
     <dt>
      <tt class="docutils literal">
       QUERY_STRING
      </tt>
     </dt>
     <dd>
      The portion of the request URL (in bytes) that follows the
      <tt class="docutils literal">
       <span class="pre">
        "?"
       </span>
      </tt>
      ,
if any, or the empty bytes instance.
     </dd>
     <dt>
      <tt class="docutils literal">
       SERVER_NAME
      </tt>
      ,
      <tt class="docutils literal">
       SERVER_PORT
      </tt>
     </dt>
     <dd>
      When combined with
      <tt class="docutils literal">
       SCRIPT_NAME
      </tt>
      and
      <tt class="docutils literal">
       PATH_INFO
      </tt>
      (or their raw
equivalents)`, these variables can be used to complete the URL.
Note, however, that
      <tt class="docutils literal">
       HTTP_HOST
      </tt>
      , if present, should be used in
preference to
      <tt class="docutils literal">
       SERVER_NAME
      </tt>
      for reconstructing the request URL.
See the
      <a class="reference internal" href="#url-reconstruction">
       URL Reconstruction
      </a>
      section below for more detail.
      <tt class="docutils literal">
       SERVER_PORT
      </tt>
      should be a bytes instance, not an integer.
     </dd>
     <dt>
      <tt class="docutils literal">
       SERVER_PROTOCOL
      </tt>
     </dt>
     <dd>
      The version of the protocol the client used to send the request.
Typically this will be something like
      <tt class="docutils literal">
       "HTTP/1.0"
      </tt>
      or
      <tt class="docutils literal">
       "HTTP/1.1"
      </tt>
      and may be used by the application to determine how
to treat any HTTP request headers.  (This variable should probably
be called
      <tt class="docutils literal">
       REQUEST_PROTOCOL
      </tt>
      , since it denotes the protocol used
in the request, and is not necessarily the protocol that will be
used in the server's response.  However, for compatibility with CGI
we have to keep the existing name.)
     </dd>
    </dl>
    <p>
     The following CGI values
     <strong>
      may
     </strong>
     present be in the Web3 environment.
Each key is a native string.  Each value is a bytes instances.
    </p>
    <dl class="docutils">
     <dt>
      <tt class="docutils literal">
       CONTENT_TYPE
      </tt>
     </dt>
     <dd>
      The contents of any
      <tt class="docutils literal">
       <span class="pre">
        Content-Type
       </span>
      </tt>
      fields in the HTTP request.
     </dd>
     <dt>
      <tt class="docutils literal">
       CONTENT_LENGTH
      </tt>
     </dt>
     <dd>
      The contents of any
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      fields in the HTTP request.
     </dd>
     <dt>
      <tt class="docutils literal">
       HTTP_
      </tt>
      Variables
     </dt>
     <dd>
      Variables corresponding to the client-supplied HTTP request headers
(i.e., variables whose names begin with
      <tt class="docutils literal">
       "HTTP_"
      </tt>
      ).  The presence
or absence of these variables should correspond with the presence or
absence of the appropriate HTTP header in the request.
     </dd>
    </dl>
    <p>
     A server or gateway
     <strong>
      should
     </strong>
     attempt to provide as many other CGI
variables as are applicable, each with a string for its key and a
bytes instance for its value.  In addition, if SSL is in use, the
server or gateway
     <strong>
      should
     </strong>
     also provide as many of the Apache SSL
environment variables
     <a class="footnote-reference" href="#id17" id="id3">
      [5]
     </a>
     as are applicable, such as
     <tt class="docutils literal">
      HTTPS=on
     </tt>
     and
     <tt class="docutils literal">
      SSL_PROTOCOL
     </tt>
     .  Note, however, that an application that uses any
CGI variables other than the ones listed above are necessarily
non-portable to web servers that do not support the relevant
extensions.  (For example, web servers that do not publish files will
not be able to provide a meaningful
     <tt class="docutils literal">
      DOCUMENT_ROOT
     </tt>
     or
     <tt class="docutils literal">
      PATH_TRANSLATED
     </tt>
     .)
    </p>
    <p>
     A Web3-compliant server or gateway
     <strong>
      should
     </strong>
     document what variables
it provides, along with their definitions as appropriate.
Applications
     <strong>
      should
     </strong>
     check for the presence of any variables they
require, and have a fallback plan in the event such a variable is
absent.
    </p>
    <p>
     Note that CGI variable
     <em>
      values
     </em>
     must be bytes instances, if they are
present at all.  It is a violation of this specification for a CGI
variable's value to be of any type other than
     <tt class="docutils literal">
      bytes
     </tt>
     .  On Python 2,
this means they will be of type
     <tt class="docutils literal">
      str
     </tt>
     .  On Python 3, this means they
will be of type
     <tt class="docutils literal">
      bytes
     </tt>
     .
    </p>
    <p>
     They
     <em>
      keys
     </em>
     of all CGI and non-CGI variables in the environ, however,
must be "native strings" (on both Python 2 and Python 3, they will be
of type
     <tt class="docutils literal">
      str
     </tt>
     ).
    </p>
    <p>
     In addition to the CGI-defined variables, the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary
     <strong>
      may
     </strong>
     also contain arbitrary operating-system "environment
variables", and
     <strong>
      must
     </strong>
     contain the following Web3-defined variables.
    </p>
    <table border="1" class="docutils">
     <colgroup>
      <col width="29%">
      </col>
      <col width="71%">
      </col>
     </colgroup>
     <thead valign="bottom">
      <tr>
       <th class="head">
        Variable
       </th>
       <th class="head">
        Value
       </th>
      </tr>
     </thead>
     <tbody valign="top">
      <tr>
       <td>
        <tt class="docutils literal">
         web3.version
        </tt>
       </td>
       <td>
        The tuple
        <tt class="docutils literal">
         (1, 0)
        </tt>
        , representing Web3
version 1.0.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.url_scheme
        </tt>
       </td>
       <td>
        A bytes value representing the "scheme" portion of
the URL at which the application is being
invoked.  Normally, this will have the value
        <tt class="docutils literal">
         b"http"
        </tt>
        or
        <tt class="docutils literal">
         b"https"
        </tt>
        , as appropriate.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.input
        </tt>
       </td>
       <td>
        An input stream (file-like object) from which bytes
constituting the HTTP request body can be read.
(The server or gateway may perform reads
on-demand as requested by the application, or
it may pre- read the client's request body and
buffer it in-memory or on disk, or use any
other technique for providing such an input
stream, according to its preference.)
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.errors
        </tt>
       </td>
       <td>
        <p class="first">
         An output stream (file-like object) to which error
output text can be written, for the purpose of
recording program or other errors in a
standardized and possibly centralized location.
This should be a "text mode" stream; i.e.,
applications should use
         <tt class="docutils literal">
          "\n"
         </tt>
         as a line
ending, and assume that it will be converted to
the correct line ending by the server/gateway.
Applications may
         <em>
          not
         </em>
         send bytes to the
'write' method of this stream; they may only
send text.
        </p>
        <p class="last">
         For many servers,
         <tt class="docutils literal">
          web3.errors
         </tt>
         will be the
server's main error log. Alternatively, this
may be
         <tt class="docutils literal">
          sys.stderr
         </tt>
         , or a log file of some
sort.  The server's documentation should
include an explanation of how to configure this
or where to find the recorded output.  A server
or gateway may supply different error streams
to different applications, if this is desired.
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.multithread
        </tt>
       </td>
       <td>
        This value should evaluate true if the
application object may be simultaneously
invoked by another thread in the same process,
and should evaluate false otherwise.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.multiprocess
        </tt>
       </td>
       <td>
        This value should evaluate true if an
equivalent application object may be
simultaneously invoked by another process, and
should evaluate false otherwise.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.run_once
        </tt>
       </td>
       <td>
        This value should evaluate true if the server
or gateway expects (but does not guarantee!)
that the application will only be invoked this
one time during the life of its containing
process.  Normally, this will only be true for
a gateway based on CGI (or something similar).
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.script_name
        </tt>
       </td>
       <td>
        The non-URL-decoded
        <tt class="docutils literal">
         SCRIPT_NAME
        </tt>
        value.
Through a historical inequity, by virtue of the
CGI specification,
        <tt class="docutils literal">
         SCRIPT_NAME
        </tt>
        is present
within the environment as an already
URL-decoded string.  This is the original
URL-encoded value derived from the request URI.
If the server cannot provide this value, it
must omit it from the environ.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.path_info
        </tt>
       </td>
       <td>
        The non-URL-decoded
        <tt class="docutils literal">
         PATH_INFO
        </tt>
        value.
Through a historical inequity, by virtue of the
CGI specification,
        <tt class="docutils literal">
         PATH_INFO
        </tt>
        is present
within the environment as an already
URL-decoded string.  This is the original
URL-encoded value derived from the request URI.
If the server cannot provide this value, it
must omit it from the environ.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         web3.async
        </tt>
       </td>
       <td>
        This is
        <tt class="docutils literal">
         True
        </tt>
        if the webserver supports
async invocation.  In that case an application
is allowed to return a callable instead of a
tuple with the response.  The exact semantics
are not specified by this specification.
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     Finally, the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary may also contain server-defined
variables.  These variables should have names which are native
strings, composed of only lower-case letters, numbers, dots, and
underscores, and should be prefixed with a name that is unique to the
defining server or gateway.  For example,
     <tt class="docutils literal">
      mod_web3
     </tt>
     might define
variables with names like
     <tt class="docutils literal">
      mod_web3.some_variable
     </tt>
     .
    </p>
    <div class="section" id="input-stream">
     <h3>
      <a class="toc-backref" href="#id30">
       Input Stream
      </a>
     </h3>
     <p>
      The input stream (
      <tt class="docutils literal">
       web3.input
      </tt>
      ) provided by the server must support
the following methods:
     </p>
     <table border="1" class="docutils">
      <colgroup>
       <col width="72%">
       </col>
       <col width="28%">
       </col>
      </colgroup>
      <thead valign="bottom">
       <tr>
        <th class="head">
         Method
        </th>
        <th class="head">
         Notes
        </th>
       </tr>
      </thead>
      <tbody valign="top">
       <tr>
        <td>
         <tt class="docutils literal">
          read(size)
         </tt>
        </td>
        <td>
         1,4
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          <span class="pre">
           readline([size])
          </span>
         </tt>
        </td>
        <td>
         1,2,4
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          <span class="pre">
           readlines([size])
          </span>
         </tt>
        </td>
        <td>
         1,3,4
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          __iter__()
         </tt>
        </td>
        <td>
         4
        </td>
       </tr>
      </tbody>
     </table>
     <p>
      The semantics of each method are as documented in the Python Library
Reference, except for these notes as listed in the table above:
     </p>
     <ol class="arabic simple">
      <li>
       The server is not required to read past the client's specified
       <tt class="docutils literal">
        <span class="pre">
         Content-Length
        </span>
       </tt>
       , and is allowed to simulate an end-of-file
condition if the application attempts to read past that point.  The
application
       <strong>
        should not
       </strong>
       attempt to read more data than is
specified by the
       <tt class="docutils literal">
        CONTENT_LENGTH
       </tt>
       variable.
      </li>
      <li>
       The implementation must support the optional
       <tt class="docutils literal">
        size
       </tt>
       argument to
       <tt class="docutils literal">
        readline()
       </tt>
       .
      </li>
      <li>
       The application is free to not supply a
       <tt class="docutils literal">
        size
       </tt>
       argument to
       <tt class="docutils literal">
        readlines()
       </tt>
       , and the server or gateway is free to ignore the
value of any supplied
       <tt class="docutils literal">
        size
       </tt>
       argument.
      </li>
      <li>
       The
       <tt class="docutils literal">
        read
       </tt>
       ,
       <tt class="docutils literal">
        readline
       </tt>
       and
       <tt class="docutils literal">
        __iter__
       </tt>
       methods must return a
bytes instance.  The
       <tt class="docutils literal">
        readlines
       </tt>
       method must return a sequence
which contains instances of bytes.
      </li>
     </ol>
     <p>
      The methods listed in the table above
      <strong>
       must
      </strong>
      be supported by all
servers conforming to this specification.  Applications conforming to
this specification
      <strong>
       must not
      </strong>
      use any other methods or attributes of
the
      <tt class="docutils literal">
       input
      </tt>
      object.  In particular, applications
      <strong>
       must not
      </strong>
      attempt to close this stream, even if it possesses a
      <tt class="docutils literal">
       close()
      </tt>
      method.
     </p>
     <p>
      The input stream should silently ignore attempts to read more than the
content length of the request.  If no content length is specified the
stream must be a dummy stream that does not return anything.
     </p>
    </div>
    <div class="section" id="error-stream">
     <h3>
      <a class="toc-backref" href="#id31">
       Error Stream
      </a>
     </h3>
     <p>
      The error stream (
      <tt class="docutils literal">
       web3.errors
      </tt>
      ) provided by the server must support
the following methods:
     </p>
     <table border="1" class="docutils">
      <colgroup>
       <col width="51%">
       </col>
       <col width="27%">
       </col>
       <col width="22%">
       </col>
      </colgroup>
      <thead valign="bottom">
       <tr>
        <th class="head">
         Method
        </th>
        <th class="head">
         Stream
        </th>
        <th class="head">
         Notes
        </th>
       </tr>
      </thead>
      <tbody valign="top">
       <tr>
        <td>
         <tt class="docutils literal">
          flush()
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          errors
         </tt>
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          write(str)
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          errors
         </tt>
        </td>
        <td>
         2
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          writelines(seq)
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          errors
         </tt>
        </td>
        <td>
         2
        </td>
       </tr>
      </tbody>
     </table>
     <p>
      The semantics of each method are as documented in the Python Library
Reference, except for these notes as listed in the table above:
     </p>
     <ol class="arabic simple">
      <li>
       Since the
       <tt class="docutils literal">
        errors
       </tt>
       stream may not be rewound, servers and
gateways are free to forward write operations immediately, without
buffering.  In this case, the
       <tt class="docutils literal">
        flush()
       </tt>
       method may be a no-op.
Portable applications, however, cannot assume that output is
unbuffered or that
       <tt class="docutils literal">
        flush()
       </tt>
       is a no-op.  They must call
       <tt class="docutils literal">
        flush()
       </tt>
       if they need to ensure that output has in fact been
written.  (For example, to minimize intermingling of data from
multiple processes writing to the same error log.)
      </li>
      <li>
       The
       <tt class="docutils literal">
        write()
       </tt>
       method must accept a string argument, but needn't
necessarily accept a bytes argument.  The
       <tt class="docutils literal">
        writelines()
       </tt>
       method
must accept a sequence argument that consists entirely of strings,
but needn't necessarily accept any bytes instance as a member of
the sequence.
      </li>
     </ol>
     <p>
      The methods listed in the table above
      <strong>
       must
      </strong>
      be supported by all
servers conforming to this specification.  Applications conforming to
this specification
      <strong>
       must not
      </strong>
      use any other methods or attributes of
the
      <tt class="docutils literal">
       errors
      </tt>
      object.  In particular, applications
      <strong>
       must not
      </strong>
      attempt to close this stream, even if it possesses a
      <tt class="docutils literal">
       close()
      </tt>
      method.
     </p>
    </div>
   </div>
   <div class="section" id="values-returned-by-a-web3-application">
    <h2>
     <a class="toc-backref" href="#id32">
      Values Returned by A Web3 Application
     </a>
    </h2>
    <p>
     Web3 applications return a tuple in the form (
     <tt class="docutils literal">
      status
     </tt>
     ,
     <tt class="docutils literal">
      headers
     </tt>
     ,
     <tt class="docutils literal">
      body
     </tt>
     ).  If the server supports asynchronous applications
(
     <tt class="docutils literal">
      web3.async
     </tt>
     ), the response may be a callable object (which accepts no
arguments).
    </p>
    <p>
     The
     <tt class="docutils literal">
      status
     </tt>
     value is assumed by a gateway or server to be an HTTP
"status" bytes instance like
     <tt class="docutils literal">
      b'200 OK'
     </tt>
     or
     <tt class="docutils literal">
      b'404 Not Found'
     </tt>
     .
That is, it is a string consisting of a Status-Code and a
Reason-Phrase, in that order and separated by a single space, with no
surrounding whitespace or other characters.  (See
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     , Section
6.1.1 for more information.)  The string
     <strong>
      must not
     </strong>
     contain control
characters, and must not be terminated with a carriage return,
linefeed, or combination thereof.
    </p>
    <p>
     The
     <tt class="docutils literal">
      headers
     </tt>
     value is assumed by a gateway or server to be a
literal Python list of
     <tt class="docutils literal">
      (header_name, header_value)
     </tt>
     tuples.  Each
     <tt class="docutils literal">
      header_name
     </tt>
     must be a bytes instance representing a valid HTTP
header field-name (as defined by
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     , Section 4.2), without a
trailing colon or other punctuation.  Each
     <tt class="docutils literal">
      header_value
     </tt>
     must be a
bytes instance and
     <strong>
      must not
     </strong>
     include any control characters,
including carriage returns or linefeeds, either embedded or at the
end.  (These requirements are to minimize the complexity of any
parsing that must be performed by servers, gateways, and intermediate
response processors that need to inspect or modify response headers.)
    </p>
    <p>
     In general, the server or gateway is responsible for ensuring that
correct headers are sent to the client: if the application omits a
header required by HTTP (or other relevant specifications that are in
effect), the server or gateway
     <strong>
      must
     </strong>
     add it.  For example, the HTTP
     <tt class="docutils literal">
      Date:
     </tt>
     and
     <tt class="docutils literal">
      Server:
     </tt>
     headers would normally be supplied by the
server or gateway.  The gateway must however not override values with
the same name if they are emitted by the application.
    </p>
    <p>
     (A reminder for server/gateway authors: HTTP header names are
case-insensitive, so be sure to take that into consideration when
examining application-supplied headers!)
    </p>
    <p>
     Applications and middleware are forbidden from using HTTP/1.1
"hop-by-hop" features or headers, any equivalent features in HTTP/1.0,
or any headers that would affect the persistence of the client's
connection to the web server.  These features are the exclusive
province of the actual web server, and a server or gateway
     <strong>
      should
     </strong>
     consider it a fatal error for an application to attempt sending them,
and raise an error if they are supplied as return values from an
application in the
     <tt class="docutils literal">
      headers
     </tt>
     structure.  (For more specifics on
"hop-by-hop" features and headers, please see the
     <a class="reference internal" href="#other-http-features">
      Other HTTP
Features
     </a>
     section below.)
    </p>
   </div>
   <div class="section" id="dealing-with-compatibility-across-python-versions">
    <h2>
     <a class="toc-backref" href="#id33">
      Dealing with Compatibility Across Python Versions
     </a>
    </h2>
    <p>
     Creating Web3 code that runs under both Python 2.6/2.7 and Python 3.1+
requires some care on the part of the developer.  In general, the Web3
specification assumes a certain level of equivalence between the
Python 2
     <tt class="docutils literal">
      str
     </tt>
     type and the Python 3
     <tt class="docutils literal">
      bytes
     </tt>
     type.  For example,
under Python 2, the values present in the Web3
     <tt class="docutils literal">
      environ
     </tt>
     will be
instances of the
     <tt class="docutils literal">
      str
     </tt>
     type; in Python 3, these will be instances of
the
     <tt class="docutils literal">
      bytes
     </tt>
     type.  The Python 3
     <tt class="docutils literal">
      bytes
     </tt>
     type does not possess all
the methods of the Python 2
     <tt class="docutils literal">
      str
     </tt>
     type, and some methods which it
does possess behave differently than the Python 2
     <tt class="docutils literal">
      str
     </tt>
     type.
Effectively, to ensure that Web3 middleware and applications work
across Python versions, developers must do these things:
    </p>
    <ol class="arabic simple">
     <li>
      Do not assume comparison equivalence between text values and bytes
values.  If you do so, your code may work under Python 2, but it
will not work properly under Python 3.  For example, don't write
      <tt class="docutils literal">
       somebytes == 'abc'
      </tt>
      .  This will sometimes be true on Python 2
but it will never be true on Python 3, because a sequence of bytes
never compares equal to a string under Python 3.  Instead, always
compare a bytes value with a bytes value, e.g. "somebytes ==
b'abc'".  Code which does this is compatible with and works the
same in Python 2.6, 2.7, and 3.1.  The
      <tt class="docutils literal">
       b
      </tt>
      in front of
      <tt class="docutils literal">
       'abc'
      </tt>
      signals to Python 3 that the value is a literal bytes instance;
under Python 2 it's a forward compatibility placebo.
     </li>
     <li>
      Don't use the
      <tt class="docutils literal">
       __contains__
      </tt>
      method (directly or indirectly) of
items that are meant to be byteslike without ensuring that its
argument is also a bytes instance.  If you do so, your code may
work under Python 2, but it will not work properly under Python 3.
For example,
      <tt class="docutils literal">
       'abc' in somebytes'
      </tt>
      will raise a
      <tt class="docutils literal">
       TypeError
      </tt>
      under Python 3, but it will return
      <tt class="docutils literal">
       True
      </tt>
      under Python 2.6 and
2.7.  However,
      <tt class="docutils literal">
       b'abc' in somebytes
      </tt>
      will work the same on both
versions.  In Python 3.2, this restriction may be partially
removed, as it's rumored that bytes types may obtain a
      <tt class="docutils literal">
       __mod__
      </tt>
      implementation.
     </li>
     <li>
      <tt class="docutils literal">
       __getitem__
      </tt>
      should not be used.
      <!-- XXX -->
     </li>
     <li>
      Dont try to use the
      <tt class="docutils literal">
       format
      </tt>
      method or the
      <tt class="docutils literal">
       __mod__
      </tt>
      method of
instances of bytes (directly or indirectly).  In Python 2, the
      <tt class="docutils literal">
       str
      </tt>
      type which we treat equivalently to Python 3's
      <tt class="docutils literal">
       bytes
      </tt>
      supports these method but actual Python 3's
      <tt class="docutils literal">
       bytes
      </tt>
      instances
don't support these methods.  If you use these methods, your code
will work under Python 2, but not under Python 3.
     </li>
     <li>
      Do not try to concatenate a bytes value with a string value.  This
may work under Python 2, but it will not work under Python 3.  For
example, doing
      <tt class="docutils literal">
       'abc' + somebytes
      </tt>
      will work under Python 2, but
it will result in a
      <tt class="docutils literal">
       TypeError
      </tt>
      under Python 3.  Instead, always
make sure you're concatenating two items of the same type,
e.g.
      <tt class="docutils literal">
       b'abc' + somebytes
      </tt>
      .
     </li>
    </ol>
    <p>
     Web3 expects byte values in other places, such as in all the values
returned by an application.
    </p>
    <p>
     In short, to ensure compatibility of Web3 application code between
Python 2 and Python 3, in Python 2, treat CGI and server variable
values in the environment as if they had the Python 3
     <tt class="docutils literal">
      bytes
     </tt>
     API
even though they actually have a more capable API.  Likewise for all
stringlike values returned by a Web3 application.
    </p>
   </div>
   <div class="section" id="buffering-and-streaming">
    <h2>
     <a class="toc-backref" href="#id34">
      Buffering and Streaming
     </a>
    </h2>
    <p>
     Generally speaking, applications will achieve the best throughput by
buffering their (modestly-sized) output and sending it all at once.
This is a common approach in existing frameworks: the output is
buffered in a StringIO or similar object, then transmitted all at
once, along with the response headers.
    </p>
    <p>
     The corresponding approach in Web3 is for the application to simply
return a single-element
     <tt class="docutils literal">
      body
     </tt>
     iterable (such as a list) containing
the response body as a single string.  This is the recommended
approach for the vast majority of application functions, that render
HTML pages whose text easily fits in memory.
    </p>
    <p>
     For large files, however, or for specialized uses of HTTP streaming
(such as multipart "server push"), an application may need to provide
output in smaller blocks (e.g. to avoid loading a large file into
memory).  It's also sometimes the case that part of a response may be
time-consuming to produce, but it would be useful to send ahead the
portion of the response that precedes it.
    </p>
    <p>
     In these cases, applications will usually return a
     <tt class="docutils literal">
      body
     </tt>
     iterator
(often a generator-iterator) that produces the output in a
block-by-block fashion.  These blocks may be broken to coincide with
mulitpart boundaries (for "server push"), or just before
time-consuming tasks (such as reading another block of an on-disk
file).
    </p>
    <p>
     Web3 servers, gateways, and middleware
     <strong>
      must not
     </strong>
     delay the
transmission of any block; they
     <strong>
      must
     </strong>
     either fully transmit the
block to the client, or guarantee that they will continue transmission
even while the application is producing its next block.  A
server/gateway or middleware may provide this guarantee in one of
three ways:
    </p>
    <ol class="arabic simple">
     <li>
      Send the entire block to the operating system (and request that any
O/S buffers be flushed) before returning control to the
application, OR
     </li>
     <li>
      Use a different thread to ensure that the block continues to be
transmitted while the application produces the next block.
     </li>
     <li>
      (Middleware only) send the entire block to its parent
gateway/server.
     </li>
    </ol>
    <p>
     By providing this guarantee, Web3 allows applications to ensure that
transmission will not become stalled at an arbitrary point in their
output data.  This is critical for proper functioning of
e.g. multipart "server push" streaming, where data between multipart
boundaries should be transmitted in full to the client.
    </p>
   </div>
   <div class="section" id="unicode-issues">
    <h2>
     <a class="toc-backref" href="#id35">
      Unicode Issues
     </a>
    </h2>
    <p>
     HTTP does not directly support Unicode, and neither does this
interface.  All encoding/decoding must be handled by the
     <strong>
      application
     </strong>
     ; all values passed to or from the server must be of
the Python 3 type
     <tt class="docutils literal">
      bytes
     </tt>
     or instances of the Python 2 type
     <tt class="docutils literal">
      str
     </tt>
     ,
not Python 2
     <tt class="docutils literal">
      unicode
     </tt>
     or Python 3
     <tt class="docutils literal">
      str
     </tt>
     objects.
    </p>
    <p>
     All "bytes instances" referred to in this specification
     <strong>
      must
     </strong>
     :
    </p>
    <ul class="simple">
     <li>
      On Python 2, be of type
      <tt class="docutils literal">
       str
      </tt>
      .
     </li>
     <li>
      On Python 3, be of type
      <tt class="docutils literal">
       bytes
      </tt>
      .
     </li>
    </ul>
    <p>
     All "bytes instances"
     <strong>
      must not
     </strong>
     :
    </p>
    <ul class="simple">
     <li>
      On Python 2,  be of type
      <tt class="docutils literal">
       unicode
      </tt>
      .
     </li>
     <li>
      On Python 3, be of type
      <tt class="docutils literal">
       str
      </tt>
      .
     </li>
    </ul>
    <p>
     The result of using a textlike object where a byteslike object is
required is undefined.
    </p>
    <p>
     Values returned from a Web3 app as a status or as response headers
     <strong>
      must
     </strong>
     follow
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     with respect to encoding.  That is, the bytes
returned must contain a character stream of ISO-8859-1 characters, or
the character stream should use
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2047.html">
      RFC 2047
     </a>
     MIME encoding.
    </p>
    <p>
     On Python platforms which do not have a native bytes-like type
(e.g. IronPython, etc.), but instead which generally use textlike
strings to represent bytes data, the definition of "bytes instance"
can be changed: their "bytes instances" must be native strings that
contain only code points representable in ISO-8859-1 encoding
(
     <tt class="docutils literal">
      \u0000
     </tt>
     through
     <tt class="docutils literal">
      \u00FF
     </tt>
     , inclusive).  It is a fatal error for
an application on such a platform to supply strings containing any
other Unicode character or code point.  Similarly, servers and
gateways on those platforms
     <strong>
      must not
     </strong>
     supply strings to an
application containing any other Unicode characters.
    </p>
    <!-- XXX (armin: Jython now has a bytes type, we might remove this
section after seeing about IronPython) -->
   </div>
   <div class="section" id="http-1-1-expect-continue">
    <h2>
     <a class="toc-backref" href="#id36">
      HTTP 1.1 Expect/Continue
     </a>
    </h2>
    <p>
     Servers and gateways that implement HTTP 1.1
     <strong>
      must
     </strong>
     provide
transparent support for HTTP 1.1's "expect/continue" mechanism.  This
may be done in any of several ways:
    </p>
    <ol class="arabic simple">
     <li>
      Respond to requests containing an
      <tt class="docutils literal">
       Expect:
       <span class="pre">
        100-continue
       </span>
      </tt>
      request
with an immediate "100 Continue" response, and proceed normally.
     </li>
     <li>
      Proceed with the request normally, but provide the application with
a
      <tt class="docutils literal">
       web3.input
      </tt>
      stream that will send the "100 Continue" response
if/when the application first attempts to read from the input
stream.  The read request must then remain blocked until the client
responds.
     </li>
     <li>
      Wait until the client decides that the server does not support
expect/continue, and sends the request body on its own.  (This is
suboptimal, and is not recommended.)
     </li>
    </ol>
    <p>
     Note that these behavior restrictions do not apply for HTTP 1.0
requests, or for requests that are not directed to an application
object.  For more information on HTTP 1.1 Expect/Continue, see
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC
2616
     </a>
     , sections 8.2.3 and 10.1.1.
    </p>
   </div>
   <div class="section" id="other-http-features">
    <h2>
     <a class="toc-backref" href="#id37">
      Other HTTP Features
     </a>
    </h2>
    <p>
     In general, servers and gateways should "play dumb" and allow the
application complete control over its output.  They should only make
changes that do not alter the effective semantics of the application's
response.  It is always possible for the application developer to add
middleware components to supply additional features, so server/gateway
developers should be conservative in their implementation.  In a
sense, a server should consider itself to be like an HTTP "gateway
server", with the application being an HTTP "origin server".  (See
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC
2616
     </a>
     , section 1.3, for the definition of these terms.)
    </p>
    <p>
     However, because Web3 servers and applications do not communicate via
HTTP, what
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     calls "hop-by-hop" headers do not apply to Web3
internal communications.  Web3 applications
     <strong>
      must not
     </strong>
     generate any
"hop-by-hop" headers
     <a class="footnote-reference" href="#id16" id="id4">
      [4]
     </a>
     , attempt to use HTTP features that would
require them to generate such headers, or rely on the content of any
incoming "hop-by-hop" headers in the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary.  Web3
servers
     <strong>
      must
     </strong>
     handle any supported inbound "hop-by-hop" headers on
their own, such as by decoding any inbound
     <tt class="docutils literal">
      <span class="pre">
       Transfer-Encoding
      </span>
     </tt>
     ,
including chunked encoding if applicable.
    </p>
    <p>
     Applying these principles to a variety of HTTP features, it should be
clear that a server
     <strong>
      may
     </strong>
     handle cache validation via the
     <tt class="docutils literal">
      <span class="pre">
       If-None-Match
      </span>
     </tt>
     and
     <tt class="docutils literal">
      <span class="pre">
       If-Modified-Since
      </span>
     </tt>
     request headers and the
     <tt class="docutils literal">
      <span class="pre">
       Last-Modified
      </span>
     </tt>
     and
     <tt class="docutils literal">
      ETag
     </tt>
     response headers.  However, it is not
required to do this, and the application
     <strong>
      should
     </strong>
     perform its own
cache validation if it wants to support that feature, since the
server/gateway is not required to do such validation.
    </p>
    <p>
     Similarly, a server
     <strong>
      may
     </strong>
     re-encode or transport-encode an
application's response, but the application
     <strong>
      should
     </strong>
     use a suitable
content encoding on its own, and
     <strong>
      must not
     </strong>
     apply a transport
encoding.  A server
     <strong>
      may
     </strong>
     transmit byte ranges of the application's
response if requested by the client, and the application doesn't
natively support byte ranges.  Again, however, the application
     <strong>
      should
     </strong>
     perform this function on its own if desired.
    </p>
    <p>
     Note that these restrictions on applications do not necessarily mean
that every application must reimplement every HTTP feature; many HTTP
features can be partially or fully implemented by middleware
components, thus freeing both server and application authors from
implementing the same features over and over again.
    </p>
   </div>
   <div class="section" id="thread-support">
    <h2>
     <a class="toc-backref" href="#id38">
      Thread Support
     </a>
    </h2>
    <p>
     Thread support, or lack thereof, is also server-dependent.  Servers
that can run multiple requests in parallel,
     <strong>
      should
     </strong>
     also provide
the option of running an application in a single-threaded fashion, so
that applications or frameworks that are not thread-safe may still be
used with that server.
    </p>
   </div>
  </div>
  <div class="section" id="implementation-application-notes">
   <h1>
    <a class="toc-backref" href="#id39">
     Implementation/Application Notes
    </a>
   </h1>
   <div class="section" id="server-extension-apis">
    <h2>
     <a class="toc-backref" href="#id40">
      Server Extension APIs
     </a>
    </h2>
    <p>
     Some server authors may wish to expose more advanced APIs, that
application or framework authors can use for specialized purposes.
For example, a gateway based on
     <tt class="docutils literal">
      mod_python
     </tt>
     might wish to expose
part of the Apache API as a Web3 extension.
    </p>
    <p>
     In the simplest case, this requires nothing more than defining an
     <tt class="docutils literal">
      environ
     </tt>
     variable, such as
     <tt class="docutils literal">
      mod_python.some_api
     </tt>
     .  But, in many
cases, the possible presence of middleware can make this difficult.
For example, an API that offers access to the same HTTP headers that
are found in
     <tt class="docutils literal">
      environ
     </tt>
     variables, might return different data if
     <tt class="docutils literal">
      environ
     </tt>
     has been modified by middleware.
    </p>
    <p>
     In general, any extension API that duplicates, supplants, or bypasses
some portion of Web3 functionality runs the risk of being incompatible
with middleware components.  Server/gateway developers should
     <em>
      not
     </em>
     assume that nobody will use middleware, because some framework
developers specifically organize their frameworks to function almost
entirely as middleware of various kinds.
    </p>
    <p>
     So, to provide maximum compatibility, servers and gateways that
provide extension APIs that replace some Web3 functionality,
     <strong>
      must
     </strong>
     design those APIs so that they are invoked using the portion of the
API that they replace.  For example, an extension API to access HTTP
request headers must require the application to pass in its current
     <tt class="docutils literal">
      environ
     </tt>
     , so that the server/gateway may verify that HTTP headers
accessible via the API have not been altered by middleware.  If the
extension API cannot guarantee that it will always agree with
     <tt class="docutils literal">
      environ
     </tt>
     about the contents of HTTP headers, it must refuse service
to the application, e.g. by raising an error, returning
     <tt class="docutils literal">
      None
     </tt>
     instead of a header collection, or whatever is appropriate to the API.
    </p>
    <p>
     These guidelines also apply to middleware that adds information such
as parsed cookies, form variables, sessions, and the like to
     <tt class="docutils literal">
      environ
     </tt>
     .  Specifically, such middleware should provide these
features as functions which operate on
     <tt class="docutils literal">
      environ
     </tt>
     , rather than simply
stuffing values into
     <tt class="docutils literal">
      environ
     </tt>
     .  This helps ensure that information
is calculated from
     <tt class="docutils literal">
      environ
     </tt>
     <em>
      after
     </em>
     any middleware has done any URL
rewrites or other
     <tt class="docutils literal">
      environ
     </tt>
     modifications.
    </p>
    <p>
     It is very important that these "safe extension" rules be followed by
both server/gateway and middleware developers, in order to avoid a
future in which middleware developers are forced to delete any and all
extension APIs from
     <tt class="docutils literal">
      environ
     </tt>
     to ensure that their mediation isn't
being bypassed by applications using those extensions!
    </p>
   </div>
   <div class="section" id="application-configuration">
    <h2>
     <a class="toc-backref" href="#id41">
      Application Configuration
     </a>
    </h2>
    <p>
     This specification does not define how a server selects or obtains an
application to invoke.  These and other configuration options are
highly server-specific matters.  It is expected that server/gateway
authors will document how to configure the server to execute a
particular application object, and with what options (such as
threading options).
    </p>
    <p>
     Framework authors, on the other hand, should document how to create an
application object that wraps their framework's functionality.  The
user, who has chosen both the server and the application framework,
must connect the two together.  However, since both the framework and
the server have a common interface, this should be merely a mechanical
matter, rather than a significant engineering effort for each new
server/framework pair.
    </p>
    <p>
     Finally, some applications, frameworks, and middleware may wish to use
the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary to receive simple string configuration
options.  Servers and gateways
     <strong>
      should
     </strong>
     support this by allowing an
application's deployer to specify name-value pairs to be placed in
     <tt class="docutils literal">
      environ
     </tt>
     .  In the simplest case, this support can consist merely of
copying all operating system-supplied environment variables from
     <tt class="docutils literal">
      os.environ
     </tt>
     into the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary, since the deployer in
principle can configure these externally to the server, or in the CGI
case they may be able to be set via the server's configuration files.
    </p>
    <p>
     Applications
     <strong>
      should
     </strong>
     try to keep such required variables to a
minimum, since not all servers will support easy configuration of
them.  Of course, even in the worst case, persons deploying an
application can create a script to supply the necessary configuration
values:
    </p>
    <pre class="literal-block">
from the_app import application

def new_app(environ):
    environ['the_app.configval1'] = b'something'
    return application(environ)
</pre>
    <p>
     But, most existing applications and frameworks will probably only need
a single configuration value from
     <tt class="docutils literal">
      environ
     </tt>
     , to indicate the
location of their application or framework-specific configuration
file(s).  (Of course, applications should cache such configuration, to
avoid having to re-read it upon each invocation.)
    </p>
   </div>
   <div class="section" id="url-reconstruction">
    <h2>
     <a class="toc-backref" href="#id42">
      URL Reconstruction
     </a>
    </h2>
    <p>
     If an application wishes to reconstruct a request's complete URL (as a
bytes object), it may do so using the following algorithm:
    </p>
    <pre class="literal-block">
host = environ.get('HTTP_HOST')

scheme = environ['web3.url_scheme']
port = environ['SERVER_PORT']
query = environ['QUERY_STRING']

url = scheme + b'://'

if host:
    url += host
else:
    url += environ['SERVER_NAME']

    if scheme == b'https':
        if port != b'443':
           url += b':' + port
    else:
        if port != b'80':
           url += b':' + port

if 'web3.script_name' in url:
    url += url_quote(environ['web3.script_name'])
else:
    url += environ['SCRIPT_NAME']
if 'web3.path_info' in environ:
    url += url_quote(environ['web3.path_info'])
else:
    url += environ['PATH_INFO']
if query:
    url += b'?' + query
</pre>
    <p>
     Note that such a reconstructed URL may not be precisely the same URI
as requested by the client.  Server rewrite rules, for example, may
have modified the client's originally requested URL to place it in a
canonical form.
    </p>
   </div>
  </div>
  <div class="section" id="open-questions">
   <h1>
    <a class="toc-backref" href="#id43">
     Open Questions
    </a>
   </h1>
   <ul class="simple">
    <li>
     <tt class="docutils literal">
      file_wrapper
     </tt>
     replacement.  Currently nothing is specified here
but it's clear that the old system of in-band signalling is broken
if it does not provide a way to figure out as a middleware in the
process if the response is a file wrapper.
    </li>
   </ul>
  </div>
  <div class="section" id="points-of-contention">
   <h1>
    <a class="toc-backref" href="#id44">
     Points of Contention
    </a>
   </h1>
   <p>
    Outlined below are potential points of contention regarding this
specification.
   </p>
   <div class="section" id="wsgi-1-0-compatibility">
    <h2>
     <a class="toc-backref" href="#id45">
      WSGI 1.0 Compatibility
     </a>
    </h2>
    <p>
     Components written using the WSGI 1.0 specification will not
transparently interoperate with components written using this
specification.  That's because the goals of this proposal and the
goals of WSGI 1.0 are not directly aligned.
    </p>
    <p>
     WSGI 1.0 is obliged to provide specification-level backwards
compatibility with versions of Python between 2.2 and 2.7.  This
specification, however, ditches Python 2.5 and lower compatibility in
order to provide compatibility between relatively recent versions of
Python 2 (2.6 and 2.7) as well as relatively recent versions of Python
3 (3.1).
    </p>
    <p>
     It is currently impossible to write components which work reliably
under both Python 2 and Python 3 using the WSGI 1.0 specification,
because the specification implicitly posits that CGI and server
variable values in the environ and values returned via
     <tt class="docutils literal">
      start_response
     </tt>
     represent a sequence of bytes that can be addressed
using the Python 2 string API.  It posits such a thing because that
sort of data type was the sensible way to represent bytes in all
Python 2 versions, and WSGI 1.0 was conceived before Python 3 existed.
    </p>
    <p>
     Python 3's
     <tt class="docutils literal">
      str
     </tt>
     type supports the full API provided by the Python 2
     <tt class="docutils literal">
      str
     </tt>
     type, but Python 3's
     <tt class="docutils literal">
      str
     </tt>
     type does not represent a
sequence of bytes, it instead represents text.  Therefore, using it to
represent environ values also requires that the environ byte sequence
be decoded to text via some encoding.  We cannot decode these bytes to
text (at least in any way where the decoding has any meaning other
than as a tunnelling mechanism) without widening the scope of WSGI to
include server and gateway knowledge of decoding policies and
mechanics.  WSGI 1.0 never concerned itself with encoding and
decoding.  It made statements about allowable transport values, and
suggested that various values might be best decoded as one encoding or
another, but it never required a server to
     <em>
      perform
     </em>
     any decoding
before
    </p>
    <p>
     Python 3 does not have a stringlike type that can be used instead to
represent bytes: it has a
     <tt class="docutils literal">
      bytes
     </tt>
     type.  A bytes type operates quite
a bit like a Python 2
     <tt class="docutils literal">
      str
     </tt>
     in Python 3.1+, but it lacks behavior
equivalent to
     <tt class="docutils literal">
      str.__mod__
     </tt>
     and its iteration protocol, and
containment, sequence treatment, and equivalence comparisons are
different.
    </p>
    <p>
     In either case, there is no type in Python 3 that behaves just like
the Python 2
     <tt class="docutils literal">
      str
     </tt>
     type, and a way to create such a type doesn't
exist because there is no such thing as a "String ABC" which would
allow a suitable type to be built.  Due to this design
incompatibility, existing WSGI 1.0 servers, middleware, and
applications will not work under Python 3, even after they are run
through
     <tt class="docutils literal">
      2to3
     </tt>
     .
    </p>
    <p>
     Existing Web-SIG discussions about updating the WSGI specification so
that it is possible to write a WSGI application that runs in both
Python 2 and Python 3 tend to revolve around creating a
specification-level equivalence between the Python 2
     <tt class="docutils literal">
      str
     </tt>
     type
(which represents a sequence of bytes) and the Python 3
     <tt class="docutils literal">
      str
     </tt>
     type
(which represents text).  Such an equivalence becomes strained in
various areas, given the different roles of these types.  An arguably
more straightforward equivalence exists between the Python 3
     <tt class="docutils literal">
      bytes
     </tt>
     type API and a subset of the Python 2
     <tt class="docutils literal">
      str
     </tt>
     type API.  This
specification exploits this subset equivalence.
    </p>
    <p>
     In the meantime, aside from any Python 2 vs. Python 3 compatibility
issue, as various discussions on Web-SIG have pointed out, the WSGI
1.0 specification is too general, providing support (via
     <tt class="docutils literal">
      .write
     </tt>
     )
for asynchronous applications at the expense of implementation
complexity.  This specification uses the fundamental incompatibility
between WSGI 1.0 and Python 3 as a natural divergence point to create
a specification with reduced complexity by changing specialized
support for asynchronous applications.
    </p>
    <p>
     To provide backwards compatibility for older WSGI 1.0 applications, so
that they may run on a Web3 stack, it is presumed that Web3 middleware
will be created which can be used "in front" of existing WSGI 1.0
applications, allowing those existing WSGI 1.0 applications to run
under a Web3 stack.  This middleware will require, when under Python
3, an equivalence to be drawn between Python 3
     <tt class="docutils literal">
      str
     </tt>
     types and the
bytes values represented by the HTTP request and all the attendant
encoding-guessing (or configuration) it implies.
    </p>
    <div class="note">
     <p class="first admonition-title">
      Note
     </p>
     <p class="last">
      Such middleware
      <em>
       might
      </em>
      in the future, instead of drawing an
equivalence between Python 3
      <tt class="docutils literal">
       str
      </tt>
      and HTTP byte values, make use
of a yet-to-be-created "ebytes" type (aka "bytes-with-benefits"),
particularly if a String ABC proposal is accepted into the Python
core and implemented.
     </p>
    </div>
    <p>
     Conversely, it is presumed that WSGI 1.0 middleware will be created
which will allow a Web3 application to run behind a WSGI 1.0 stack on
the Python 2 platform.
    </p>
   </div>
   <div class="section" id="environ-and-response-values-as-bytes">
    <h2>
     <a class="toc-backref" href="#id46">
      Environ and Response Values as Bytes
     </a>
    </h2>
    <p>
     Casual middleware and application writers may consider the use of
bytes as environment values and response values inconvenient.  In
particular, they won't be able to use common string formatting
functions such as
     <tt class="docutils literal">
      <span class="pre">
       ('%s'
      </span>
      % bytes_val)
     </tt>
     or
     <tt class="docutils literal">
      <span class="pre">
       bytes_val.format('123')
      </span>
     </tt>
     because bytes don't have the same API as
strings on platforms such as Python 3 where the two types differ.
Likewise, on such platforms, stdlib HTTP-related API support for using
bytes interchangeably with text can be spotty.  In places where bytes
are inconvenient or incompatible with library APIs, middleware and
application writers will have to decode such bytes to text explicitly.
This is particularly inconvenient for middleware writers: to work with
environment values as strings, they'll have to decode them from an
implied encoding and if they need to mutate an environ value, they'll
then need to encode the value into a byte stream before placing it
into the environ.  While the use of bytes by the specification as
environ values might be inconvenient for casual developers, it
provides several benefits.
    </p>
    <p>
     Using bytes types to represent HTTP and server values to an
application most closely matches reality because HTTP is fundamentally
a bytes-oriented protocol.  If the environ values are mandated to be
strings, each server will need to use heuristics to guess about the
encoding of various values provided by the HTTP environment.  Using
all strings might increase casual middleware writer convenience, but
will also lead to ambiguity and confusion when a value cannot be
decoded to a meaningful non-surrogate string.
    </p>
    <p>
     Use of bytes as environ values avoids any potential for the need for
the specification to mandate that a participating server be informed
of encoding configuration parameters.  If environ values are treated
as strings, and so must be decoded from bytes, configuration
parameters may eventually become necessary as policy clues from the
application deployer.  Such a policy would be used to guess an
appropriate decoding strategy in various circumstances, effectively
placing the burden for enforcing a particular application encoding
policy upon the server.  If the server must serve more than one
application, such configuration would quickly become complex.  Many
policies would also be impossible to express declaratively.
    </p>
    <p>
     In reality, HTTP is a complicated and legacy-fraught protocol which
requires a complex set of heuristics to make sense of. It would be
nice if we could allow this protocol to protect us from this
complexity, but we cannot do so reliably while still providing to
application writers a level of control commensurate with reality.
Python applications must often deal with data embedded in the
environment which not only must be parsed by legacy heuristics, but
     <em>
      does not conform even to any existing HTTP specification
     </em>
     .  While
these eventualities are unpleasant, they crop up with regularity,
making it impossible and undesirable to hide them from application
developers, as application developers are the only people who are able
to decide upon an appropriate action when an HTTP specification
violation is detected.
    </p>
    <p>
     Some have argued for mixed use of bytes and string values as environ
     <em>
      values
     </em>
     .  This proposal avoids that strategy.  Sole use of bytes as
environ values makes it possible to fit this specification entirely in
one's head; you won't need to guess about which values are strings and
which are bytes.
    </p>
    <p>
     This protocol would also fit in a developer's head if all environ
values were strings, but this specification doesn't use that strategy.
This will likely be the point of greatest contention regarding the use
of bytes.  In defense of bytes: developers often prefer protocols with
consistent contracts, even if the contracts themselves are suboptimal.
If we hide encoding issues from a developer until a value that
contains surrogates causes problems after it has already reached
beyond the I/O boundary of their application, they will need to do a
lot more work to fix assumptions made by their application than if we
were to just present the problem much earlier in terms of "here's some
bytes, you decode them".  This is also a counter-argument to the
"bytes are inconvenient" assumption: while presenting bytes to an
application developer may be inconvenient for a casual application
developer who doesn't care about edge cases, they are extremely
convenient for the application developer who needs to deal with
complex, dirty eventualities, because use of bytes allows him the
appropriate level of control with a clear separation of
responsibility.
    </p>
    <p>
     If the protocol uses bytes, it is presumed that libraries will be
created to make working with bytes-only in the environ and within
return values more pleasant; for example, analogues of the WSGI 1.0
libraries named "WebOb" and "Werkzeug".  Such libraries will fill the
gap between convenience and control, allowing the spec to remain
simple and regular while still allowing casual authors a convenient
way to create Web3 middleware and application components.  This seems
to be a reasonable alternative to baking encoding policy into the
protocol, because many such libraries can be created independently
from the protocol, and application developers can choose the one that
provides them the appropriate levels of control and convenience for a
particular job.
    </p>
    <p>
     Here are some alternatives to using all bytes:
    </p>
    <ul class="simple">
     <li>
      Have the server decode all values representing CGI and server
environ values into strings using the
      <tt class="docutils literal">
       <span class="pre">
        latin-1
       </span>
      </tt>
      encoding, which is
lossless.  Smuggle any undecodable bytes within the resulting
string.
     </li>
     <li>
      Encode all CGI and server environ values to strings using the
      <tt class="docutils literal">
       <span class="pre">
        utf-8
       </span>
      </tt>
      encoding with the
      <tt class="docutils literal">
       surrogateescape
      </tt>
      error handler.  This
does not work under any existing Python 2.
     </li>
     <li>
      Encode some values into bytes and other values into strings, as
decided by their typical usages.
     </li>
    </ul>
   </div>
   <div class="section" id="applications-should-be-allowed-to-read-web3-input-past-content-length">
    <h2>
     <a class="toc-backref" href="#id47">
      Applications Should be Allowed to Read
      <tt class="docutils literal">
       web3.input
      </tt>
      Past
      <tt class="docutils literal">
       CONTENT_LENGTH
      </tt>
     </a>
    </h2>
    <p>
     At
     <a class="footnote-reference" href="#id18" id="id5">
      [6]
     </a>
     , Graham Dumpleton makes the assertion that
     <tt class="docutils literal">
      wsgi.input
     </tt>
     should be required to return the empty string as a signifier of
out-of-data, and that applications should be allowed to read past the
number of bytes specified in
     <tt class="docutils literal">
      CONTENT_LENGTH
     </tt>
     , depending only upon
the empty string as an EOF marker.  WSGI relies on an application
"being well behaved and once all data specified by
     <tt class="docutils literal">
      CONTENT_LENGTH
     </tt>
     is read, that it processes the data and returns any response. That
same socket connection could then be used for a subsequent request."
Graham would like WSGI adapters to be required to wrap raw socket
connections: "this wrapper object will need to count how much data has
been read, and when the amount of data reaches that as defined by
     <tt class="docutils literal">
      CONTENT_LENGTH
     </tt>
     , any subsequent reads should return an empty string
instead."  This may be useful to support chunked encoding and input
filters.
    </p>
   </div>
   <div class="section" id="web3-input-unknown-length">
    <h2>
     <a class="toc-backref" href="#id48">
      <tt class="docutils literal">
       web3.input
      </tt>
      Unknown Length
     </a>
    </h2>
    <p>
     There's no documented way to indicate that there is content in
     <tt class="docutils literal">
      <span class="pre">
       environ['web3.input']
      </span>
     </tt>
     , but the content length is unknown.
    </p>
   </div>
   <div class="section" id="read-of-web3-input-should-support-no-size-calling-convention">
    <h2>
     <a class="toc-backref" href="#id49">
      <tt class="docutils literal">
       read()
      </tt>
      of
      <tt class="docutils literal">
       web3.input
      </tt>
      Should Support No-Size Calling Convention
     </a>
    </h2>
    <p>
     At
     <a class="footnote-reference" href="#id18" id="id6">
      [6]
     </a>
     , Graham Dumpleton makes the assertion that the
     <tt class="docutils literal">
      read()
     </tt>
     method of
     <tt class="docutils literal">
      wsgi.input
     </tt>
     should be callable without arguments, and
that the result should be "all available request content".  Needs
discussion.
    </p>
    <p>
     Comment Armin: I changed the spec to require that from an
implementation.  I had too much pain with that in the past already.
Open for discussions though.
    </p>
    <div class="section" id="input-filters-should-set-environ-content-length-to-1">
     <h3>
      <a class="toc-backref" href="#id50">
       Input Filters should set environ
       <tt class="docutils literal">
        CONTENT_LENGTH
       </tt>
       to -1
      </a>
     </h3>
     <p>
      At
      <a class="footnote-reference" href="#id18" id="id7">
       [6]
      </a>
      , Graham Dumpleton suggests that an input filter might set
      <tt class="docutils literal">
       <span class="pre">
        environ['CONTENT_LENGTH']
       </span>
      </tt>
      to -1 to indicate that it mutated the
input.
     </p>
    </div>
   </div>
   <div class="section" id="headers-as-literal-list-of-two-tuples">
    <h2>
     <a class="toc-backref" href="#id51">
      <tt class="docutils literal">
       headers
      </tt>
      as Literal List of Two-Tuples
     </a>
    </h2>
    <p>
     Why do we make applications return a
     <tt class="docutils literal">
      headers
     </tt>
     structure that is a
literal list of two-tuples?  I think the iterability of
     <tt class="docutils literal">
      headers
     </tt>
     needs to be maintained while it moves up the stack, but I don't think
we need to be able to mutate it in place at all times.  Could we
loosen that requirement?
    </p>
    <p>
     Comment Armin: Strong yes
    </p>
   </div>
   <div class="section" id="removed-requirement-that-middleware-not-block">
    <h2>
     <a class="toc-backref" href="#id52">
      Removed Requirement that Middleware Not Block
     </a>
    </h2>
    <p>
     This requirement was removed: "middleware components
     <strong>
      must not
     </strong>
     block iteration waiting for multiple values from an application
iterable.  If the middleware needs to accumulate more data from the
application before it can produce any output, it
     <strong>
      must
     </strong>
     yield an
empty string."  This requirement existed to support asynchronous
applications and servers (see
     <a class="reference external" href="../pep-0333/index.html">
      PEP 333
     </a>
     's "Middleware Handling of Block
Boundaries").  Asynchronous applications are now serviced explicitly
by
     <tt class="docutils literal">
      web3.async
     </tt>
     capable protocol (a Web3 application callable may
itself return a callable).
    </p>
   </div>
   <div class="section" id="web3-script-name-and-web3-path-info">
    <h2>
     <a class="toc-backref" href="#id53">
      <tt class="docutils literal">
       web3.script_name
      </tt>
      and
      <tt class="docutils literal">
       web3.path_info
      </tt>
     </a>
    </h2>
    <p>
     These values are required to be placed into the environment by an
origin server under this specification.  Unlike
     <tt class="docutils literal">
      SCRIPT_NAME
     </tt>
     and
     <tt class="docutils literal">
      PATH_INFO
     </tt>
     , these must be the original
     <em>
      URL-encoded
     </em>
     variants
derived from the request URI.  We probably need to figure out how
these should be computed originally, and what their values should be
if the server performs URL rewriting.
    </p>
   </div>
   <div class="section" id="long-response-headers">
    <h2>
     <a class="toc-backref" href="#id54">
      Long Response Headers
     </a>
    </h2>
    <p>
     Bob Brewer notes on Web-SIG
     <a class="footnote-reference" href="#id19" id="id8">
      [7]
     </a>
     :
    </p>
    <blockquote>
     Each header_value must not include any control characters,
including carriage returns or linefeeds, either embedded or at the
end.  (These requirements are to minimize the complexity of any
parsing that must be performed by servers, gateways, and
intermediate response processors that need to inspect or modify
response headers.)
     <a class="footnote-reference" href="#id13" id="id9">
      [1]
     </a>
    </blockquote>
    <p>
     That's understandable, but HTTP headers are defined as (mostly)
*TEXT, and "words of *TEXT MAY contain characters from character
sets other than ISO-8859-1 only when encoded according to the rules of
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2047.html">
      RFC 2047
     </a>
     ."
     <a class="footnote-reference" href="#id14" id="id10">
      [2]
     </a>
     And
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2047.html">
      RFC 2047
     </a>
     specifies that "an 'encoded-word' may
not be more than 75 characters long...  If it is desirable to encode
more text than will fit in an 'encoded-word' of 75 characters,
multiple 'encoded-word's (separated by CRLF SPACE) may be used."
     <a class="footnote-reference" href="#id15" id="id11">
      [3]
     </a>
     This satisfies HTTP header folding rules, as well: "Header fields can
be extended over multiple lines by preceding each extra line with at
least one SP or HT."
     <a class="footnote-reference" href="#id13" id="id12">
      [1]
     </a>
    </p>
    <p>
     So in my reading of HTTP, some code somewhere should introduce
newlines in longish, encoded response header values.  I see three
options:
    </p>
    <ol class="arabic simple">
     <li>
      Keep things as they are and disallow response header values if they
contain words over 75 chars that are outside the ISO-8859-1
character set.
     </li>
     <li>
      Allow newline characters in WSGI response headers.
     </li>
     <li>
      Require/strongly suggest WSGI servers to do the encoding and
folding before sending the value over HTTP.
     </li>
    </ol>
   </div>
   <div class="section" id="request-trailers-and-chunked-transfer-encoding">
    <h2>
     <a class="toc-backref" href="#id55">
      Request Trailers and Chunked Transfer Encoding
     </a>
    </h2>
    <p>
     When using chunked transfer encoding on request content, the RFCs
allow there to be request trailers.  These are like request headers
but come after the final null data chunk.  These trailers are only
available when the chunked data stream is finite length and when it
has all been read in.  Neither WSGI nor Web3 currently supports them.
    </p>
    <!-- XXX (armin) yield from application iterator should be specify write
plus flush by server. -->
    <!-- XXX (armin) websocket API. -->
   </div>
  </div>
  <div class="section" id="references">
   <h1>
    <a class="toc-backref" href="#id56">
     References
    </a>
   </h1>
   <table class="docutils footnote" frame="void" id="id13" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       [1]
      </td>
      <td>
       <em>
        (
        <a class="fn-backref" href="#id1">
         1
        </a>
        ,
        <a class="fn-backref" href="#id9">
         2
        </a>
        ,
        <a class="fn-backref" href="#id12">
         3
        </a>
        )
       </em>
       <a class="reference external" href="../pep-0333/index.html">
        PEP 333
       </a>
       : Python Web Services Gateway Interface
(
       <a class="reference external" href="../pep-0333/index.html">
        http://www.python.org/dev/peps/pep-0333/
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id14" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       [2]
      </td>
      <td>
       <em>
        (
        <a class="fn-backref" href="#id2">
         1
        </a>
        ,
        <a class="fn-backref" href="#id10">
         2
        </a>
        )
       </em>
       The Common Gateway Interface Specification, v 1.1, 3rd Draft
(
       <a class="reference external" href="http://cgi-spec.golux.com/draft-coar-cgi-v11-03.txt">
        http://cgi-spec.golux.com/draft-coar-cgi-v11-03.txt
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id15" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id11">
        [3]
       </a>
      </td>
      <td>
       "Chunked Transfer Coding" -- HTTP/1.1, section 3.6.1
(
       <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1">
        http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id16" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id4">
        [4]
       </a>
      </td>
      <td>
       "End-to-end and Hop-by-hop Headers" -- HTTP/1.1, Section 13.5.1
(
       <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.5.1">
        http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.5.1
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id17" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id3">
        [5]
       </a>
      </td>
      <td>
       mod_ssl Reference, "Environment Variables"
(
       <a class="reference external" href="http://www.modssl.org/docs/2.8/ssl_reference.html#ToC25">
        http://www.modssl.org/docs/2.8/ssl_reference.html#ToC25
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id18" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       [6]
      </td>
      <td>
       <em>
        (
        <a class="fn-backref" href="#id5">
         1
        </a>
        ,
        <a class="fn-backref" href="#id6">
         2
        </a>
        ,
        <a class="fn-backref" href="#id7">
         3
        </a>
        )
       </em>
       Details on WSGI 1.0 amendments/clarifications.
(
       <a class="reference external" href="http://blog.dscpl.com.au/2009/10/details-on-wsgi-10-amendmentsclarificat.html">
        http://blog.dscpl.com.au/2009/10/details-on-wsgi-10-amendmentsclarificat.html
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id19" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id8">
        [7]
       </a>
      </td>
      <td>
       [Web-SIG] WSGI and long response header values
       <a class="reference external" href="http://mail.python.org/pipermail/web-sig/2006-September/002244.html">
        http://mail.python.org/pipermail/web-sig/2006-September/002244.html
       </a>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="section" id="copyright">
   <h1>
    <a class="toc-backref" href="#id57">
     Copyright
    </a>
   </h1>
   <p>
    This document has been placed in the public domain.
   </p>
   <!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
  </div>
 </body>

<!-- Mirrored from www.python.org/dev/peps/pep-0444/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 03 Sep 2015 04:36:58 GMT -->
</html>Source: <a href="https://hg.python.org/peps/file/tip/pep-0444.txt">https://hg.python.org/peps/file/tip/pep-0444.txt</a>

    </article>


                </section>

                


<aside class="left-sidebar" role="secondary">

    






    





        <div class="twitter-widget sidebar-widget">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/ThePSF" data-widget-id="434113224703610882">Tweets by @ThePSF</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>

    <div class="psf-sidebar-widget sidebar-widget">
        <h3 class="widget-title">The PSF</h3>
<p>The Python Software Foundation is the organization behind Python. Become a member of the PSF and help advance the software and our mission. </p>

    </div>

</aside>



                
                


            </div><!-- end .container -->
        </div><!-- end #content .content-wrapper -->

        <!-- Footer and social media list -->
        <footer id="site-map" class="main-footer" role="contentinfo">
            <div class="main-footer-links">
                <div class="container">

                    
                    <a id="back-to-top-1" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>

                    

<ul class="sitemap navigation menu do-not-print" role="tree" id="container">
    
    <li class="tier-1 element-1">
        <a href="https://www.python.org/about/" >About</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-2">
        <a href="https://www.python.org/downloads/" >Downloads</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-3">
        <a href="https://www.python.org/doc/" >Documentation</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="../index.html" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-4">
        <a href="https://www.python.org/community/" >Community</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://www.python.org/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="https://www.python.org/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-5">
        <a href="https://www.python.org/about/success/" title="success-stories">Success Stories</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://www.python.org/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-6">
        <a href="https://www.python.org/blogs/" title="News from around the Python world">News</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-7">
        <a href="https://www.python.org/events/" >Events</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-8">
        <a href="https://www.python.org/dev/" >Contributing</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="http://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://bugs.python.org/" title="">Issue Tracker</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://mail.python.org/mailman/listinfo/python-dev" title="">python-dev list</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pythonmentors.com/" title="">Core Mentorship</a></li>
    
</ul>

        
    </li>
    
</ul>


                    <a id="back-to-top-2" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>
                    

                </div><!-- end .container -->
            </div> <!-- end .main-footer-links -->

            <div class="site-base">
                <div class="container">
                    
                    <ul class="footer-links navigation menu do-not-print" role="tree">
                        <li class="tier-1 element-1"><a href="https://www.python.org/about/help/">Help &amp; <span class="say-no-more">General</span> Contact</a></li>
                        <li class="tier-1 element-2"><a href="https://www.python.org/community/diversity/">Diversity <span class="say-no-more">Initiatives</span></a></li>
                        <li class="tier-1 element-3"><a href="https://github.com/python/pythondotorg/issues">Submit Website Bug</a></li>
                        <!--<li class="tier-1 element-3"><a href="#"><span class="say-no-more">Website</span> Colophon</a></li>-->
                    </ul>

                    <div class="copyright">
                        <p><small>
                            <span class="pre">Copyright &copy;2001-2015.</span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/psf-landing/">Python Software Foundation</a></span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/about/legal/">Legal Statements</a></span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/privacy/">Privacy Policy</a></span>
                        </small></p>
                    </div>

                </div><!-- end .container -->
            </div><!-- end .site-base -->

        </footer>

    </div><!-- end #touchnav-wrapper -->

    
    <script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../../static/js/libs/jquery-1.8.2.min.js"><\/script>')</script>

    <script src="../../../static/js/libs/masonry.pkgd.min.js"></script>

    <script type="text/javascript" src="../../../static/js/main-min.js" charset="utf-8"></script>
    

    <!--[if lte IE 7]>
    <script type="text/javascript" src="/static/js/plugins/IE8-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    <!--[if lte IE 8]>
    <script type="text/javascript" src="/static/js/plugins/getComputedStyle-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    

    
    

</body>
</html>

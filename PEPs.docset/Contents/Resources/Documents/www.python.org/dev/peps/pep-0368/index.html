<!doctype html>
<!--[if lt IE 7]>   <html class="no-js ie6 lt-ie7 lt-ie8 lt-ie9">   <![endif]-->
<!--[if IE 7]>      <html class="no-js ie7 lt-ie8 lt-ie9">          <![endif]-->
<!--[if IE 8]>      <html class="no-js ie8 lt-ie9">                 <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en" dir="ltr">  <!--<![endif]-->


<!-- Mirrored from www.python.org/dev/peps/pep-0368/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 03 Sep 2015 04:36:47 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="prefetch" href="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">

    <meta name="application-name" content="Python.org">
    <meta name="msapplication-tooltip" content="The official home of the Python Programming Language">
    <meta name="apple-mobile-web-app-title" content="Python.org">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="HandheldFriendly" content="True">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cleartype" content="on">
    <meta http-equiv="imagetoolbar" content="false">

    <script src="../../../static/js/libs/modernizr.js"></script>

    <link href="../../../static/stylesheets/style.css" rel="stylesheet" type="text/css" title="default" />
    <link href="../../../static/stylesheets/mq.css" rel="stylesheet" type="text/css" media="not print, braille, embossed, speech, tty" />
    

    <!--[if (lte IE 8)&(!IEMobile)]>
    <link href="/static/stylesheets/no-mq.css" rel="stylesheet" type="text/css" media="screen" />
    
    
    <![endif]-->

    
    <link rel="icon" type="image/x-icon" href="https://www.python.org/static/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../static/apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../static/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../static/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../../../static/apple-touch-icon-precomposed.png">
    <link rel="apple-touch-icon" href="../../../static/apple-touch-icon-precomposed.png">

    
    <meta name="msapplication-TileImage" content="/static/metro-icon-144x144-precomposed.png"><!-- white shape -->
    <meta name="msapplication-TileColor" content="#3673a5"><!-- python blue -->
    <meta name="msapplication-navbutton-color" content="#3673a5">

    <meta property="og:site_name" content="Python.org">
    <meta property="og:type" content="website">

    <title>PEP 0368 -- Standard image protocol and class | Python.org</title>
    <meta property="og:title" content="Welcome to Python.org">

    
    <meta name="description" content="The official home of the Python Programming Language">
    <meta name="og:description" content="The official home of the Python Programming Language">
    <meta name="keywords" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:tag" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:published_time" content="">
    <meta property="og:modified_time" content="">
    <meta property="og:author" content="">
    <meta property="og:section" content=""> 
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:video" content="">

    <link rel="author" href="https://www.python.org/static/humans.txt">

    

    
    <script type="application/ld+json">
     {
       "@context": "http://schema.org",
       "@type": "WebSite",
       "url": "https://www.python.org/",
       "potentialAction": {
         "@type": "SearchAction",
         "target": "https://www.python.org/search/?q={search_term_string}",
         "query-input": "required name=search_term_string"
       }
     }
    </script>

    
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39055973-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    
</head>

<body class="python pages pep-page">

    <div id="touchnav-wrapper">

        <div id="nojs" class="do-not-print">
            <p><strong>Notice:</strong> While Javascript is not essential for this website, your interaction with the content will be limited. Please turn Javascript on for the full experience. </p>
        </div>

        <!--[if lt IE 8]>
        <div id="oldie-warning" class="do-not-print">
            <p><strong>Notice:</strong> Your browser is <em>ancient</em> and <a href="http://www.ie6countdown.com/">Microsoft agrees</a>. <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience a better web.</p>
        </div>
        <![endif]-->

        <!-- Sister Site Links -->
        <div id="top" class="top-bar do-not-print">

            <nav class="meta-navigation container" role="navigation">

                
                <div class="skip-link screen-reader-text">
                    <a href="#content" title="Skip to content">Skip to content</a>
                </div>

                
                <a id="close-python-network" class="jump-link" href="#python-network" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-down"><span>&#9660;</span></span> Close
                </a>

                

<ul class="menu" role="tree">
    
    <li class="python-meta ">
        <a href="https://www.python.org/" title="The Python Programming Language" >Python</a>
    </li>
    
    <li class="psf-meta ">
        <a href="https://www.python.org/psf-landing/" title="The Python Software Foundation" >PSF</a>
    </li>
    
    <li class="docs-meta ">
        <a href="https://docs.python.org/" title="Python Documentation" >Docs</a>
    </li>
    
    <li class="pypi-meta ">
        <a href="https://pypi.python.org/" title="Python Package Index" >PyPI</a>
    </li>
    
    <li class="jobs-meta ">
        <a href="https://www.python.org/jobs/" title="Python Job Board" >Jobs</a>
    </li>
    
    <li class="shop-meta ">
        <a href="https://www.python.org/community/" title="Python Community" >Community</a>
    </li>
    
</ul>


                <a id="python-network" class="jump-link" href="#top" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> The Python Network
                </a>

            </nav>

        </div>

        <!-- Header elements -->
        <header class="main-header" role="banner">
            <div class="container">

                <h1 class="site-headline">
                    <a href="https://www.python.org/"><img class="python-logo" src="../../../static/img/python-logo.png" alt="python&trade;"></a>
                </h1>

                <div class="options-bar do-not-print">

                    
                    <a id="site-map-link" class="jump-to-menu" href="#site-map"><span class="menu-icon">&equiv;</span> Menu</a><form class="search-the-site" action="https://www.python.org/search/" method="get">
                        <fieldset title="Search Python.org">

                            <span aria-hidden="true" class="icon-search"></span>

                            <label class="screen-reader-text" for="id-search-field">Search This Site</label>
                            <input id="id-search-field" name="q" type="search" role="textbox" class="search-field" placeholder="Search" value="" tabindex="1">

                            <button type="submit" name="submit" id="submit" class="search-button" title="Submit this Search" tabindex="3">
                                GO
                            </button>

                            
                            <!--[if IE]><input type="text" style="display: none;" disabled="disabled" size="1" tabindex="4"><![endif]-->

                        </fieldset>
                    </form><span class="breaker"></span><div class="adjust-font-size" aria-hidden="true">
                        <ul class="navigation menu" aria-label="Adjust Text Size on Page">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger"><strong><small>A</small> A</strong></a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a class="text-shrink" title="Make Text Smaller" href="javascript:;">Smaller</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a class="text-grow" title="Make Text Larger" href="javascript:;">Larger</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a class="text-reset" title="Reset any font size changes I have made" href="javascript:;">Reset</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="winkwink-nudgenudge">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger">Socialize</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="http://plus.google.com/+Python"><span aria-hidden="true" class="icon-google-plus"></span>Google+</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="http://www.facebook.com/pythonlang?fref=ts"><span aria-hidden="true" class="icon-facebook"></span>Facebook</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a href="http://twitter.com/ThePSF"><span aria-hidden="true" class="icon-twitter"></span>Twitter</a></li>
                                    <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/irc/"><span aria-hidden="true" class="icon-freenode"></span>Chat on IRC</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="account-signin">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                
                                <a href="https://www.python.org/accounts/login/" title="Sign Up or Sign In to Python.org">Sign In</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/accounts/signup/">Sign Up / Register</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/accounts/login/">Sign In</a></li>
                                </ul>
                                
                            </li>
                        </ul>
                    </div>

                </div><!-- end options-bar -->

                <nav id="mainnav" class="python-navigation main-navigation do-not-print" role="navigation">
                    
                        
<ul class="navigation menu" role="menubar" aria-label="Main Navigation">
  
    
    
    <li id="about" class="tier-1 element-1  " aria-haspopup="true">
        <a href="https://www.python.org/about/" title="" class="">About</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="downloads" class="tier-1 element-2  " aria-haspopup="true">
        <a href="https://www.python.org/downloads/" title="" class="">Downloads</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="documentation" class="tier-1 element-3  " aria-haspopup="true">
        <a href="https://www.python.org/doc/" title="" class="">Documentation</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="../index.html" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="community" class="tier-1 element-4  " aria-haspopup="true">
        <a href="https://www.python.org/community/" title="" class="">Community</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://www.python.org/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="https://www.python.org/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="success-stories" class="tier-1 element-5  " aria-haspopup="true">
        <a href="https://www.python.org/about/success/" title="success-stories" class="">Success Stories</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://www.python.org/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="news" class="tier-1 element-6  " aria-haspopup="true">
        <a href="https://www.python.org/blogs/" title="News from around the Python world" class="">News</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="events" class="tier-1 element-7  " aria-haspopup="true">
        <a href="https://www.python.org/events/" title="" class="">Events</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    
    
    
  
</ul>

                    
                </nav>

                <div class="header-banner "> <!-- for optional "do-not-print" class -->
                    
                    
                </div>

                
                

             </div><!-- end .container -->
        </header>

        <div id="content" class="content-wrapper">
            <!-- Main Content Column -->
            <div class="container">

                <section class="main-content with-left-sidebar" role="main">

                    
<ul class="breadcrumbs menu">
    <li>
        <a href="https://www.python.org/" title="The Python Programming Language">Python</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="https://www.python.org/dev/">Python Developer's Guide</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="../index.html">PEP Index</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>PEP 0368 -- Standard image protocol and class</li>
</ul>


                    
<style>
   .pep-page pre {
        padding: .5em;
        background: inherit;
        border-left: 0px;
        -webkit-box-shadow: 0 0 0 0;
        -moz-box-shadow: 0 0 0 0;
        box-shadow: 0 0 0 0;
   }
</style>

    
    <article class="text">
        

        <header class="article-header">
            <h1 class="page-title">PEP 0368 -- Standard image protocol and class</h1>
        </header>

        <!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<html>
 <body>
  <table class="rfc2822 docutils field-list" frame="void" rules="none">
   <col class="field-name">
   </col>
   <col class="field-body">
   </col>
   <tbody valign="top">
    <tr class="field">
     <th class="field-name">
      PEP:
     </th>
     <td class="field-body">
      368
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Title:
     </th>
     <td class="field-body">
      Standard image protocol and class
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Author:
     </th>
     <td class="field-body">
      Lino Mastrodomenico &lt;l.mastrodomenico at gmail.com&gt;
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Status:
     </th>
     <td class="field-body">
      Deferred
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Type:
     </th>
     <td class="field-body">
      Standards Track
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Created:
     </th>
     <td class="field-body">
      28-Jun-2007
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Python-Version:
     </th>
     <td class="field-body">
      2.6, 3.0
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Post-History:
     </th>
     <td class="field-body">
     </td>
    </tr>
   </tbody>
  </table>
  <hr/>
  <div class="contents topic" id="contents">
   <p class="topic-title first">
    Contents
   </p>
   <ul class="simple">
    <li>
     <a class="reference internal" href="#abstract" id="id2">
      Abstract
     </a>
    </li>
    <li>
     <a class="reference internal" href="#pep-deferral" id="id3">
      PEP Deferral
     </a>
    </li>
    <li>
     <a class="reference internal" href="#rationale" id="id4">
      Rationale
     </a>
    </li>
    <li>
     <a class="reference internal" href="#specification" id="id5">
      Specification
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#python-api" id="id6">
        Python API
       </a>
       <ul>
        <li>
         <a class="reference internal" href="#mode-objects" id="id7">
          Mode Objects
         </a>
        </li>
        <li>
         <a class="reference internal" href="#image-protocol" id="id8">
          Image Protocol
         </a>
        </li>
        <li>
         <a class="reference internal" href="#image-and-imagemixin-classes" id="id9">
          <tt class="docutils literal">
           Image
          </tt>
          and
          <tt class="docutils literal">
           ImageMixin
          </tt>
          Classes
         </a>
        </li>
        <li>
         <a class="reference internal" href="#line-objects" id="id10">
          Line Objects
         </a>
        </li>
        <li>
         <a class="reference internal" href="#pixel-objects" id="id11">
          Pixel Objects
         </a>
        </li>
        <li>
         <a class="reference internal" href="#imagesize-class" id="id12">
          <tt class="docutils literal">
           ImageSize
          </tt>
          Class
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="reference internal" href="#c-api" id="id13">
        C API
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#examples" id="id14">
      Examples
     </a>
    </li>
    <li>
     <a class="reference internal" href="#backwards-compatibility" id="id15">
      Backwards Compatibility
     </a>
    </li>
    <li>
     <a class="reference internal" href="#reference-implementation" id="id16">
      Reference Implementation
     </a>
    </li>
    <li>
     <a class="reference internal" href="#acknowledgments" id="id17">
      Acknowledgments
     </a>
    </li>
    <li>
     <a class="reference internal" href="#copyright" id="id18">
      Copyright
     </a>
    </li>
   </ul>
  </div>
  <div class="section" id="abstract">
   <h1>
    <a class="toc-backref" href="#id2">
     Abstract
    </a>
   </h1>
   <p>
    The current situation of image storage and manipulation in the Python
world is extremely fragmented: almost every library that uses image
objects has implemented its own image class, incompatible with
everyone else's and often not very pythonic.  A basic RGB image class
exists in the standard library (
    <tt class="docutils literal">
     Tkinter.PhotoImage
    </tt>
    ), but is pretty
much unusable, and unused, for anything except Tkinter programming.
   </p>
   <p>
    This fragmentation not only takes up valuable space in the developers
minds, but also makes the exchange of images between different
libraries (needed in relatively common use cases) slower and more
complex than it needs to be.
   </p>
   <p>
    This PEP proposes to improve the situation by defining a simple and
pythonic image protocol/interface that can be hopefully accepted and
implemented by existing image classes inside and outside the standard
library
    <em>
     without breaking backward compatibility
    </em>
    with their existing
user bases.  In practice this is a definition of how a minimal
    <em>
     image-like
    </em>
    object should look and act (in a similar way to the
    <tt class="docutils literal">
     read()
    </tt>
    and
    <tt class="docutils literal">
     write()
    </tt>
    methods in
    <em>
     file-like
    </em>
    objects).
   </p>
   <p>
    The inclusion in the standard library of a class that provides basic
image manipulation functionality and implements the new protocol is
also proposed, together with a mixin class that helps adding support
for the protocol to existing image classes.
   </p>
  </div>
  <div class="section" id="pep-deferral">
   <h1>
    <a class="toc-backref" href="#id3">
     PEP Deferral
    </a>
   </h1>
   <p>
    Further exploration of the concepts covered in this PEP has been deferred
for lack of a current champion interested in promoting the goals of the PEP
and collecting and incorporating feedback, and with sufficient available
time to do so effectively.
   </p>
  </div>
  <div class="section" id="rationale">
   <h1>
    <a class="toc-backref" href="#id4">
     Rationale
    </a>
   </h1>
   <p>
    A good way to have high quality modules ready for inclusion in the
Python standard library is to simply wait for natural selection among
competing external libraries to provide a clear winner with useful
functionality and a big user base.  Then the de-facto standard can be
officially sanctioned by including it in the standard library.
   </p>
   <p>
    Unfortunately this approach hasn't worked well for the creation of a
dominant image class in the Python world: almost every third-party
library that requires an image object creates its own class
incompatible with the ones from other libraries.  This is a real
problem because it's entirely reasonable for a program to create and
manipulate an image using, e.g., PIL (the Python Imaging Library) and
then display it using wxPython or pygame.  But these libraries have
different and incompatible image classes, and the usual solution is to
manually "export" an image from the source to a (width, height,
bytes_string) tuple and "import" it creating a new instance in the
target format.  This approach
    <em>
     works
    </em>
    , but is both uglier and slower
than it needs to be.
   </p>
   <p>
    Another "solution" that has been sometimes used is the creation of
specific adapters and/or converters from a class to another (e.g. PIL
offers the
    <tt class="docutils literal">
     ImageTk
    </tt>
    module for converting PIL images to a class
compatible with the Tkinter one).  But this approach doesn't scale
well with the number of libraries involved and it's still annoying for
the user: if I have a perfectly good image object why should I convert
before passing it to the next method, why can't it simply accept my
image as-is?
   </p>
   <p>
    The problem isn't by any stretch limited to the three mentioned
libraries and has probably multiple causes, including two that IMO are
very important to understand before solving it:
   </p>
   <ul class="simple">
    <li>
     in today's computing world an image is a basic type not strictly
tied to a specific domain.  This is why there will never be a clear
winner between the image classes from the three libraries mentioned
above (PIL, wxPython and pygame): they cover different domains and
don't really compete with each other;
    </li>
    <li>
     the Python standard library has never provided a good image class
that can be adopted or imitated by third part modules.
     <tt class="docutils literal">
      Tkinter.PhotoImage
     </tt>
     provides basic RGB functionality, but it's by
far the slowest and ugliest of the bunch and it can be instantiated
only after the Tkinter root window has been created.
    </li>
   </ul>
   <p>
    This PEP tries to improve this situation in four ways:
   </p>
   <ol class="arabic simple">
    <li>
     It defines a simple and pythonic image protocol/interface (both on
the Python and the C side) that can be hopefully accepted and
implemented by existing image classes inside and outside the
standard library
     <em>
      without breaking backward compatibility
     </em>
     with
their existing user bases.
    </li>
    <li>
     It proposes the inclusion in the standard library of three new
classes:
     <ul>
      <li>
       <tt class="docutils literal">
        ImageMixin
       </tt>
       provides almost everything necessary to implement
the new protocol; its main purpose is to make as simple as
possible to support this interface for existing libraries, in
some cases as simple as adding it to the list of base classes and
doing minor additions to the constructor.
      </li>
      <li>
       <tt class="docutils literal">
        Image
       </tt>
       is a subclass of
       <tt class="docutils literal">
        ImageMixin
       </tt>
       and will add a
constructor that can resize and/or convert an image between
different pixel formats.  This is intended to provide a fast and
efficient default implementation of the new protocol.
      </li>
      <li>
       <tt class="docutils literal">
        ImageSize
       </tt>
       is a minor helper class.  See below for details.
      </li>
     </ul>
    </li>
    <li>
     <tt class="docutils literal">
      Tkinter.PhotoImage
     </tt>
     will implement the new protocol (mostly
through the
     <tt class="docutils literal">
      ImageMixin
     </tt>
     class) and all the Tkinter methods that
can receive an image will be modified the accept any object that
implements the interface.  As an aside the author of this PEP will
collaborate with the developers of the most common external
libraries to achieve the same goal (supporting the protocol in
their classes and accepting any class that implements it).
    </li>
    <li>
     New
     <tt class="docutils literal">
      PyImage_*
     </tt>
     functions will be added to the CPython C API:
they implement the C side of the protocol and accept as first
parameter
     <strong>
      any
     </strong>
     object that supports it, even if it isn't an
instance of the
     <tt class="docutils literal">
      Image
     </tt>
     /
     <tt class="docutils literal">
      ImageMixin
     </tt>
     classes.
    </li>
   </ol>
   <p>
    The main effects for the end user will be a simplification of the
interchange of images between different libraries (if everything goes
well, any Python library will accept images from any other library)
and the out-of-the-box availability of the new
    <tt class="docutils literal">
     Image
    </tt>
    class.  The
new class is intended to cover simple but common use cases like
cropping and/or resizing a photograph to the desired size and passing
it an appropriate widget for displaying it on a window, or darkening a
texture and passing it to a 3D library.
   </p>
   <p>
    The
    <tt class="docutils literal">
     Image
    </tt>
    class is not intended to replace or compete with PIL,
Pythonmagick or NumPy, even if it provides a (very small) subset of
the functionality of these three libraries.  In particular PIL offers
very rich image manipulation features with
    <em>
     dozens
    </em>
    of classes,
filters, transformations and file formats.  The inclusion of PIL (or
something similar) in the standard library may, or may not, be a
worthy goal but it's completely outside the scope of this PEP.
   </p>
  </div>
  <div class="section" id="specification">
   <h1>
    <a class="toc-backref" href="#id5">
     Specification
    </a>
   </h1>
   <p>
    The
    <tt class="docutils literal">
     imageop
    </tt>
    module is used as the
    <em>
     default
    </em>
    location for the new
classes and objects because it has for a long time hosted functions
that provided a somewhat similar functionality, but a new module may
be created if preferred (e.g. a new "
    <tt class="docutils literal">
     image
    </tt>
    " or "
    <tt class="docutils literal">
     media
    </tt>
    " module;
the latter may eventually include other multimedia classes).
   </p>
   <p>
    <tt class="docutils literal">
     MODES
    </tt>
    is a new module level constant: it is a set of the pixel
formats supported by the
    <tt class="docutils literal">
     Image
    </tt>
    class.  Any image object that
implements the new protocol is guaranteed to be formatted in one of
these modes, but libraries that accept images are allowed to support
only a subset of them.
   </p>
   <p>
    These modes are in turn also available as module level constants (e.g.
    <tt class="docutils literal">
     imageop.RGB
    </tt>
    ).
   </p>
   <p>
    The following table is a summary of the modes currently supported and
their properties:
   </p>
   <table border="1" class="docutils">
    <colgroup>
     <col width="14%">
     </col>
     <col width="23%">
     </col>
     <col width="14%">
     </col>
     <col width="17%">
     </col>
     <col width="33%">
     </col>
    </colgroup>
    <thead valign="bottom">
     <tr>
      <th class="head">
       Name
      </th>
      <th class="head">
       Component
names
      </th>
      <th class="head">
       Bits per
component
      </th>
      <th class="head">
       Subsampling
      </th>
      <th class="head">
       Valid
intervals
      </th>
     </tr>
    </thead>
    <tbody valign="top">
     <tr>
      <td>
       L
      </td>
      <td>
       l (lowercase L)
      </td>
      <td>
       8
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       L16
      </td>
      <td>
       l
      </td>
      <td>
       16
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       L32
      </td>
      <td>
       l
      </td>
      <td>
       32
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       LA
      </td>
      <td>
       l, a
      </td>
      <td>
       8
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       LA32
      </td>
      <td>
       l, a
      </td>
      <td>
       16
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       RGB
      </td>
      <td>
       r, g, b
      </td>
      <td>
       8
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       RGB48
      </td>
      <td>
       r, g, b
      </td>
      <td>
       16
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       RGBA
      </td>
      <td>
       r, g, b, a
      </td>
      <td>
       8
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       RGBA64
      </td>
      <td>
       r, g, b, a
      </td>
      <td>
       16
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       YV12
      </td>
      <td>
       y, cr, cb
      </td>
      <td>
       8
      </td>
      <td>
       1, 2, 2
      </td>
      <td>
       16-235, 16-240, 16-240
      </td>
     </tr>
     <tr>
      <td>
       JPEG_YV12
      </td>
      <td>
       y, cr, cb
      </td>
      <td>
       8
      </td>
      <td>
       1, 2, 2
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       CMYK
      </td>
      <td>
       c, m, y, k
      </td>
      <td>
       8
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
     <tr>
      <td>
       CMYK64
      </td>
      <td>
       c, m, y, k
      </td>
      <td>
       16
      </td>
      <td>
       no
      </td>
      <td>
       full range
      </td>
     </tr>
    </tbody>
   </table>
   <p>
    When the name of a mode ends with a number, it represents the average
number of bits per pixel.  All the other modes simply use a byte per
component per pixel.
   </p>
   <p>
    No palette modes or modes with less than 8 bits per component are
supported.  Welcome to the 21st century.
   </p>
   <p>
    Here's a quick description of the modes and the rationale for their
inclusion; there are four groups of modes:
   </p>
   <ol class="arabic">
    <li>
     <p class="first">
      <strong>
       grayscale
      </strong>
      (
      <tt class="docutils literal">
       L*
      </tt>
      modes): they are heavily used in scientific
computing (those people may also need a very high dynamic range and
precision, hence
      <tt class="docutils literal">
       L32
      </tt>
      , the only mode with 32 bits per component)
and sometimes it can be useful to consider a single component of a
color image as a grayscale image (this is used by the individual
planes of the planar images, see
      <tt class="docutils literal">
       YV12
      </tt>
      below); the name of the
component (
      <tt class="docutils literal">
       'l'
      </tt>
      , lowercase letter L) stands for luminance, the
second optional component (
      <tt class="docutils literal">
       'a'
      </tt>
      ) is the alpha value and
represents the opacity of the pixels: alpha = 0 means full
transparency, alpha = 255/65535 represents a fully opaque pixel;
     </p>
    </li>
    <li>
     <p class="first">
      <strong>
       RGB* modes
      </strong>
      : the garden variety color images.  The optional
alpha component has the same meaning as in grayscale modes;
     </p>
    </li>
    <li>
     <p class="first">
      <strong>
       YCbCr
      </strong>
      , a.k.a. YUV (
      <tt class="docutils literal">
       *YV12
      </tt>
      modes).  These modes are planar
(i.e. the values of all the pixel for each component are stored in
a consecutive memory area, instead of the usual arrangement where
all the components of a pixel reside in consecutive bytes) and use
a 1, 2, 2 (a.k.a. 4:2:0) subsampling (i.e. each pixel has its own Y
value, but the Cb and Cr components are shared between groups of
2x2 adjacent pixels) because this is the format that's by far the
most common for YCbCr images.  Please note that the V (Cr) plane is
stored before the U (Cb) plane.
     </p>
     <p>
      <tt class="docutils literal">
       YV12
      </tt>
      is commonly used for MPEG2 (including DVDs), MPEG4 (both
ASP/DivX and AVC/H.264) and Theora video frames.  Valid values for
Y are in range(16, 236) (excluding 236), and valid values for Cb
and Cr are in range(16, 241).
      <tt class="docutils literal">
       JPEG_YV12
      </tt>
      is similar to
      <tt class="docutils literal">
       YV12
      </tt>
      , but the three components can have the full range of 256
values.  It's the native format used by almost all JPEG/JFIF files
and by MJPEG video frames.  The "strangeness" of these two wrt all
the other supported modes derives from the fact that they are
widely used that way by a lot of existing libraries and
applications; this is also the reason why they are included (and
the fact that they can't losslessly converted to RGB because YCbCr
is a bigger color space); the funny 4:2:0 planar arrangement of the
pixel values is relatively easy to support because in most cases
the three planes can be considered three separate grayscale images;
     </p>
    </li>
    <li>
     <p class="first">
      <strong>
       CMYK* modes
      </strong>
      (cyan, magenta, yellow and black) are subtractive
color modes, used for printing color images on dead trees.
Professional designers love to pretend that they can't live without
them, so here they are.
     </p>
    </li>
   </ol>
   <div class="section" id="python-api">
    <h2>
     <a class="toc-backref" href="#id6">
      Python API
     </a>
    </h2>
    <p>
     See the
     <a class="reference internal" href="#examples">
      examples
     </a>
     below.
    </p>
    <p>
     In Python 2.x, all the new classes defined here are new-style classes.
    </p>
    <div class="section" id="mode-objects">
     <h3>
      <a class="toc-backref" href="#id7">
       Mode Objects
      </a>
     </h3>
     <p>
      The mode objects offer a number of attributes and methods that can be
used for implementing generic algorithms that work on different types
of images:
     </p>
     <p>
      <tt class="docutils literal">
       components
      </tt>
     </p>
     <blockquote>
      The number of components per pixel (e.g. 4 for an RGBA image).
     </blockquote>
     <p>
      <tt class="docutils literal">
       component_names
      </tt>
     </p>
     <blockquote>
      A tuple of strings; see the column "Component names" in the above
table.
     </blockquote>
     <p>
      <tt class="docutils literal">
       bits_per_component
      </tt>
     </p>
     <blockquote>
      8, 16 or 32; see "Bits per component" in the above table.
     </blockquote>
     <p>
      <tt class="docutils literal">
       bytes_per_pixel
      </tt>
     </p>
     <blockquote>
      <tt class="docutils literal">
       components * bits_per_component // 8
      </tt>
      , only available for non
planar modes (see below).
     </blockquote>
     <p>
      <tt class="docutils literal">
       planar
      </tt>
     </p>
     <blockquote>
      Boolean;
      <tt class="docutils literal">
       True
      </tt>
      if the image components reside each in a
separate plane.  Currently this happens if and only if the mode
uses subsampling.
     </blockquote>
     <p>
      <tt class="docutils literal">
       subsampling
      </tt>
     </p>
     <blockquote>
      A tuple that for each component in the mode contains a tuple of
two integers that represent the amount of downsampling in the
horizontal and vertical direction, respectively.  In practice it's
      <tt class="docutils literal">
       ((1, 1), (2, 2), (2, 2))
      </tt>
      for
      <tt class="docutils literal">
       YV12
      </tt>
      and
      <tt class="docutils literal">
       JPEG_YV12
      </tt>
      and
      <tt class="docutils literal">
       ((1,
       <span class="pre">
        1),)
       </span>
       * components
      </tt>
      for everything else.
     </blockquote>
     <p>
      <tt class="docutils literal">
       x_divisor
      </tt>
     </p>
     <blockquote>
      <tt class="docutils literal">
       max(x for x, y in subsampling)
      </tt>
      ; the width of an image that
uses this mode must be divisible for this value.
     </blockquote>
     <p>
      <tt class="docutils literal">
       y_divisor
      </tt>
     </p>
     <blockquote>
      <tt class="docutils literal">
       max(y for x, y in subsampling)
      </tt>
      ; the height of an image that
uses this mode must be divisible for this value.
     </blockquote>
     <p>
      <tt class="docutils literal">
       intervals
      </tt>
     </p>
     <blockquote>
      A tuple that for each component in the mode contains a tuple of
two integers: the minimum and maximum valid value for the
component.  Its value is
      <tt class="docutils literal">
       ((16, 235), (16, 240), (16, 240))
      </tt>
      for
      <tt class="docutils literal">
       YV12
      </tt>
      and
      <tt class="docutils literal">
       ((0, 2 ** bits_per_component -
       <span class="pre">
        1),)
       </span>
       * components
      </tt>
      for everything else.
     </blockquote>
     <p>
      <tt class="docutils literal">
       get_length(iterable[integer])
       <span class="pre">
        -&gt;
       </span>
       int
      </tt>
     </p>
     <blockquote>
      The parameter must be an iterable that contains two integers: the
width and height of an image; it returns the number of bytes
needed to store an image of these dimensions with this mode.
     </blockquote>
     <p>
      Implementation detail: the modes are instances of a subclass of
      <tt class="docutils literal">
       str
      </tt>
      and have a value equal to their name (e.g.
      <tt class="docutils literal">
       imageop.RGB ==
'RGB'
      </tt>
      ) except for
      <tt class="docutils literal">
       L32
      </tt>
      that has value
      <tt class="docutils literal">
       'I'
      </tt>
      .  This is only
intended for backward compatibility with existing PIL users; new code
that uses the image protocol proposed here should not rely on this
detail.
     </p>
    </div>
    <div class="section" id="image-protocol">
     <h3>
      <a class="toc-backref" href="#id8">
       Image Protocol
      </a>
     </h3>
     <p>
      Any object that supports the image protocol must provide the following
methods and attributes:
     </p>
     <p>
      <tt class="docutils literal">
       mode
      </tt>
     </p>
     <blockquote>
      The format and the arrangement of the pixels in this image; it's
one of the constants in the
      <tt class="docutils literal">
       MODES
      </tt>
      set.
     </blockquote>
     <p>
      <tt class="docutils literal">
       size
      </tt>
     </p>
     <blockquote>
      An instance of the
      <a class="reference internal" href="#imagesize-class">
       ImageSize class
      </a>
      ; it's a named tuple of two
integers: the width and the height of the image in pixels; both of
them must be &gt;= 1 and can also be accessed as the
      <tt class="docutils literal">
       width
      </tt>
      and
      <tt class="docutils literal">
       height
      </tt>
      attributes of
      <tt class="docutils literal">
       size
      </tt>
      .
     </blockquote>
     <p>
      <tt class="docutils literal">
       buffer
      </tt>
     </p>
     <blockquote>
      <p>
       A sequence of integers between 0 and 255; they are the actual
bytes used for storing the image data (i.e. modifying their values
affects the image pixels and vice versa); the data has a
row-major/C-contiguous order without padding and without any
special memory alignment, even when there are more than 8 bits per
component.  The only supported methods are
       <tt class="docutils literal">
        __len__
       </tt>
       ,
       <tt class="docutils literal">
        __getitem__
       </tt>
       /
       <tt class="docutils literal">
        __setitem__
       </tt>
       (with both integers and slice
indexes) and
       <tt class="docutils literal">
        __iter__
       </tt>
       ; on the C side it implements the buffer
protocol.
      </p>
      <p>
       This is a pretty low level interface to the image and the user is
responsible for using the correct (native) byte order for modes
with more than 8 bit per component and the correct value ranges
for
       <tt class="docutils literal">
        YV12
       </tt>
       images.  A buffer may or may not keep a reference to
its image, but it's still safe (if useless) to use the buffer even
after the corresponding image has been destroyed by the garbage
collector (this will require changes to the image class of
wxPython and possibly other libraries).  Implementation detail:
this can be an
       <tt class="docutils literal">
        <span class="pre">
         array('B')
        </span>
       </tt>
       , a
       <tt class="docutils literal">
        bytes()
       </tt>
       object or a
specialized fixed-length type.
      </p>
     </blockquote>
     <p>
      <tt class="docutils literal">
       info
      </tt>
     </p>
     <blockquote>
      A
      <tt class="docutils literal">
       dict
      </tt>
      object that can contain arbitrary metadata associated
with the image (e.g. DPI, gamma, ICC profile, exposure time...);
the interpretation of this data is beyond the scope of this PEP
and probably depends on the library used to create and/or to save
the image; if a method of the image returns a new image, it can
copy or adapt metadata from its own
      <tt class="docutils literal">
       info
      </tt>
      attribute (the
      <tt class="docutils literal">
       ImageMixin
      </tt>
      implementation always creates a new image with an
empty
      <tt class="docutils literal">
       info
      </tt>
      dictionary).
     </blockquote>
     <div class="line-block">
      <div class="line">
       <tt class="docutils literal">
        bits_per_component
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        bytes_per_pixel
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        component_names
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        components
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        intervals
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        planar
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        subsampling
       </tt>
      </div>
     </div>
     <blockquote>
      Shortcuts for the corresponding
      <tt class="docutils literal">
       mode.*
      </tt>
      attributes.
     </blockquote>
     <p>
      <tt class="docutils literal">
       map(function[,
       <span class="pre">
        function...])
       </span>
       <span class="pre">
        -&gt;
       </span>
       None
      </tt>
     </p>
     <blockquote>
      <p>
       For every pixel in the image, maps each component through the
corresponding function.  If only one function is passed, it is
used repeatedly for each component.  This method modifies the
image
       <strong>
        in place
       </strong>
       and is usually very fast (most of the time the
functions are called only a small number of times, possibly only
once for simple functions without branches), but it imposes a
number of restrictions on the function(s) passed:
      </p>
      <ul class="simple">
       <li>
        it must accept a single integer argument and return a number
(
        <tt class="docutils literal">
         map
        </tt>
        will round the result to the nearest integer and clip
it to
        <tt class="docutils literal">
         range(0, 2 ** bits_per_component)
        </tt>
        , if necessary);
       </li>
       <li>
        it must
        <em>
         not
        </em>
        try to intercept any
        <tt class="docutils literal">
         BaseException
        </tt>
        ,
        <tt class="docutils literal">
         Exception
        </tt>
        or any unknown subclass of
        <tt class="docutils literal">
         Exception
        </tt>
        raised by
any operation on the argument (implementations may try to
optimize the speed by passing funny objects, so even a simple
        <tt class="docutils literal">
         "if n == 10:"
        </tt>
        may raise an exception: simply ignore it,
        <tt class="docutils literal">
         map
        </tt>
        will take care of it); catching any other exception is
fine;
       </li>
       <li>
        it should be side-effect free and its result should not depend
on values (other than the argument) that may change during a
single invocation of
        <tt class="docutils literal">
         map
        </tt>
        .
       </li>
      </ul>
     </blockquote>
     <div class="line-block">
      <div class="line">
       <tt class="docutils literal">
        rotate90()
        <span class="pre">
         -&gt;
        </span>
        image
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        rotate180()
        <span class="pre">
         -&gt;
        </span>
        image
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        rotate270()
        <span class="pre">
         -&gt;
        </span>
        image
       </tt>
      </div>
     </div>
     <blockquote>
      Return a copy of the image rotated 90, 180 or 270 degrees
counterclockwise around its center.
     </blockquote>
     <p>
      <tt class="docutils literal">
       clip()
       <span class="pre">
        -&gt;
       </span>
       None
      </tt>
     </p>
     <blockquote>
      Saturates invalid component values in
      <tt class="docutils literal">
       YV12
      </tt>
      images to the
minimum or the maximum allowed (see
      <tt class="docutils literal">
       mode.intervals
      </tt>
      ), for other
image modes this method does nothing, very fast; libraries that
save/export
      <tt class="docutils literal">
       YV12
      </tt>
      images are encouraged to always call this
method, since intermediate operations (e.g. the
      <tt class="docutils literal">
       map
      </tt>
      method)
may assign to pixels values outside the valid intervals.
     </blockquote>
     <p>
      <tt class="docutils literal">
       split()
       <span class="pre">
        -&gt;
       </span>
       tuple[image]
      </tt>
     </p>
     <blockquote>
      Returns a tuple of
      <tt class="docutils literal">
       L
      </tt>
      ,
      <tt class="docutils literal">
       L16
      </tt>
      or
      <tt class="docutils literal">
       L32
      </tt>
      images corresponding
to the individual components in the image.
     </blockquote>
     <p>
      Planar images also supports attributes with the same names defined in
      <tt class="docutils literal">
       component_names
      </tt>
      : they contain grayscale (mode
      <tt class="docutils literal">
       L
      </tt>
      ) images that
offer a view on the pixel values for the corresponding component; any
change to the subimages is immediately reflected on the parent image
and vice versa (their buffers refer to the same memory location).
     </p>
     <p>
      Non-planar images offer the following additional methods:
     </p>
     <p>
      <tt class="docutils literal">
       pixels()
       <span class="pre">
        -&gt;
       </span>
       iterator[pixel]
      </tt>
     </p>
     <blockquote>
      Returns an iterator that iterates over all the pixels in the
image, starting from the top line and scanning each line from left
to right.  See below for a description of the
      <a class="reference internal" href="#pixel-objects">
       pixel objects
      </a>
      .
     </blockquote>
     <p>
      <tt class="docutils literal">
       __iter__()
       <span class="pre">
        -&gt;
       </span>
       iterator[line]
      </tt>
     </p>
     <blockquote>
      Returns an iterator that iterates over all the lines in the image,
from top to bottom.  See below for a description of the
      <a class="reference internal" href="#line-objects">
       line
objects
      </a>
      .
     </blockquote>
     <p>
      <tt class="docutils literal">
       __len__()
       <span class="pre">
        -&gt;
       </span>
       int
      </tt>
     </p>
     <blockquote>
      Returns the number of lines in the image (
      <tt class="docutils literal">
       size.height
      </tt>
      ).
     </blockquote>
     <p>
      <tt class="docutils literal">
       __getitem__(integer)
       <span class="pre">
        -&gt;
       </span>
       line
      </tt>
     </p>
     <blockquote>
      Returns the line at the specified (y) position.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __getitem__(tuple[integer])
       <span class="pre">
        -&gt;
       </span>
       pixel
      </tt>
     </p>
     <blockquote>
      The parameter must be a tuple of two integers; they are
interpreted respectively as x and y coordinates in the image (0, 0
is the top left corner) and a pixel object is returned.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __getitem__(slice | tuple[integer | slice])
       <span class="pre">
        -&gt;
       </span>
       image
      </tt>
     </p>
     <blockquote>
      The parameter must be a slice or a tuple that contains two slices
or an integer and a slice; the selected area of the image is
copied and a new image is returned;
      <tt class="docutils literal">
       image[x:y:z]
      </tt>
      is equivalent
to
      <tt class="docutils literal">
       <span class="pre">
        image[:,
       </span>
       x:y:z]
      </tt>
      .
     </blockquote>
     <p>
      <tt class="docutils literal">
       __setitem__(tuple[integer], integer | iterable[integer])
       <span class="pre">
        -&gt;
       </span>
       None
      </tt>
     </p>
     <blockquote>
      Modifies the pixel at specified position;
      <tt class="docutils literal">
       image[x, y] =
integer
      </tt>
      is a shortcut for
      <tt class="docutils literal">
       image[x, y] = (integer,)
      </tt>
      for
images with a single component.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __setitem__(slice | tuple[integer | slice], image)
       <span class="pre">
        -&gt;
       </span>
       None
      </tt>
     </p>
     <blockquote>
      Selects an area in the same way as the corresponding form of the
      <tt class="docutils literal">
       __getitem__
      </tt>
      method and assigns to it a copy of the pixels from
the image in the second argument, that must have exactly the same
mode as this image and the same size as the specified area; the
alpha component, if present, is simply copied and doesn't affect
the other components of the image (i.e. no alpha compositing is
performed).
     </blockquote>
     <p>
      The
      <tt class="docutils literal">
       mode
      </tt>
      ,
      <tt class="docutils literal">
       size
      </tt>
      and
      <tt class="docutils literal">
       buffer
      </tt>
      (including the address in memory
of the
      <tt class="docutils literal">
       buffer
      </tt>
      ) never change after an image is created.
     </p>
     <p>
      It is expected that, if
      <a class="reference external" href="../pep-3118/index.html">
       PEP 3118
      </a>
      is accepted, all the image objects
will support the new buffer protocol, however this is beyond the scope
of this PEP.
     </p>
    </div>
    <div class="section" id="image-and-imagemixin-classes">
     <h3>
      <a class="toc-backref" href="#id9">
       <tt class="docutils literal">
        Image
       </tt>
       and
       <tt class="docutils literal">
        ImageMixin
       </tt>
       Classes
      </a>
     </h3>
     <p>
      The
      <tt class="docutils literal">
       ImageMixin
      </tt>
      class implements all the methods and attributes
described above except
      <tt class="docutils literal">
       mode
      </tt>
      ,
      <tt class="docutils literal">
       size
      </tt>
      ,
      <tt class="docutils literal">
       buffer
      </tt>
      and
      <tt class="docutils literal">
       info
      </tt>
      .
      <tt class="docutils literal">
       Image
      </tt>
      is a subclass of
      <tt class="docutils literal">
       ImageMixin
      </tt>
      that adds support for these
four attributes and offers the following constructor (please note that
the constructor is not part of the image protocol):
     </p>
     <p>
      <tt class="docutils literal">
       __init__(mode, size, color, source)
      </tt>
     </p>
     <blockquote>
      <p>
       <tt class="docutils literal">
        mode
       </tt>
       must be one of the constants in the
       <tt class="docutils literal">
        MODES
       </tt>
       set,
       <tt class="docutils literal">
        size
       </tt>
       is a sequence of two integers (width and height of the
new image);
       <tt class="docutils literal">
        color
       </tt>
       is a sequence of integers, one for each
component of the image, used to initialize all the pixels to the
same value;
       <tt class="docutils literal">
        source
       </tt>
       can be a sequence of integers of the
appropriate size and format that is copied as-is in the buffer of
the new image or an existing image; in Python 2.x
       <tt class="docutils literal">
        source
       </tt>
       can
also be an instance of
       <tt class="docutils literal">
        str
       </tt>
       and is interpreted as a sequence of
bytes.
       <tt class="docutils literal">
        color
       </tt>
       and
       <tt class="docutils literal">
        source
       </tt>
       are mutually exclusive and if
they are both omitted the image is initialized to transparent
black (all the bytes in the buffer have value 16 in the
       <tt class="docutils literal">
        YV12
       </tt>
       mode, 255 in the
       <tt class="docutils literal">
        CMYK*
       </tt>
       modes and 0 for everything else).  If
       <tt class="docutils literal">
        source
       </tt>
       is present and is an image,
       <tt class="docutils literal">
        mode
       </tt>
       and/or
       <tt class="docutils literal">
        size
       </tt>
       can be omitted; if they are specified and are different from the
source mode and/or size, the source image is converted.
      </p>
      <p>
       The exact algorithms used for resizing and doing color space
conversions may differ between Python versions and
implementations, but they always give high quality results (e.g.:
a cubic spline interpolation can be used for upsampling and an
antialias filter can be used for downsampling images); any
combination of mode conversion is supported, but the algorithm
used for conversions to and from the
       <tt class="docutils literal">
        CMYK*
       </tt>
       modes is pretty
naïve: if you have the exact color profiles of your devices you
may want to use a good color management tool such as LittleCMS.
The new image has an empty
       <tt class="docutils literal">
        info
       </tt>
       <tt class="docutils literal">
        dict
       </tt>
       .
      </p>
     </blockquote>
    </div>
    <div class="section" id="line-objects">
     <h3>
      <a class="toc-backref" href="#id10">
       Line Objects
      </a>
     </h3>
     <p>
      The line objects (returned, e.g., when iterating over an image)
support the following attributes and methods:
     </p>
     <p>
      <tt class="docutils literal">
       mode
      </tt>
     </p>
     <blockquote>
      The mode of the image from where this line comes.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __iter__()
       <span class="pre">
        -&gt;
       </span>
       iterator[pixel]
      </tt>
     </p>
     <blockquote>
      Returns an iterator that iterates over all the pixels in the line,
from left to right.  See below for a description of the
      <a class="reference internal" href="#pixel-objects">
       pixel
objects
      </a>
      .
     </blockquote>
     <p>
      <tt class="docutils literal">
       __len__()
       <span class="pre">
        -&gt;
       </span>
       int
      </tt>
     </p>
     <blockquote>
      Returns the number of pixels in the line (the image width).
     </blockquote>
     <p>
      <tt class="docutils literal">
       __getitem__(integer)
       <span class="pre">
        -&gt;
       </span>
       pixel
      </tt>
     </p>
     <blockquote>
      Returns the pixel at the specified (x) position.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __getitem__(slice)
       <span class="pre">
        -&gt;
       </span>
       image
      </tt>
     </p>
     <blockquote>
      The selected part of the line is copied and a new image is
returned; the new image will always have height 1.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __setitem__(integer, integer | iterable[integer])
       <span class="pre">
        -&gt;
       </span>
       None
      </tt>
     </p>
     <blockquote>
      Modifies the pixel at the specified position;
      <tt class="docutils literal">
       line[x] =
integer
      </tt>
      is a shortcut for
      <tt class="docutils literal">
       line[x] = (integer,)
      </tt>
      for images
with a single component.
     </blockquote>
     <p>
      <tt class="docutils literal">
       __setitem__(slice, image)
       <span class="pre">
        -&gt;
       </span>
       None
      </tt>
     </p>
     <blockquote>
      Selects a part of the line and assigns to it a copy of the pixels
from the image in the second argument, that must have height 1, a
width equal to the specified slice and the same mode as this line;
the alpha component, if present, is simply copied and doesn't
affect the other components of the image (i.e. no alpha
compositing is performed).
     </blockquote>
    </div>
    <div class="section" id="pixel-objects">
     <h3>
      <a class="toc-backref" href="#id11">
       Pixel Objects
      </a>
     </h3>
     <p>
      The pixel objects (returned, e.g., when iterating over a line) support
the following attributes and methods:
     </p>
     <p>
      <tt class="docutils literal">
       mode
      </tt>
     </p>
     <blockquote>
      The mode of the image from where this pixel comes.
     </blockquote>
     <p>
      <tt class="docutils literal">
       value
      </tt>
     </p>
     <blockquote>
      A tuple of integers, one for each component.  Any iterable of the
correct length can be assigned to
      <tt class="docutils literal">
       value
      </tt>
      (it will be
automagically converted to a tuple), but you can't assign to it an
integer, even if the mode has only a single component: use, e.g.,
      <tt class="docutils literal">
       pixel.l = 123
      </tt>
      instead.
     </blockquote>
     <p>
      <tt class="docutils literal">
       r, g, b, a, l, c, m, y, k
      </tt>
     </p>
     <blockquote>
      The integer values of each component; only those applicable for
the current mode (in
      <tt class="docutils literal">
       mode.component_names
      </tt>
      ) will be available.
     </blockquote>
     <div class="line-block">
      <div class="line">
       <tt class="docutils literal">
        __iter__()
        <span class="pre">
         -&gt;
        </span>
        iterator[int]
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        __len__()
        <span class="pre">
         -&gt;
        </span>
        int
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        __getitem__(integer | slice)
        <span class="pre">
         -&gt;
        </span>
        int | tuple[int]
       </tt>
      </div>
      <div class="line">
       <tt class="docutils literal">
        __setitem__(integer | slice, integer | iterable[integer])
        <span class="pre">
         -&gt;
        </span>
        None
       </tt>
      </div>
     </div>
     <blockquote>
      These four methods emulate a fixed length list of integers, one
for each pixel component.
     </blockquote>
    </div>
    <div class="section" id="imagesize-class">
     <h3>
      <a class="toc-backref" href="#id12">
       <tt class="docutils literal">
        ImageSize
       </tt>
       Class
      </a>
     </h3>
     <p>
      <tt class="docutils literal">
       ImageSize
      </tt>
      is a named tuple, a class identical to
      <tt class="docutils literal">
       tuple
      </tt>
      except
that:
     </p>
     <ul class="simple">
      <li>
       its constructor only accepts two integers, width and height; they
are converted in the constructor using their
       <tt class="docutils literal">
        __index__()
       </tt>
       methods, so all the
       <tt class="docutils literal">
        ImageSize
       </tt>
       objects are guaranteed to contain
only
       <tt class="docutils literal">
        int
       </tt>
       (or possibly
       <tt class="docutils literal">
        long
       </tt>
       , in Python 2.x) instances;
      </li>
      <li>
       it has a
       <tt class="docutils literal">
        width
       </tt>
       and a
       <tt class="docutils literal">
        height
       </tt>
       property that are equivalent to
the first and the second number in the tuple, respectively;
      </li>
      <li>
       the string returned by its
       <tt class="docutils literal">
        __repr__
       </tt>
       method is
       <tt class="docutils literal">
        <span class="pre">
         'imageop.ImageSize(width=%d,
        </span>
        <span class="pre">
         height=%d)'
        </span>
        % (width, height)
       </tt>
       .
      </li>
     </ul>
     <p>
      <tt class="docutils literal">
       ImageSize
      </tt>
      is not usually instantiated by end-users, but can be
used when creating a new class that implements the image protocol,
since the
      <tt class="docutils literal">
       size
      </tt>
      attribute must be an
      <tt class="docutils literal">
       ImageSize
      </tt>
      instance.
     </p>
    </div>
   </div>
   <div class="section" id="c-api">
    <h2>
     <a class="toc-backref" href="#id13">
      C API
     </a>
    </h2>
    <p>
     The available image modes are visible at the C level as
     <tt class="docutils literal">
      PyImage_*
     </tt>
     constants of type
     <tt class="docutils literal">
      PyObject *
     </tt>
     (e.g.:
     <tt class="docutils literal">
      PyImage_RGB
     </tt>
     is
     <tt class="docutils literal">
      imageop.RGB
     </tt>
     ).
    </p>
    <p>
     The following functions offer a C-friendly interface to mode and image
objects (all the functions return
     <tt class="docutils literal">
      NULL
     </tt>
     or -1 on failure):
    </p>
    <p>
     <tt class="docutils literal">
      int PyImageMode_Check(PyObject *obj)
     </tt>
    </p>
    <blockquote>
     Returns true if the object
     <tt class="docutils literal">
      obj
     </tt>
     is a valid image mode.
    </blockquote>
    <div class="line-block">
     <div class="line">
      <tt class="docutils literal">
       int PyImageMode_GetComponents(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImageMode_GetComponentNames(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImageMode_GetBitsPerComponent(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImageMode_GetBytesPerPixel(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImageMode_GetPlanar(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImageMode_GetSubsampling(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImageMode_GetXDivisor(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImageMode_GetYDivisor(PyObject *mode)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       Py_ssize_t PyImageMode_GetLength(PyObject *mode, Py_ssize_t width,
Py_ssize_t height)
      </tt>
     </div>
    </div>
    <blockquote>
     These functions are equivalent to their corresponding Python
attributes or methods.
    </blockquote>
    <p>
     <tt class="docutils literal">
      int PyImage_Check(PyObject *obj)
     </tt>
    </p>
    <blockquote>
     Returns true if the object
     <tt class="docutils literal">
      obj
     </tt>
     is an
     <tt class="docutils literal">
      Image
     </tt>
     object or an
instance of a subtype of the
     <tt class="docutils literal">
      Image
     </tt>
     type; see also
     <tt class="docutils literal">
      PyObject_CheckImage
     </tt>
     below.
    </blockquote>
    <p>
     <tt class="docutils literal">
      int PyImage_CheckExact(PyObject *obj)
     </tt>
    </p>
    <blockquote>
     Returns true if the object
     <tt class="docutils literal">
      obj
     </tt>
     is an
     <tt class="docutils literal">
      Image
     </tt>
     object, but not
an instance of a subtype of the
     <tt class="docutils literal">
      Image
     </tt>
     type.
    </blockquote>
    <div class="line-block">
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImage_New(PyObject *mode, Py_ssize_t width,
Py_ssize_t height)
      </tt>
     </div>
    </div>
    <blockquote>
     Returns a new
     <tt class="docutils literal">
      Image
     </tt>
     instance, initialized to transparent black
(see
     <tt class="docutils literal">
      Image.__init__
     </tt>
     above for the details).
    </blockquote>
    <div class="line-block">
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImage_FromImage(PyObject *image, PyObject *mode,
Py_ssize_t width, Py_ssize_t height)
      </tt>
     </div>
    </div>
    <blockquote>
     Returns a new
     <tt class="docutils literal">
      Image
     </tt>
     instance, initialized with the contents of
the
     <tt class="docutils literal">
      image
     </tt>
     object rescaled and converted to the specified
     <tt class="docutils literal">
      mode
     </tt>
     , if necessary.
    </blockquote>
    <div class="line-block">
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImage_FromBuffer(PyObject *buffer, PyObject *mode,
Py_ssize_t width,
Py_ssize_t height)
      </tt>
     </div>
    </div>
    <blockquote>
     Returns a new
     <tt class="docutils literal">
      Image
     </tt>
     instance, initialized with the contents of
the
     <tt class="docutils literal">
      buffer
     </tt>
     object.
    </blockquote>
    <p>
     <tt class="docutils literal">
      int PyObject_CheckImage(PyObject *obj)
     </tt>
    </p>
    <blockquote>
     Returns true if the object
     <tt class="docutils literal">
      obj
     </tt>
     implements a sufficient subset
of the image protocol to be accepted by the functions defined
below, even if its class is not a subclass of
     <tt class="docutils literal">
      ImageMixin
     </tt>
     and/or
     <tt class="docutils literal">
      Image
     </tt>
     .  Currently it simply checks for the existence
and correctness of the attributes
     <tt class="docutils literal">
      mode
     </tt>
     ,
     <tt class="docutils literal">
      size
     </tt>
     and
     <tt class="docutils literal">
      buffer
     </tt>
     .
    </blockquote>
    <div class="line-block">
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImage_GetMode(PyObject *image)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       Py_ssize_t PyImage_GetWidth(PyObject *image)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       Py_ssize_t PyImage_GetHeight(PyObject *image)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImage_Clip(PyObject *image)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImage_Split(PyObject *image)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       PyObject* PyImage_GetBuffer(PyObject *image)
      </tt>
     </div>
     <div class="line">
      <tt class="docutils literal">
       int PyImage_AsBuffer(PyObject *image, const void **buffer,
Py_ssize_t *buffer_len)
      </tt>
     </div>
    </div>
    <blockquote>
     These functions are equivalent to their corresponding Python
attributes or methods; the image memory can be accessed only with
the GIL and a reference to the image or its buffer held, and extra
care should be taken for modes with more than 8 bits per
component: the data is stored in native byte order and it can be
     <strong>
      not
     </strong>
     aligned on 2 or 4 byte boundaries.
    </blockquote>
   </div>
  </div>
  <div class="section" id="examples">
   <h1>
    <a class="toc-backref" href="#id14">
     Examples
    </a>
   </h1>
   <p>
    A few examples of common operations with the new
    <tt class="docutils literal">
     Image
    </tt>
    class and
protocol:
   </p>
   <pre class="literal-block">
# create a new black RGB image of 6x9 pixels
rgb_image = imageop.Image(imageop.RGB, (6, 9))

# same as above, but initialize the image to bright red
rgb_image = imageop.Image(imageop.RGB, (6, 9), color=(255, 0, 0))

# convert the image to YCbCr
yuv_image = imageop.Image(imageop.JPEG_YV12, source=rgb_image)

# read the value of a pixel and split it into three ints
r, g, b = rgb_image[x, y]

# modify the magenta component of a pixel in a CMYK image
cmyk_image[x, y].m = 13

# modify the Y (luma) component of a pixel in a *YV12 image and
# its corresponding subsampled Cr (red chroma)
yuv_image.y[x, y] = 42
yuv_image.cr[x // 2, y // 2] = 54

# iterate over an image
for line in rgb_image:
    for pixel in line:
        # swap red and blue, and set green to 0
        pixel.value = pixel.b, 0, pixel.r

# find the maximum value of the red component in the image
max_red = max(pixel.r for pixel in rgb_image.pixels())

# count the number of colors in the image
num_of_colors = len(set(tuple(pixel) for pixel in image.pixels()))

# copy a block of 4x2 pixels near the upper right corner of an
# image and paste it into the lower left corner of the same image
image[:4, -2:] = image[-6:-2, 1:3]

# create a copy of the image, except that the new image can have a
# different (usually empty) info dict
new_image = image[:]

# create a mirrored copy of the image, with the left and right
# sides flipped
flipped_image = image[::-1, :]

# downsample an image to half its original size using a fast, low
# quality operation and a slower, high quality one:
low_quality_image = image[::2, ::2]
new_size = image.size.width // 2, image.size.height // 2
high_quality_image = imageop.Image(size=new_size, source=image)

# direct buffer access
rgb_image[0, 0] = r, g, b
assert tuple(rgb_image.buffer[:3]) == (r, g, b)
</pre>
  </div>
  <div class="section" id="backwards-compatibility">
   <h1>
    <a class="toc-backref" href="#id15">
     Backwards Compatibility
    </a>
   </h1>
   <p>
    There are three areas touched by this PEP where backwards
compatibility should be considered:
   </p>
   <ul class="simple">
    <li>
     <strong>
      Python 2.6
     </strong>
     : new classes and objects are added to the
     <tt class="docutils literal">
      imageop
     </tt>
     module without touching the existing module contents; new methods
and attributes will be added to
     <tt class="docutils literal">
      Tkinter.PhotoImage
     </tt>
     and its
     <tt class="docutils literal">
      __getitem__
     </tt>
     and
     <tt class="docutils literal">
      __setitem__
     </tt>
     methods will be modified to
accept integers, tuples and slices (currently they only accept
strings).  All the changes provide a superset of the existing
functionality, so no major compatibility issues are expected.
    </li>
    <li>
     <strong>
      Python 3.0
     </strong>
     : the legacy contents of the
     <tt class="docutils literal">
      imageop
     </tt>
     module will
be deleted, according to
     <a class="reference external" href="../pep-3108/index.html">
      PEP 3108
     </a>
     ; everything defined in this
proposal will work like in Python 2.x with the exception of the
usual 2.x/3.0 differences (e.g. support for
     <tt class="docutils literal">
      long
     </tt>
     integers and
for interpreting
     <tt class="docutils literal">
      str
     </tt>
     instances as sequences of bytes will be
dropped).
    </li>
    <li>
     <strong>
      external libraries
     </strong>
     : the names and the semantics of the standard
image methods and attributes are carefully chosen to allow some
external libraries that manipulate images (including at least PIL,
wxPython and pygame) to implement the new protocol in their image
classes without breaking compatibility with existing code.  The only
blatant conflicts between the image protocol and NumPy arrays are
the value of the
     <tt class="docutils literal">
      size
     </tt>
     attribute and the coordinates order in the
     <tt class="docutils literal">
      image[x, y]
     </tt>
     expression.
    </li>
   </ul>
  </div>
  <div class="section" id="reference-implementation">
   <h1>
    <a class="toc-backref" href="#id16">
     Reference Implementation
    </a>
   </h1>
   <p>
    If this PEP is accepted, the author will provide a reference
implementation of the new classes in pure Python (that can run in
CPython, PyPy, Jython and IronPython) and a second one optimized for
speed in Python and C, suitable for inclusion in the CPython standard
library.  The author will also submit the required Tkinter patches.
For all the code will be available a version for Python 2.x and a
version for Python 3.0 (it is expected that the two version will be
very similar and the Python 3.0 one will probably be generated almost
completely automatically).
   </p>
  </div>
  <div class="section" id="acknowledgments">
   <h1>
    <a class="toc-backref" href="#id17">
     Acknowledgments
    </a>
   </h1>
   <p>
    The implementation of this PEP, if accepted, is sponsored by Google
through the Google Summer of Code program.
   </p>
  </div>
  <div class="section" id="copyright">
   <h1>
    <a class="toc-backref" href="#id18">
     Copyright
    </a>
   </h1>
   <p>
    This document has been placed in the public domain.
   </p>
   <!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
coding: utf-8
End: -->
  </div>
 </body>

<!-- Mirrored from www.python.org/dev/peps/pep-0368/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 03 Sep 2015 04:36:47 GMT -->
</html>Source: <a href="https://hg.python.org/peps/file/tip/pep-0368.txt">https://hg.python.org/peps/file/tip/pep-0368.txt</a>

    </article>


                </section>

                


<aside class="left-sidebar" role="secondary">

    






    





        <div class="twitter-widget sidebar-widget">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/ThePSF" data-widget-id="434113224703610882">Tweets by @ThePSF</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>

    <div class="psf-sidebar-widget sidebar-widget">
        <h3 class="widget-title">The PSF</h3>
<p>The Python Software Foundation is the organization behind Python. Become a member of the PSF and help advance the software and our mission. </p>

    </div>

</aside>



                
                


            </div><!-- end .container -->
        </div><!-- end #content .content-wrapper -->

        <!-- Footer and social media list -->
        <footer id="site-map" class="main-footer" role="contentinfo">
            <div class="main-footer-links">
                <div class="container">

                    
                    <a id="back-to-top-1" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>

                    

<ul class="sitemap navigation menu do-not-print" role="tree" id="container">
    
    <li class="tier-1 element-1">
        <a href="https://www.python.org/about/" >About</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-2">
        <a href="https://www.python.org/downloads/" >Downloads</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-3">
        <a href="https://www.python.org/doc/" >Documentation</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="../index.html" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-4">
        <a href="https://www.python.org/community/" >Community</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://www.python.org/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="https://www.python.org/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-5">
        <a href="https://www.python.org/about/success/" title="success-stories">Success Stories</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://www.python.org/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://www.python.org/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="https://www.python.org/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-6">
        <a href="https://www.python.org/blogs/" title="News from around the Python world">News</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-7">
        <a href="https://www.python.org/events/" >Events</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="https://www.python.org/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="https://www.python.org/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://www.python.org/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://www.python.org/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-8">
        <a href="https://www.python.org/dev/" >Contributing</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="http://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://bugs.python.org/" title="">Issue Tracker</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://mail.python.org/mailman/listinfo/python-dev" title="">python-dev list</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pythonmentors.com/" title="">Core Mentorship</a></li>
    
</ul>

        
    </li>
    
</ul>


                    <a id="back-to-top-2" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>
                    

                </div><!-- end .container -->
            </div> <!-- end .main-footer-links -->

            <div class="site-base">
                <div class="container">
                    
                    <ul class="footer-links navigation menu do-not-print" role="tree">
                        <li class="tier-1 element-1"><a href="https://www.python.org/about/help/">Help &amp; <span class="say-no-more">General</span> Contact</a></li>
                        <li class="tier-1 element-2"><a href="https://www.python.org/community/diversity/">Diversity <span class="say-no-more">Initiatives</span></a></li>
                        <li class="tier-1 element-3"><a href="https://github.com/python/pythondotorg/issues">Submit Website Bug</a></li>
                        <!--<li class="tier-1 element-3"><a href="#"><span class="say-no-more">Website</span> Colophon</a></li>-->
                    </ul>

                    <div class="copyright">
                        <p><small>
                            <span class="pre">Copyright &copy;2001-2015.</span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/psf-landing/">Python Software Foundation</a></span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/about/legal/">Legal Statements</a></span>
                            &nbsp;<span class="pre"><a href="https://www.python.org/privacy/">Privacy Policy</a></span>
                        </small></p>
                    </div>

                </div><!-- end .container -->
            </div><!-- end .site-base -->

        </footer>

    </div><!-- end #touchnav-wrapper -->

    
    <script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../../static/js/libs/jquery-1.8.2.min.js"><\/script>')</script>

    <script src="../../../static/js/libs/masonry.pkgd.min.js"></script>

    <script type="text/javascript" src="../../../static/js/main-min.js" charset="utf-8"></script>
    

    <!--[if lte IE 7]>
    <script type="text/javascript" src="/static/js/plugins/IE8-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    <!--[if lte IE 8]>
    <script type="text/javascript" src="/static/js/plugins/getComputedStyle-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    

    
    

</body>
</html>
